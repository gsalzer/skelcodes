/**
 * @title CMTA20
 * Capital Market and Technology Association, 2018-2019
 * https://cmta.ch
 * 
 * 
 * @title CMTA20
 * @dev CMTA20 contract since 2018 to 2020
 * @author Sébastien Krafft - <sebastien.krafft@mtpelerin.com>
 * https://github.com/CMTA/CMTA20
 * 
 * 
 * @title DXSCR
 * @dev DXSCR arrowtrade.ch from 2020
 * @author Felix Götz & Colin Studiger - to the moon :-)
 * arrowtrade.ch // securuscoin.com  
 * 
 * 
 *    ((((((((                                                                                                                                                                                           
     ((((((((((//                                                                                                                                                                                       
     ,((((((((((/////                                                                                                                                                                                   
      /((((((((//////////                                                                                                                                                                               
       ((((((((//////////////.                                                                                                                                                                          
        ((((((///////////////////                                                                                                                                                                       
         ((((////////////////////////                                                                                                                                                                   
          ((////////////////////////////.                                                                                                                                                               
          ((//////////////////////////////                                                                                                                                                              
           ///////////////////////////////                                                                                                                                        .                     
          ///////////////////////////////     ,(                                                                                                                                &&&                     
          ////////////////////////////       ,(((                                                                                    /&                                         %&&                     
        /////////////////////////            (((((         (((((   /((   (((((   /((     /((((((((/    ((((/    ((((     *((((     &&&&        .   (%,     #&&&#           %&&/ %&&        .%%(         
        ///////////////////////               ((/((,       (((((*(((((   (((((*(/(((  ,(/(((((((/((((/  /((((   /((((   ,((((       &&&      &&&,& *&&  &&&     &&      &&      &&&     &&     &&&      
       ////////////////////                    (((((      (((((((       (((((((     *((((/      /((((/  ((((( (((((((,,((((        &&&       &&,        .      &&(   %&&       %&&    &&&&&&&&&&&&     
      /////////////////                  /(((((((((((/     (((((.        (((((.      (((((        (((((   (((((((/ ((((((((         &&&       &&,         *&&   &&(   &&&       %&&   &&&               
     //////////////                     *********((((((    (((((         (((((        (((((      (((((*    (((((/   *(((((          &&&       &&,       &&*     &&(   &&&       %&&   ,&&#         &    
     //////////                                   (((((/   (((((         (((((         (((((((((/((((       /((.      (((           &&&   .   &&/      #&&&    &&&%    &&&#     &&&    *&&&&    .&*     
     /////,                                        //////  /////         /////            ,/(((((/           /         (             (&&&  %%%%%%%%      %&&%   .&&*     ,&&&&. %%        %&&&&/        
                                                                                                        
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNXXNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWNK000XNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOxoodk0XNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOxolcldxOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOxoc;'';lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKOdc;;::lodOKNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdl:,....,lOXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWX0xolc:;,;cldOKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKko:,....''';o0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0xollclc:;;;cokKNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXko:'...'''''',l0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0doollllllc:;;dNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc,...''''''''';dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkooollllloolxNMMWK0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0d:'..'''''''''''':kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOoooolcloookNMMNx:coONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0d:'..'''''''''''''':OWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOooolcloookNMMWOlc;;:o0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXx:'..'''''''''''''''';kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOollcloookNMMWOllllc;oXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWOl,..'''''''''''''''''',dNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxllcloookNMMWOolccclxNMMWNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXk:...''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0occloookNMMWOolllccxNMMNxcxXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXd;..'''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWNNNNNWWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNxccloookNMMWOolllllkNMMWOc;;oKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKo,..''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNK0kxxxxxxxxxkO0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0ocllookNMMWOlclllokNMMWOol:;;o0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMWKo,..''''''''''''''''''''''''''oNMMMMMMMMMMMMMMMMMMMMMMMMMMMN0xolllllllooolllldkKWMMMMMMMMMMMMMMMMMMMMMMMMMMMXdcloookNMMWOlclllokNMMWOllllc;oXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMXd,..''''''''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMWXkolllooolllllllllllloONMMMMMMMMMMMMMMMMMMMMMMMMMMNxllollkNMMWOlcllllkNMMWOllllllxNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMNk;..''''''''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMNkoolllooooollclllllllcl0WMMMMMMMMMMMMMMMMMMMMMMMMMWOlllllkNMMWOlclollxNMMWOlllllcxNMMWXNMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMW0c..''''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMW0ooollllllllllllllllllllxXMMMMMMMMMMMMMMMMMMMMMMMMMWOllcclkNMMWOlllollxNMMWOollcccxNMMNdcOWMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMXd'..'''''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMWOolollloolllooooolcclllldKMMMMMMMMMMMMMMMMMMMMMMMMMM0olc;ckNMMWOlllollxNMMWOlccclcxNMMWk:,lKWMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMWO:..''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMWkllollloooooooool:;:llclo0WMMMMMMMMMMMMMMMMMMMMMMMMM0oolclkNMMWOlclllcxNMMNkccllccxNMMWOl:';kNMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMNd'.''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMWkllolllooooolllllllcccccdKWMMMMMMMMMMMMMMMMMMMMMMMMM0ollclkNMMWOlcllllxNMMWOllllccxNMMWOlc:,,oXMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMKc..'''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMWkllollloooollllloooolc::oKWMMMMMMMMMMMMMMMMMMMMMMMMMKdlc:lkNMMWOolllccxNMMWOlcllccxNMMWkc::cc,oXMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMWO;..''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMWkloollloooolllooooooolc:l0WMMMMMMMMMMMMMMMMMMMMMMMMW0ollcckNMMWOllll::dNMMWOlcllccxNMMWklccllcdXMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMWx'.''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNkllollloooollooooollllcco0WMMMMMMMMMMMMMMMMMMMMMMMMMKolc:cxNMMWOllllcckNMMWOlcllllxNMMWOlcccclxNMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMNo..'''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNkllollloooollooooollllccdKWMMMMMMMMMMMMMMMMMMMMMMMMMKdlc::xNMMWOollc:ckNMMWOlcllllxNMMWOlc:cllkNMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMNo..''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNkloollloooolloooooooolccoKWMMMMMMMMMMMMMMMMMMMMMMMMMKolc::xNMMWOllll:cxNMMWOlcllclxNMMWkl::cllkNMMWKXMMMMMMMMMMMMM
MMMMMMMMMMMXl..'''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNkllollloooollloooooolllco0WMMMMMMMMMMMMMMMMMMMMMMMMMKolc:ckNMMWOllllccxXMMWkllllccxNMMWOl::cllkNMMNocKMMMMMMMMMMMM
MMMMMMMMMMNl..''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNOllllllooolllllooollllllo0WMMMMMMMMMMMMMMMMMMMMMMMMMKolc:ckNMMWOollcclkNMMWOllccllxNMMWOlc:lllkNMMWx,cKMMMMMMMMMMM
MMMMMMMMMNo..''''''''''''''''''''''''''''''''''''''''''''':KMMMMMMMMMMMMMMMMMMMMMMMMMWOoolllloooollloooollollldKWMMMMMMMMMMMMMMMMMMMMMMMMMKolc:cxNMMWOolccclkNMMWOlcllllxNMMWOlc:cllkNMMWOc'cXMMMMMMMMMM
MMMMMMMMWd..'''''''''''''''''''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMW0doollllooooooooooooollldKWMMMMMMMMMMMMMMMMMMMMMMMMM0ollccxNMMWOollcccxNMMWklllllcxNMMWklcclccxNMMWOl:'oNMMMMMMMMM
MMMMMMMWk'.''''''''''''''''''''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMMNkoolllllloooooooololllldKWMMMMMMMMMMMMMMMMMMMMMMMMM0ollccxNMMWOollcc:xNMMNkllllllxNMMWOl:ccccxNMMNkll:,dWMMMMMMMM
MMMMMMM0;..''''''''''''''''''''''''''''''''''''''''''''''',kWMMMMMMMMMMMMMMMMMMMMMMMMMWXxolllollllloooollllllld0WWWWWWWWWWWWWWWWWWWWWWWWWW0lcccckNMMWOollc::xNMMNkllllllxNMMWklcccllkNMMWOoll;,OWMMMMMMM
MMMMMMXc..'''''''''''''''''''''''''''''''''''''''''''''''''dNMMMMMMMMMMMMMMMMMMMMMMMMMMWXxlllooolllllloooollllodxkkkkxxkxxxxkxxxkkxxkkkxxxdlcc:cxNMMWOolcc:cxNMMNkllllllxNMMWOllccllkNMMWOollc,:KMMMMMMM
MMMMMWx..''''''''''''''''''''''''''''''''''''''''''''''''''c0MMMMMMMMMMMMMMMMMMMMMMMMMMMMNkollooooollllloololllccoloolllcclllc::llllollcccllll:cxNMMWOlcccccxNMMNkcllllcxNMMWOolccllxNMMWOolllc'oNMMMMMM
MMMMM0;.''''''''''''''''''''''''''''''''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0dlloooooollllllllllcclllllllc:clll:;cllloolc::llllccxNMMWOllccccxNMMWkccllccdNMMWOolccllxNMMWOlllll;,OMMMMMM
MMMMNo..''''''''''''''''''''''''''''''''''''''''''''''''''''c0MMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNOdooooooolllllllllcclllllllccclllc:clclolllc:llllccxXMMWOllccccxNMMWOllccccdNMMWOolccllxNMMWOlllllc'cXMMMMM
MMMM0,.''''''''''''''''''''''''''''''''''''''''''''''''''''',oNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkdooooolllolllllcclllllloccllllc:llccllool:clllc:xNMMWOlllccckNMMWklllcccdNMMWOllccllxNMMWOllllll;,kMMMMM
MMMWo..'''''''''''''''''''''''''''''''''''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkdooollloloollccllllloolcllllc:lllcllllc:cllc:cxNMMWOlcccclkNMMWklllcccdNMMWkllclllxNMMWOllllllc'cXMMMM
MMM0,.'''''''''''''''''''''''''''''''''''''''''''''''''''''''';kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOxdlllllloolccllllooolcllllc:llllllccllcc:cccxNMMWOlcccclkNMMNkcllcccdNMMWOllllllxNMMWklllllll;,kMMMM
MMWx..''''''''''''''''''''''''''''''''''''''''''''''''''''''''';kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWXOdollololcclllooooccllllc:llllllclllcll:::xNMMWkccllclkNMMNkcllcccdNMMWOollcccdNMMWklllllllc'oWMMM
MMNc..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''';kNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0kdooolccolllloolcllllc:lllllccllcclc:::xNMMWOllllclkNMMNkcllcc:dNMMWOolccccdNMMWkllllllll,:KMMM
MM0,.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOxolccol:cooolcllllc:lllll:;clcclc:::xNMMWOllllclkNMMNkcllcc:dXMMWOlcccllxNMMWkllllllll;,kMMM
MMx..''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',l0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkllllclooolcllllc:lllll::llc:ccc::xNMMWOlclcclkNMMWklllcc:dNMMWkllllllxNMMWkllllllll:'oWMM
MWo..''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''':xNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOxollloolcllllc:lllll::ll;;llc::xNMMWOc:cllokNMMWkllccc:dXMMWkllllllxNMMWkllllllllc'cNMM
MNc..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',l0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdollccllllc:lllcl::ll::llc::xNMMWkccllllkNMMWklccll:dNMMWkllclllxNMMWkllcllllll,:KMM
MX:.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';oKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0kolcllllc:llcll::ll:cllc::xNMMWkccllllxXMMWkccllc:dXMMWkllllllxNMMWOlllllllll,;0MM
MK;.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';dKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkollllc:cllll::ll::llc:;dNMMWOlcllllxXMMWklllllcdXMMWkllllllxNMMWOlllllclll;,OMM
MK,.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';o0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdllc:lolllc:llccllc::xNMMWOllllllxXMMWklllllcdXMMWkcllllcdXMMWOlllllllll;,OMM
M0,.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';lONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXkocclolllc:llccllcccxNMMNklllllldXMMWkcllllcxNMMWkllccllkNMMWklllllllll;,kMM
MK;.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXxllllllc:clccllccckNMMWkcclllcdXMMNxcccllcxNMMWkccclllkNMMWklllllllll;,OMM
MK;.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';lkXWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0xolllccclccllc:ckNMMWOlcccllxXMMNxccccccxNMMWkccclllkNMMWOlllllllll;;OMM
MX:.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''':oONWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOoclc:cc:cllc::xNMMWOllllccxNMMWkllcclcxNMMWOl::cllkNMMWOlllllclll,;0MM
MNl..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',cdKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0dl:::clllllc:dXMMWklllllcxNMMWkllcclcxNMMWOlc:cclkNMMWOlllllclll':XMM
MWd..''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';lONWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXxc;:llllccllxNMMWOllllllkNMMWkllcclcxNMMWklccclcxNMMWOlllllcllc'lNMM
MMk'.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',cxKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNxcccclllllcdNMMWkllccllkNMMWkllcclcxNMMWOl::cllkNMMWOllllllll:'dWMM
MMK;.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';dKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXdllllllllcdXMMWkc::cllkNMMWkcccclcxNMMWOoc:cclkNMMWOlllllcll;,OMMM
MMNl..''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';o0NWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxlllllc:;dNMMWOl:;:llkNMMWklc::ccxNMMWOocccclkNMMWOlllllcll':XMMM
MMMk..''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';:oKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKdlllc:;;dNMMWOl:;cccxNMMWkll::ccxNMMWOlcccclkNMMWOlllllcl:'dWMMM
MMMX:.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''';dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWOollccccxNMMWkc;;clcxNMMWkll::ccxNMMWOlcccclkNMMWOlllllcc,;0MMMM
MMMWd..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''cONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxllccllxNMMWOl:;:clkNMMWkll::clxNMMWOlc:ccckNMMWOllllll:'lNMMMM
MMMMK;.'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''',dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMWOolccllxNMMWOl::lllkNMMWklc::ccdNMMWOlc:ccckNMMWOlllllc,,OMMMMM
MMMMWx..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''l0WMMMMMMMMMMMMMMMMMMMMMMMMMMMXxlccllxNMMWkl:clllkNMMWkccc:::dNMMWOlcccccxNMMWOlllll:'oNMMMMM
MMMMMX:..'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''c0WMMMMMMMMMMMMMMMMMMMMMMMMMMNklc:lcxNMMWOl:clccxNMMWklc::ccxNMMWOlcccccxNMMWOollll,;0MMMMMM
MMMMMMO'.''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMMWOo::ccxNMMWkccccclkNMMWkccccclxNMMWOlc::clxNMMWOllll;,xWMMMMMM
MMMMMMWo..'''''''''''''''''''''''''''''''''''''''''''''''',:cccccccccccccccccccccccccc;'''''''''''''''''''''',dNMMMMMMMMMMMMMMMMMMMMMMMMMW0o::llxNMMWOlcclllxNMMWkllc:ccxNMMWOlc::ccxNMMWklllc'lXMMMMMMM
MMMMMMMXc..''''''''''''''''''''''''''''''''''''''''''''''':0WWWWWWWWWWWWWWWWWWWWWWWWWXo''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMMKo::llxNMMWOlclllcxNMMWOol::clkNMMWkcccc:cxNMMWkllc,:KMMMMMMMM
MMMMMMMM0;.'''''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKo::llxNMMWOlclllcxNMMWOlc:cclkNMMWkcccllcxNMMWOlc,,kWMMMMMMMM
MMMMMMMMMO,.''''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMM0o::llxNMMWOlclllcxNMMWOlcccllkNMMWkcllllcxNMMWOl;,xWMMMMMMMMM
MMMMMMMMMWk'.'''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMM0o;:llxNMMWOcclllcxNMMWOlcccllkNMMWOlllllcdNMMWk:'dNMMMMMMMMMM
MMMMMMMMMMWx'.''''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKdc:::xNMMWOl:cllcxNMMWOlc:cllkNMMWOlllllcxNMMWd,oNMMMMMMMMMMM
MMMMMMMMMMMWx'.'''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKdcc:;dNMMWOlccllcxNMMWOlc::llkNMMWOlllllcdNMMNddNMMMMMMMMMMMM
MMMMMMMMMMMMWk'.''''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKdccccxNMMWOlclllcxNMMWkccccccxNMMWOlllllcdNMMWNNMMMMMMMMMMMMM
MMMMMMMMMMMMMWO,.'''''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMM0occllxNMMWOlclllcxNMMWkcclllcxNMMWOlllllcxNMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMM0:..'''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKoccllxNMMWOc:llllkNMMWOolcclcxNMMWOlllllcdNMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMXl..''''''''''''''''''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKdc:;:xNMMWOl:clllkNMMWOllcclcxNMMWOlllll:lXMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMNd'.''''''''''''''''''''''''''''''''''''':KMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKdcc:cxNMMWOlc:cllkNMMWkclcclcxNMMWOlllc;,dNMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMWO;..''''''''''''''''''''''''''''''''''':KMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKocc:cxNMMWOlcccccxNMMWkclcclcxNMMWkll:,;kWMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMXo'.'''''''''''''''''''''''''''''''''':KMMMMMMMMMMMMMMMMMMMMMMMMMNo''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMKolc::xNMMWOllllllxNMMWkclcclcxNMMWk:,'lKMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMWO:..'''''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMWd,'''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMM0olc::xNMMWkllllllkNMMWkclcclcxNMMWx';kNMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMNd,..'''''''''''''''''''''''''''''':0MMMMMMMMMMMMMMMMMMMMMMMMMMO;''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMW0lclc:dNMMWOlcclllkNMMWkclcclcdNMMNxdKMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMWKl'.''''''''''''''''''''''''''''';OMMMMMMMMMMMMMMMMMMMMMMMMMMXo''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMWOlclllxNMMWOocclllkNMMWkclccl:oXMMWWWMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMW0c...'''''''''''''''''''''''''',kWMMMMMMMMMMMMMMMMMMMMMMMMMMKl,'''''''''''''''''',dNMMMMMMMMMMMMMMMMMMMMMMMMMMNkcccllxNMMWOocclllkNMMWkcc::c:dXMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMWOc..''''''''''''''''''''''''''oNMMMMMMMMMMMMMMMMMMMMMMMMMMMXxc,'''''''''''''',lONMMMMMMMMMMMMMMMMMMMMMMMMMMMXxc:cllxNMMWOlcccllkNMMWk:ccc;,oNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWOc'..'''''''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOxoc:;;;;;;:loxKNMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0lcllllxNMMWOlcccllkNMMWx::;,ckNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0l'..''''''''''''''''''''',xWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWWNXXXXXXNWWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNkc:ccccdNMMWklccc::xNMMWx,,lONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKd;...'''''''''''''''''''cKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKdll:;;:xNMMNkllccccxNMMWkd0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNkc'..''''''''''''''''',dNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXxlllc:;:xNMMWklccclcdNMMMWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKd:...''''''''''''''';kWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNklllllcccxNMMWkllc:,,dNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0o;...''''''''''''':OWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOlcllll::cxNMMWkc;,;oONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0o:'...'''''''''':OWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNOoccllcc::lkNMMNxcoONWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc,...'''''''';xNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXkolccc::::ccdXMMWNNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOoc,...''''',l0WMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMW0dcclccc;;;,;ckNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOdc;'...'';dKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxolc::;,;:lokKWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMN0xoc;'..,oONMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWN0xl:;;;:cox0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKkdl::lx0NMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWXOoc::lodk0XWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNK00XNMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNKOxxOKNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
MMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
 *
 *
 */

pragma solidity ^0.5.3;

import "./SafeMath.sol";
import "./ERC20.sol";
import "./Pausable.sol";
import "./Ownable.sol";
import "./IIssuable.sol";
import "./IRedeemable.sol";
import "./IDestroyable.sol";
import "./IReassignable.sol";
import "./IIdentifiable.sol";
import "./IContactable.sol";
import "./IRuleEngine.sol";


/*
 .----------------.  .----------------.  .----------------.  .----------------.  .----------------. 
| .--------------. || .--------------. || .--------------. || .--------------. || .--------------. |
| |  ________    | || |  ____  ____  | || |    _______   | || |     ______   | || |  _______     | |
| | |_   ___ `.  | || | |_  _||_  _| | || |   /  ___  |  | || |   .' ___  |  | || | |_   __ \    | |
| |   | |   `. \ | || |   \ \  / /   | || |  |  (__ \_|  | || |  / .'   \_|  | || |   | |__) |   | |
| |   | |    | | | || |    > `' <    | || |   '.___`-.   | || |  | |         | || |   |  __ /    | |
| |  _| |___.' / | || |  _/ /'`\ \_  | || |  |`\____) |  | || |  \ `.___.'\  | || |  _| |  \ \_  | |
| | |________.'  | || | |____||____| | || |  |_______.'  | || |   `._____.'  | || | |____| |___| | |
| |              | || |              | || |              | || |              | || |              | |
| '--------------' || '--------------' || '--------------' || '--------------' || '--------------' |
 '----------------'  '----------------'  '----------------'  '----------------'  '----------------' 
*/
 
 
contract DXSCR is ERC20, Ownable, Pausable, IContactable, IIdentifiable, IIssuable, IRedeemable, IDestroyable, IReassignable {
  using SafeMath for uint256;

  /* Constants */
  uint8 constant TRANSFER_OK = 0;
  uint8 constant TRANSFER_REJECTED_PAUSED = 1;

  string constant TEXT_TRANSFER_OK = "No restriction";
  string constant TEXT_TRANSFER_REJECTED_PAUSED = "All transfers paused";

  string public name;
  string public symbol;
  string public contact;
  uint8 private _decimals;
  mapping (address => bytes) internal identities;
  IRuleEngine public ruleEngine;
  

  

  constructor(string memory _name, string memory _symbol, string memory _contact,  uint8 decimals) public {
    name = _name;
    symbol = _symbol;
    contact = _contact;
    _decimals = decimals;
  }

  /**
  * Purpose:
  * This event is emitted when rule engine is changed
  *
  * @param newRuleEngine - new rule engine address
  */
  event LogRuleEngineSet(address indexed newRuleEngine);
  /**
  * Purpose:
  * This event is emitted when the contact information is changed
  *
  * @param contact - new contact information
  */
  event LogContactSet(string contact);

  /**
  * Purpose
  * Set optional rule engine by owner
  * 
  * @param _ruleEngine - the rule engine that will approve/reject transfers
  */
  
  
  function setRuleEngine(IRuleEngine _ruleEngine) external onlyOwner {
    ruleEngine = _ruleEngine;
    emit LogRuleEngineSet(address(_ruleEngine));
  }

  function decimals() public view returns (uint8) {
        return _decimals;
      
  }

  /**
  * Purpose
  * Set contact point for shareholders
  * 
  * @param _contact - the contact information for the shareholders
  */
  function setContact(string calldata _contact) external onlyOwner {
    contact = _contact;
    emit LogContactSet(_contact);
  }

  /**
  * Purpose
  * Retrieve identity of a potential/actual shareholder
  */
  function identity(address shareholder) external view returns (bytes memory) {
    return identities[shareholder];
  }

  /**
  * Purpose
  * Set identity of a potential/actual shareholder. Can only be called by the potential/actual shareholder himself. Has to be encrypted data.
  * 
  * @param _identity - the potential/actual shareholder identity
  */
  function setMyIdentity(bytes calldata _identity) external {
    identities[msg.sender] = _identity;
  }

  /**
  * Purpose:
  * Issue tokens on the owner address
  *
  * @param _value - amount of newly issued tokens
  */
  function issue(uint256 _value) public onlyOwner {
    _balances[owner] = _balances[owner].add(_value);
    _totalSupply = _totalSupply.add(_value);

    emit Transfer(address(0), owner, _value);
    emit LogIssued(_value);
  }

  /**
  * Purpose:
  * Redeem tokens on the owner address
  *
  * @param _value - amount of redeemed tokens
  */
  function redeem(uint256 _value) public onlyOwner {
    _balances[owner] = _balances[owner].sub(_value);
    _totalSupply = _totalSupply.sub(_value);

    emit Transfer(owner, address(0), _value);
    emit LogRedeemed(_value);
  }

  /**
  * @dev check if _value token can be transferred from _from to _to
  * @param _from address The address which you want to send tokens from
  * @param _to address The address which you want to transfer to
  * @param _value uint256 the amount of tokens to be transferred
  */
  function canTransfer(address _from, address _to, uint256 _value) public view returns (bool) {
    if (paused()) {
      return false;
    }
    if (address(ruleEngine) != address(0)) {
      return ruleEngine.validateTransfer(_from, _to, _value);
    }
    return true;
  }

  /**
  * @dev check if _value token can be transferred from _from to _to
  * @param _from address The address which you want to send tokens from
  * @param _to address The address which you want to transfer to
  * @param _value uint256 the amount of tokens to be transferred
  * @return code of the rejection reason
  */
  function detectTransferRestriction (address _from, address _to, uint256 _value) public view returns (uint8) {
    if (paused()) {
      return TRANSFER_REJECTED_PAUSED;
    }
    if (address(ruleEngine) != address(0)) {
      return ruleEngine.detectTransferRestriction(_from, _to, _value);
    }
    return TRANSFER_OK;
  }

  /**
  * @dev returns the human readable explaination corresponding to the error code returned by detectTransferRestriction
  * @param _restrictionCode The error code returned by detectTransferRestriction
  * @return The human readable explaination corresponding to the error code returned by detectTransferRestriction
  */
  function messageForTransferRestriction (uint8 _restrictionCode) external view returns (string memory) {
    if (_restrictionCode == TRANSFER_OK) {
      return TEXT_TRANSFER_OK;
    } else if (_restrictionCode == TRANSFER_REJECTED_PAUSED) {
      return TEXT_TRANSFER_REJECTED_PAUSED;
    } else if (address(ruleEngine) != address(0)) {
      return ruleEngine.messageForTransferRestriction(_restrictionCode);
    }
  }

  /**
  * @dev transfer token for a specified address
  * @param _to The address to transfer to.
  * @param _value The amount to be transferred.
  */
  function transfer(address _to, uint256 _value) public whenNotPaused returns (bool) {
    if (address(ruleEngine) != address(0)) {
      require(ruleEngine.validateTransfer(msg.sender, _to, _value), "CM04");
      return super.transfer(_to, _value);
    } else {
      return super.transfer(_to, _value);
    }
  }

  /**
   * @dev Transfer tokens from one address to another
   * @param _from address The address which you want to send tokens from
   * @param _to address The address which you want to transfer to
   * @param _value uint256 the amount of tokens to be transferred
   */
  function transferFrom(address _from, address _to, uint256 _value) public whenNotPaused returns (bool) {
    if (address(ruleEngine) != address(0)) {
      require(ruleEngine.validateTransfer(_from, _to, _value), "CM04");
      return super.transferFrom(_from, _to, _value);
    } else {
      return super.transferFrom(_from, _to, _value);
    }
  }

  /**
   * @dev Approve the passed address to spend the specified amount of tokens on behalf of msg.sender.
   *
   * @param _spender The address which will spend the funds.
   * @param _value The amount of tokens to be spent.
   */
  function approve(address _spender, uint256 _value) public whenNotPaused returns (bool) {
    return super.approve(_spender, _value);
  }

  /**
   * @dev Increase the amount of tokens that an owner allowed to a spender.
   *
   * @param _spender The address which will spend the funds.
   * @param _addedValue The amount of tokens to increase the allowance by.
   */
  function increaseAllowance(address _spender, uint256 _addedValue) public whenNotPaused returns (bool)
  {
    return super.increaseAllowance(_spender, _addedValue);
  }

  /**
   * @dev Decrease the amount of tokens that an owner allowed to a spender.
   *
   * @param _spender The address which will spend the funds.
   * @param _subtractedValue The amount of tokens to decrease the allowance by.
   */
  function decreaseAllowance(address _spender, uint256 _subtractedValue) public whenNotPaused returns (bool)
  {
    return super.decreaseAllowance(_spender, _subtractedValue);
  }

  /**
  * Purpose:
  * To withdraw tokens from the original address and
  * transfer those tokens to the replacement address.
  * Use in cases when e.g. investor loses access to his account.
  *
  * Conditions:
  * Throw error if the `original` address supplied is not a shareholder.
  * Only issuer can execute this function.
  *
  * @param original - original address
  * @param replacement - replacement address
    */
  function reassign(address original, address replacement) external onlyOwner whenNotPaused {
    require(original != address(0), "CM01");
    require(replacement != address(0), "CM02");
    require(original != replacement, "CM03");
    uint256 originalBalance = _balances[original];
    require(originalBalance != 0, "CM05");
    _balances[replacement] = _balances[replacement].add(originalBalance);
    _balances[original] = 0;
    emit Transfer(original, replacement, originalBalance);
    emit LogReassigned(original, replacement, originalBalance);
  }

  /**
  * Purpose;
  * To destroy issued tokens.
  *
  * Conditions:
  * Only issuer can execute this function.
  *
  * @param shareholders - list of shareholders
  */
  function destroy(address[] calldata shareholders) external onlyOwner {
    for (uint256 i = 0; i<shareholders.length; i++) {
      require(shareholders[i] != owner, "CM06");
      uint256 shareholderBalance = _balances[shareholders[i]];
      _balances[owner] = _balances[owner].add(shareholderBalance);
      _balances[shareholders[i]] = 0;
      emit Transfer(shareholders[i], owner, shareholderBalance);
    }
    emit LogDestroyed(shareholders);
  }
}
