{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.5.17;\r\n\r\n\r\ncontract Ownable {\r\n\r\n\r\n  mapping (address=>bool) owners;\r\n\r\n  event AddOwner(address newOwner,string name);\r\n  event RemoveOwner(address owner);\r\n\r\n   constructor() public {\r\n    owners[msg.sender] = true;\r\n  }\r\n\r\n\r\n  modifier onlyOwners(){\r\n    require(owners[msg.sender] == true );\r\n    _;\r\n  }\r\n\r\n  function addOwner(address _newOwner,string memory newOwnerName) public onlyOwners{\r\n    require(owners[_newOwner] == false);\r\n    owners[_newOwner] = true;\r\n    emit AddOwner(_newOwner,newOwnerName);\r\n  }\r\n\r\n\r\n  function removeOwner(address _owner) public onlyOwners{\r\n    require(_owner != msg.sender);  // can't remove your self\r\n    owners[_owner] = false;\r\n    emit RemoveOwner(_owner);\r\n  }\r\n\r\n  function isOwner(address _owner) public view returns(bool){\r\n    return owners[_owner];\r\n  }\r\n\r\n}\r\n\r\n contract ERC20 {\r\n\r\n  \t  function totalSupply() public view returns (uint256);\r\n      function balanceOf(address tokenOwner) public view returns (uint256 balance);\r\n      function allowance(address tokenOwner, address spender) public view returns (uint256 remaining);\r\n\r\n      function transfer(address to, uint256 tokens) public returns (bool success);\r\n       \r\n      function approve(address spender, uint256 tokens) public returns (bool success);\r\n      function transferFrom(address from, address to, uint256 tokens) public returns (bool success);\r\n      function decimals() public view returns(uint256);\r\n      \r\n      function createKYCData(bytes32 _KycData1, bytes32 _kycData2,address  _wallet) public returns(uint256);\r\n\t  function haveKYC(address _addr) public view returns(bool);\r\n\t  function getKYCData(address _wallet) public view returns(bytes32 _data1,bytes32 _data2);\r\n\t  \r\n\t       // For WSZO only\r\n       function deposit(uint256 _amount) public;\r\n       function withdraw(uint256 _amount) public;\r\n       // SZO Only\r\n       function intTransfer(address _from, address _to, uint256 _value) external  returns(bool);\r\n\t  \r\n }\r\n\r\n\r\ncontract POOLS{\r\n    function getMaxDepositContract(address _addr) public view returns(uint256 _max);\r\n    function getAllDepositIdx(address _addr) public view returns(uint256[] memory _idx);\r\n    function getDepositDataIdx(uint256 idx) public view returns(uint256[] memory _data);\r\n}\r\n\r\ncontract SZOCalcReward{\r\n    function getReward(uint256 _time,uint256 _amount) public view returns(uint256);\r\n}\r\n\r\ncontract SZORewardPools is Ownable{\r\n    \r\n    uint256 public version = 3;\r\n    mapping (address => uint256) public lastTimeClaim;\r\n    mapping (address => uint256) public poolsRewardIdx;\r\n    mapping (address => bool) public poolsRewardActive;\r\n    \r\n    address[] public pools; \r\n    \r\n    ERC20 szoToken;\r\n    ERC20 wszoToken;\r\n    \r\n \r\n    bool  public  pauseReward;\r\n    address public newPools;\r\n\r\n    SZOCalcReward public calReward;\r\n    SZOCalcReward public SPReward;\r\n    \r\n    \r\n    constructor() public{\r\n        szoToken = ERC20(0x6086b52Cab4522b4B0E8aF9C3b2c5b8994C36ba6); \r\n        wszoToken = ERC20(0x5538Ac3ce36e73bB851921f2a804b4657b5307bf);\r\n\r\n        setPoolRewardAddr(0xE29659A35260B87264eBf1155dD03B7DE17d9B26); // DAI\r\n        setPoolRewardAddr(0x1C69D1829A5970d85bCe8dD4A4f7f568DB492c81); // USDT\r\n        setPoolRewardAddr(0x93347FFA6020a3904790220E84f38594F35bac7D); // USDC\r\n        \r\n        calReward = SZOCalcReward(0xCd02b50a0BEA9DE3f7dd2D898820842D2eC33D59); // call reward\r\n        SPReward = SZOCalcReward(0xdAD2b958A445d9e57dD86ff2dc57Ed0DEEf10671);  // 2x Reward\r\n        \r\n        szoToken.approve(0x5538Ac3ce36e73bB851921f2a804b4657b5307bf,30000000 ether);\r\n        \r\n\r\n    }\r\n    \r\n    function setRewardCal(address _addr) public onlyOwners{\r\n        calReward = SZOCalcReward(_addr);\r\n    }\r\n    \r\n    function setSPRewardCal(address _addr) public onlyOwners{\r\n        SPReward = SZOCalcReward(_addr);\r\n    }\r\n    \r\n    function addWSZO(uint256 _amount) public onlyOwners{\r\n         wszoToken.deposit(_amount);\r\n    }\r\n    \r\n    function removeWSZO(uint256 _amount) public onlyOwners{\r\n        wszoToken.withdraw(_amount);\r\n    }\r\n    \r\n    function setPauseReward() public onlyOwners{\r\n        pauseReward = true;\r\n    }\r\n    \r\n    function moveToNewRewardPools(address _newAddr) public onlyOwners{\r\n        require(pauseReward == true,\"Please Pause before move to new pools\");\r\n        \r\n        bytes32 _data1;\r\n        bytes32 _data2;\r\n        \r\n        (_data1,_data2) = szoToken.getKYCData(address(this));\r\n        \r\n        if(szoToken.haveKYC(_newAddr)  == false){\r\n          szoToken.createKYCData(_data1,_data2,_newAddr);    \r\n        }\r\n        \r\n        uint256 amount = szoToken.balanceOf(address(this));\r\n        newPools = _newAddr;\r\n        szoToken.transfer(_newAddr,amount);\r\n        amount = wszoToken.balanceOf(address(this));\r\n        wszoToken.transfer(_newAddr,amount);\r\n        \r\n    }\r\n    \r\n    \r\n    function setPoolRewardAddr(address _addr)public onlyOwners{\r\n            if(poolsRewardIdx[_addr] == 0){\r\n                uint256 idx = pools.push(_addr);\r\n                poolsRewardIdx[_addr] = idx;\r\n                poolsRewardActive[_addr] = true;\r\n            }    \r\n    }\r\n    \r\n    function setActivePools(address _addr,bool _act) public onlyOwners{\r\n        poolsRewardActive[_addr] =  _act;\r\n    }\r\n\r\n    \r\n    function getReward(address _contract,address _wallet) public view returns(uint256){\r\n        if(poolsRewardActive[_contract] == false) return 0;\r\n        \r\n        POOLS  pool = POOLS(_contract);\r\n        uint256 maxIdx = pool.getMaxDepositContract(_wallet);\r\n        uint256[] memory idxs = new uint256[](maxIdx);\r\n        idxs = pool.getAllDepositIdx(_wallet);\r\n        uint256 totalReward;\r\n        uint256 lastClaim = lastTimeClaim[_wallet];\r\n        uint256[] memory _data = new uint256[](2);\r\n        uint256 _reward;\r\n        \r\n        for(uint256 i=0;i<maxIdx;i++){\r\n            _data = pool.getDepositDataIdx(idxs[i]-1);\r\n            if(_data[0] > 0){\r\n                if(_data[1] > lastClaim){\r\n                    _reward =  calReward.getReward(now - _data[1],_data[0]); \r\n                }\r\n                else\r\n                {\r\n                    _reward =  calReward.getReward(now - lastClaim,_data[0]); \r\n                }\r\n                totalReward += _reward;\r\n            }\r\n        }\r\n        \r\n        return totalReward;\r\n    }\r\n    \r\n    \r\n    function getRewardSP(address _contract,address _wallet) public view returns(uint256){\r\n        if(poolsRewardActive[_contract] == false) return 0;\r\n        \r\n        POOLS  pool = POOLS(_contract);\r\n        uint256 maxIdx = pool.getMaxDepositContract(_wallet);\r\n        uint256[] memory idxs = new uint256[](maxIdx);\r\n        idxs = pool.getAllDepositIdx(_wallet);\r\n        uint256 totalReward;\r\n        uint256[] memory _data = new uint256[](2);\r\n        uint256 _reward;\r\n        \r\n        uint256 lastClaim = lastTimeClaim[_wallet];\r\n        \r\n        \r\n        for(uint256 i=0;i<maxIdx;i++){\r\n            _data = pool.getDepositDataIdx(idxs[i]-1);\r\n            if(_data[0] > 0){\r\n                if(_data[1] > lastClaim )\r\n                    _reward =  SPReward.getReward(_data[1],_data[0]); \r\n                else\r\n                    _reward =  SPReward.getReward(lastClaim,_data[0]); \r\n                totalReward += _reward;\r\n            }\r\n        }\r\n        \r\n        return totalReward;\r\n    }\r\n    \r\n    function summarySZOReward(address _addr) public view returns(uint256 sumBalance,uint256[] memory _pool,uint256[] memory _poolSP){\r\n         _pool = new uint256[](pools.length);\r\n         _poolSP = new uint256[](pools.length);\r\n         \r\n         for(uint256 i=0;i<pools.length;i++){\r\n                _pool[i] = getReward(pools[i],_addr);\r\n                _poolSP[i] = getRewardSP(pools[i],_addr);\r\n                 sumBalance += _pool[i] + _poolSP[i];\r\n             }\r\n    }\r\n     \r\n\r\n    function claimWSZOReward(address _wallet) public returns(uint256 _claim){\r\n        require(msg.sender == _wallet || owners[msg.sender] == true,\"No permission to claim reward\");\r\n        require(pauseReward == false,\"REWARD PAUSE TO CLAIM\");\r\n        \r\n        (_claim,,) = summarySZOReward(_wallet);\r\n        lastTimeClaim[_wallet] = now;\r\n        if(_claim > wszoToken.balanceOf(address(this))) _claim = wszoToken.balanceOf(address(this));\r\n        \r\n        wszoToken.transfer(_wallet,_claim);\r\n    }\r\n    \r\n    function claimReward(address _wallet) public  returns(uint256 _claim){\r\n        require(msg.sender == _wallet || owners[msg.sender] == true,\"No permission to claim reward\");\r\n        require(pauseReward == false,\"REWARD PAUSE TO CLAIM\");\r\n        \r\n        (_claim,,) = summarySZOReward(_wallet);\r\n        lastTimeClaim[_wallet] = now;\r\n\r\n        if(_claim > szoToken.balanceOf(address(this))) _claim = szoToken.balanceOf(address(this));\r\n\r\n        szoToken.transfer(_wallet,_claim);\r\n       \r\n        return _claim;\r\n    }\r\n}","ABI":"[{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"string\",\"name\":\"name\",\"type\":\"string\"}],\"name\":\"AddOwner\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"address\",\"name\":\"owner\",\"type\":\"address\"}],\"name\":\"RemoveOwner\",\"type\":\"event\"},{\"constant\":true,\"inputs\":[],\"name\":\"SPReward\",\"outputs\":[{\"internalType\":\"contract SZOCalcReward\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_newOwner\",\"type\":\"address\"},{\"internalType\":\"string\",\"name\":\"newOwnerName\",\"type\":\"string\"}],\"name\":\"addOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"addWSZO\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"calReward\",\"outputs\":[{\"internalType\":\"contract SZOCalcReward\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"claimReward\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"_claim\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"claimWSZOReward\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"_claim\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_contract\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getReward\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_contract\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_wallet\",\"type\":\"address\"}],\"name\":\"getRewardSP\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"isOwner\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"lastTimeClaim\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_newAddr\",\"type\":\"address\"}],\"name\":\"moveToNewRewardPools\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"newPools\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pauseReward\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"pools\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"poolsRewardActive\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"poolsRewardIdx\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"removeOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"removeWSZO\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_addr\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"_act\",\"type\":\"bool\"}],\"name\":\"setActivePools\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"setPauseReward\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"setPoolRewardAddr\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"setRewardCal\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"setSPRewardCal\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"summarySZOReward\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"sumBalance\",\"type\":\"uint256\"},{\"internalType\":\"uint256[]\",\"name\":\"_pool\",\"type\":\"uint256[]\"},{\"internalType\":\"uint256[]\",\"name\":\"_poolSP\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"version\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"SZORewardPools","CompilerVersion":"v0.5.17+commit.d19bba13","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"None","Proxy":"0","Implementation":"","SwarmSource":"bzzr://f709214fb2669266f617e38095cb5906b3e46e469709cc98274544aa594ec3ce"}]}