{"status":"1","message":"OK","result":[{"SourceCode":"/**\r\n *Submitted for verification at Etherscan.io on 2021-01-31\r\n*/\r\n\r\npragma solidity ^0.8.1;\r\n\r\ncontract Proxy {\r\n  address public immutable implementation;\r\n\r\n  constructor(address _implementation) {\r\n    implementation = _implementation;\r\n  }\r\n\r\n  fallback () external payable {\r\n    address _impl = implementation;\r\n\r\n    assembly {\r\n      let ptr := mload(0x40)\r\n      calldatacopy(ptr, 0, calldatasize())\r\n      let result := delegatecall(gas(), _impl, ptr, calldatasize(), 0, 0)\r\n      let size := returndatasize()\r\n      returndatacopy(ptr, 0, size)\r\n\r\n      switch result\r\n      case 0 { revert(ptr, size) }\r\n      default { return(ptr, size) }\r\n    }\r\n  }\r\n\r\n  receive () external payable { }\r\n}\r\n\r\n\r\ncontract Autem {\r\n  address public owner;\r\n  uint96  public lastPing;\r\n  address public beneficiary;\r\n  uint96  public window;\r\n\r\n  string  public metadata;\r\n\r\n  event Ping() anonymous;\r\n  event SetOwner(address indexed _owner);\r\n  event SetBeneficiary(address indexed _beneficiary);\r\n  event SetWindow(uint96 _window);\r\n  event Call(bool _success, bytes _result);\r\n\r\n  constructor() {\r\n    lastPing = uint96(1);\r\n  }\r\n\r\n  function setup(\r\n    address _owner,\r\n    address _beneficiary,\r\n    uint96  _window,\r\n    string calldata _metadata\r\n  ) external returns (bool) {\r\n    require(_owner != address(0), \"E400\");\r\n    require(owner == address(0) && lastPing == 0, \"E405\");\r\n\r\n    owner = _owner;\r\n    lastPing = uint96(block.timestamp);\r\n    beneficiary = _beneficiary;\r\n    window = _window;\r\n\r\n    emit Ping();\r\n    emit SetOwner(_owner);\r\n    emit SetBeneficiary(_beneficiary);\r\n    emit SetWindow(_window);\r\n\r\n    metadata = _metadata;\r\n\r\n    return true;\r\n  }\r\n\r\n  modifier auth() {\r\n    address m_owner = owner;\r\n\r\n    if (msg.sender != m_owner) {\r\n      if (msg.sender == beneficiary) {\r\n        require(block.timestamp - lastPing >= window, \"E425\");\r\n      } else {\r\n        revert(\"E401\");\r\n      }\r\n    }\r\n\r\n    assert(msg.sender != address(0));\r\n\r\n    _;\r\n\r\n    if (m_owner == msg.sender) {\r\n      lastPing = uint96(block.timestamp);\r\n      emit Ping();\r\n    }\r\n  }\r\n\r\n  function setMetadata(string calldata _metadata) external auth {\r\n    metadata = _metadata;\r\n  }\r\n\r\n  function setOwner(address _owner) external auth {\r\n    require(_owner != address(0), \"E400\");\r\n    emit SetOwner(_owner);\r\n    owner = _owner;\r\n  }\r\n\r\n  function setBeneficiary(address _beneficiary) external auth {\r\n    emit SetBeneficiary(_beneficiary);\r\n    beneficiary = _beneficiary;\r\n  }\r\n\r\n  function setWindow(uint96 _window) external auth {\r\n    emit SetWindow(_window);\r\n    window = _window;\r\n  }\r\n\r\n  function execute(address payable _to, uint256 _val, bytes calldata _data) external auth {\r\n    if (_to == address(this)) return;\r\n\r\n    (bool success, bytes memory result) = _to.call{ value: _val }(_data);\r\n    emit Call(success, result);\r\n  }\r\n\r\n  fallback() external payable { }\r\n  receive() external payable { }\r\n}\r\n\r\ncontract Factory {\r\n  Autem public immutable implementation;\r\n\r\n  constructor() {\r\n    implementation = new Autem();\r\n  }\r\n\r\n  function create(\r\n    address _owner,\r\n    address _beneficiary,\r\n    uint96  _window,\r\n    string calldata _metadata\r\n  ) external {\r\n    bytes32 salt = keccak256(\r\n      abi.encode(\r\n        _owner,\r\n        _beneficiary,\r\n        _window,\r\n        _metadata\r\n      )\r\n    );\r\n\r\n    Proxy proxy = new Proxy{ salt: salt }(address(implementation));\r\n    assert(Autem(payable(proxy)).setup(_owner, _beneficiary, _window, _metadata));\r\n  }\r\n}","ABI":"[{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_owner\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_beneficiary\",\"type\":\"address\"},{\"internalType\":\"uint96\",\"name\":\"_window\",\"type\":\"uint96\"},{\"internalType\":\"string\",\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"create\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"implementation\",\"outputs\":[{\"internalType\":\"contract Autem\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"Factory","CompilerVersion":"v0.8.1+commit.df193b15","OptimizationUsed":"1","Runs":"1","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"GNU GPLv3","Proxy":"0","Implementation":"","SwarmSource":"ipfs://b59edf9b5b82830875a57b1b37dfe94f94826d67ccd7f0d972ce51022181c029"}]}