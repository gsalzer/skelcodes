{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.11;\r\n\r\ncontract Ownable {\r\n  address public owner;\r\n\r\n  function Ownable() {\r\n    owner = msg.sender;\r\n  }\r\n\r\n  modifier onlyOwner() {\r\n    require(msg.sender == owner);\r\n    _;\r\n  }\r\n\r\n  function transferOwnership(address newOwner) onlyOwner {\r\n    require(newOwner != address(0));\r\n    owner = newOwner;\r\n  }\r\n}\r\n\r\nlibrary SafeMath {\r\n  function add(uint256 a, uint256 b) internal constant returns (uint256) {\r\n    uint256 c = a + b;\r\n    assert(c >= a);\r\n    return c;\r\n  }\r\n}\r\n\r\ncontract EthCapsule is Ownable {\r\n  struct Depositor {\r\n    uint numCapsules;\r\n    mapping (uint => Capsule) capsules;\r\n  }\r\n\r\n  mapping (address => Depositor) depositors;\r\n\r\n  struct Capsule {\r\n    uint value;\r\n    uint id;\r\n    uint lockTime;\r\n    uint unlockTime;\r\n    uint withdrawnTime;\r\n  }\r\n\r\n  uint public minDeposit = 1000000000000000;\r\n  uint public minDuration = 0;\r\n  uint public maxDuration = 157680000;\r\n  uint public totalCapsules;\r\n  uint public totalValue;\r\n  uint public totalBuriedCapsules;\r\n\r\n  function bury(uint unlockTime) payable {\r\n    require(msg.value >= minDeposit);\r\n    require(unlockTime <= block.timestamp + maxDuration);\r\n\r\n    if (unlockTime < block.timestamp + minDuration) {\r\n      unlockTime = SafeMath.add(block.timestamp, minDuration);\r\n    }\r\n\r\n    if (depositors[msg.sender].numCapsules <= 0) {\r\n        depositors[msg.sender] = Depositor({ numCapsules: 0 });\r\n    }\r\n\r\n    Depositor storage depositor = depositors[msg.sender];\r\n\r\n    depositor.numCapsules++;\r\n    depositor.capsules[depositor.numCapsules] = Capsule({\r\n        value: msg.value,\r\n        id: depositors[msg.sender].numCapsules,\r\n        lockTime: block.timestamp,\r\n        unlockTime: unlockTime,\r\n        withdrawnTime: 0\r\n    });\r\n\r\n    totalBuriedCapsules++;\r\n    totalCapsules++;\r\n    totalValue = SafeMath.add(totalValue, msg.value);\r\n  }\r\n\r\n  function dig(uint capsuleNumber) {\r\n    Capsule storage capsule = depositors[msg.sender].capsules[capsuleNumber];\r\n\r\n    require(capsule.unlockTime <= block.timestamp);\r\n    require(capsule.withdrawnTime == 0);\r\n\r\n    totalBuriedCapsules--;\r\n    capsule.withdrawnTime = block.timestamp;\r\n    msg.sender.transfer(capsule.value);\r\n  }\r\n\r\n  function setMinDeposit(uint min) onlyOwner {\r\n    minDeposit = min;\r\n  }\r\n\r\n  function setMinDuration(uint min) onlyOwner {\r\n    minDuration = min;\r\n  }\r\n\r\n  function setMaxDuration(uint max) onlyOwner {\r\n    maxDuration = max;\r\n  }\r\n  \r\n  function getCapsuleInfo(uint capsuleNum) constant returns (uint, uint, uint, uint, uint) {\r\n    return (\r\n        depositors[msg.sender].capsules[capsuleNum].value,\r\n        depositors[msg.sender].capsules[capsuleNum].id,\r\n        depositors[msg.sender].capsules[capsuleNum].lockTime,\r\n        depositors[msg.sender].capsules[capsuleNum].unlockTime,\r\n        depositors[msg.sender].capsules[capsuleNum].withdrawnTime\r\n    );\r\n  }\r\n\r\n  function getNumberOfCapsules() constant returns (uint) {\r\n    return depositors[msg.sender].numCapsules;\r\n  }\r\n\r\n  function totalBuriedValue() constant returns (uint) {\r\n    return this.balance;\r\n  }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"min\",\"type\":\"uint256\"}],\"name\":\"setMinDuration\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalBuriedValue\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"capsuleNum\",\"type\":\"uint256\"}],\"name\":\"getCapsuleInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalBuriedCapsules\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getNumberOfCapsules\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"capsuleNumber\",\"type\":\"uint256\"}],\"name\":\"dig\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"minDeposit\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"minDuration\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxDuration\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"min\",\"type\":\"uint256\"}],\"name\":\"setMinDeposit\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"unlockTime\",\"type\":\"uint256\"}],\"name\":\"bury\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalCapsules\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"max\",\"type\":\"uint256\"}],\"name\":\"setMaxDuration\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalValue\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]","ContractName":"EthCapsule","CompilerVersion":"v0.4.16+commit.d7661dd9","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://b2bb2f30ea1bd629178a1efc6c985f3dc9781e5591c859add632e779eb10a60b"}]}