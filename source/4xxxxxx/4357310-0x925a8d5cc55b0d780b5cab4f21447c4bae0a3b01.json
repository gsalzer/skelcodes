{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.4.15;\r\n\r\n/// @title Ownable\r\n/// @dev The Ownable contract has an owner address, and provides basic authorization control\r\n/// functions, this simplifies the implementation of \"user permissions\".\r\ncontract Ownable {\r\n\r\n  // EVENTS\r\n\r\n  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\r\n\r\n  // PUBLIC FUNCTIONS\r\n\r\n  /// @dev The Ownable constructor sets the original `owner` of the contract to the sender account.\r\n  function Ownable() {\r\n    owner = msg.sender;\r\n  }\r\n\r\n  /// @dev Allows the current owner to transfer control of the contract to a newOwner.\r\n  /// @param newOwner The address to transfer ownership to.\r\n  function transferOwnership(address newOwner) onlyOwner public {\r\n    require(newOwner != address(0));\r\n    OwnershipTransferred(owner, newOwner);\r\n    owner = newOwner;\r\n  }\r\n\r\n  // MODIFIERS\r\n\r\n  /// @dev Throws if called by any account other than the owner.\r\n  modifier onlyOwner() {\r\n    require(msg.sender == owner);\r\n    _;\r\n  }\r\n\r\n  // FIELDS\r\n\r\n  address public owner;\r\n}\r\n\r\n\r\ncontract DaoOwnable is Ownable{\r\n\r\n    address public dao = address(0);\r\n\r\n    event DaoOwnershipTransferred(address indexed previousOwner, address indexed newOwner);\r\n\r\n    /**\r\n     * @dev Throws if called by any account other than the dao.\r\n     */\r\n    modifier onlyDao() {\r\n        require(msg.sender == dao);\r\n        _;\r\n    }\r\n\r\n    modifier onlyDaoOrOwner() {\r\n        require(msg.sender == dao || msg.sender == owner);\r\n        _;\r\n    }\r\n\r\n\r\n    /**\r\n     * @dev Allows the current owner to transfer control of the contract to a newDao.\r\n     * @param newDao The address to transfer ownership to.\r\n     */\r\n    function transferDao(address newDao) onlyOwner {\r\n        require(newDao != address(0));\r\n        dao = newDao;\r\n        DaoOwnershipTransferred(owner, newDao);\r\n    }\r\n\r\n}\r\n\r\ncontract SSPTypeAware {\r\n    enum SSPType { Gate, Direct }\r\n}\r\n\r\ncontract SSPRegistry is SSPTypeAware{\r\n    // This is the function that actually insert a record.\r\n    function register(address key, SSPType sspType, uint16 publisherFee, address recordOwner);\r\n\r\n    // Updates the values of the given record.\r\n    function updatePublisherFee(address key, uint16 newFee, address sender);\r\n\r\n    function applyKarmaDiff(address key, uint256[2] diff);\r\n\r\n    // Unregister a given record\r\n    function unregister(address key, address sender);\r\n\r\n    //Transfer ownership of record\r\n    function transfer(address key, address newOwner, address sender);\r\n\r\n    function getOwner(address key) constant returns(address);\r\n\r\n    // Tells whether a given key is registered.\r\n    function isRegistered(address key) constant returns(bool);\r\n\r\n    function getSSP(address key) constant returns(address sspAddress, SSPType sspType, uint16 publisherFee, uint256[2] karma, address recordOwner);\r\n\r\n    function getAllSSP() constant returns(address[] addresses, SSPType[] sspTypes, uint16[] publisherFees, uint256[2][] karmas, address[] recordOwners);\r\n\r\n    function kill();\r\n}\r\n\r\n\r\ncontract SSPRegistryImpl is SSPRegistry, DaoOwnable {\r\n\r\n    uint public creationTime = now;\r\n\r\n    // This struct keeps all data for a SSP.\r\n    struct SSP {\r\n        // Keeps the address of this record creator.\r\n        address owner;\r\n        // Keeps the time when this record was created.\r\n        uint time;\r\n        // Keeps the index of the keys array for fast lookup\r\n        uint keysIndex;\r\n        // SSP Address\r\n        address sspAddress;\r\n\r\n        SSPType sspType;\r\n\r\n        uint16 publisherFee;\r\n\r\n        uint256[2] karma;\r\n    }\r\n\r\n    // This mapping keeps the records of this Registry.\r\n    mapping(address => SSP) records;\r\n\r\n    // Keeps the total numbers of records in this Registry.\r\n    uint public numRecords;\r\n\r\n    // Keeps a list of all keys to interate the records.\r\n    address[] public keys;\r\n\r\n    // This is the function that actually insert a record.\r\n    function register(address key, SSPType sspType, uint16 publisherFee, address recordOwner) onlyDaoOrOwner {\r\n        require(records[key].time == 0);\r\n        records[key].time = now;\r\n        records[key].owner = recordOwner;\r\n        records[key].keysIndex = keys.length;\r\n        records[key].sspAddress = key;\r\n        records[key].sspType = sspType;\r\n        records[key].publisherFee = publisherFee;\r\n        keys.length++;\r\n        keys[keys.length - 1] = key;\r\n        numRecords++;\r\n    }\r\n\r\n    // Updates the values of the given record.\r\n    function updatePublisherFee(address key, uint16 newFee, address sender) onlyDaoOrOwner {\r\n        // Only the owner can update his record.\r\n        require(records[key].owner == sender);\r\n        records[key].publisherFee = newFee;\r\n    }\r\n\r\n    function applyKarmaDiff(address key, uint256[2] diff) onlyDaoOrOwner {\r\n        SSP storage ssp = records[key];\r\n        ssp.karma[0] += diff[0];\r\n        ssp.karma[1] += diff[1];\r\n    }\r\n\r\n    // Unregister a given record\r\n    function unregister(address key, address sender) onlyDaoOrOwner {\r\n        require(records[key].owner == sender);\r\n        uint keysIndex = records[key].keysIndex;\r\n        delete records[key];\r\n        numRecords--;\r\n        keys[keysIndex] = keys[keys.length - 1];\r\n        records[keys[keysIndex]].keysIndex = keysIndex;\r\n        keys.length--;\r\n    }\r\n\r\n    // Transfer ownership of a given record.\r\n    function transfer(address key, address newOwner, address sender) onlyDaoOrOwner {\r\n        require(records[key].owner == sender);\r\n        records[key].owner = newOwner;\r\n    }\r\n\r\n    // Tells whether a given key is registered.\r\n    function isRegistered(address key) constant returns(bool) {\r\n        return records[key].time != 0;\r\n    }\r\n\r\n    function getSSP(address key) constant returns(address sspAddress, SSPType sspType, uint16 publisherFee, uint256[2] karma, address recordOwner) {\r\n        SSP storage record = records[key];\r\n        sspAddress = record.sspAddress;\r\n        sspType = record.sspType;\r\n        publisherFee = record.publisherFee;\r\n        karma = record.karma;\r\n        recordOwner = owner;\r\n    }\r\n\r\n    // Returns the owner of the given record. The owner could also be get\r\n    // by using the function getSSP but in that case all record attributes\r\n    // are returned.\r\n    function getOwner(address key) constant returns(address) {\r\n        return records[key].owner;\r\n    }\r\n\r\n    function getAllSSP() constant returns(address[] addresses, SSPType[] sspTypes, uint16[] publisherFees, uint256[2][] karmas, address[] recordOwners) {\r\n        addresses = new address[](numRecords);\r\n        sspTypes = new SSPType[](numRecords);\r\n        publisherFees = new uint16[](numRecords);\r\n        karmas = new uint256[2][](numRecords);\r\n        recordOwners = new address[](numRecords);\r\n        uint i;\r\n        for(i = 0; i < numRecords; i++) {\r\n            SSP storage ssp = records[keys[i]];\r\n            addresses[i] = ssp.sspAddress;\r\n            sspTypes[i] = ssp.sspType;\r\n            publisherFees[i] = ssp.publisherFee;\r\n            karmas[i] = ssp.karma;\r\n            recordOwners[i] = ssp.owner;\r\n        }\r\n    }\r\n\r\n    // Returns the registration time of the given record. The time could also\r\n    // be get by using the function getSSP but in that case all record attributes\r\n    // are returned.\r\n    function getTime(address key) constant returns(uint) {\r\n        return records[key].time;\r\n    }\r\n\r\n    function kill() onlyOwner {\r\n        selfdestruct(owner);\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"},{\"name\":\"sspType\",\"type\":\"uint8\"},{\"name\":\"publisherFee\",\"type\":\"uint16\"},{\"name\":\"recordOwner\",\"type\":\"address\"}],\"name\":\"register\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"keys\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"},{\"name\":\"newFee\",\"type\":\"uint16\"},{\"name\":\"sender\",\"type\":\"address\"}],\"name\":\"updatePublisherFee\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dao\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"},{\"name\":\"sender\",\"type\":\"address\"}],\"name\":\"unregister\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"}],\"name\":\"getTime\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"},{\"name\":\"newOwner\",\"type\":\"address\"},{\"name\":\"sender\",\"type\":\"address\"}],\"name\":\"transfer\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"numRecords\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getAllSSP\",\"outputs\":[{\"name\":\"addresses\",\"type\":\"address[]\"},{\"name\":\"sspTypes\",\"type\":\"uint8[]\"},{\"name\":\"publisherFees\",\"type\":\"uint16[]\"},{\"name\":\"karmas\",\"type\":\"uint256[2][]\"},{\"name\":\"recordOwners\",\"type\":\"address[]\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"}],\"name\":\"isRegistered\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"},{\"name\":\"diff\",\"type\":\"uint256[2]\"}],\"name\":\"applyKarmaDiff\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"}],\"name\":\"getSSP\",\"outputs\":[{\"name\":\"sspAddress\",\"type\":\"address\"},{\"name\":\"sspType\",\"type\":\"uint8\"},{\"name\":\"publisherFee\",\"type\":\"uint16\"},{\"name\":\"karma\",\"type\":\"uint256[2]\"},{\"name\":\"recordOwner\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"creationTime\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newDao\",\"type\":\"address\"}],\"name\":\"transferDao\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"key\",\"type\":\"address\"}],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"DaoOwnershipTransferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"}]","ContractName":"SSPRegistryImpl","CompilerVersion":"v0.4.15+commit.bbb8e64f","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://f14cda17770238b44fb3297d66085b029fcf1951bff54ba1625b956c6470bcef"}]}