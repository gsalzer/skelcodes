{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.4.21;\r\n/**\r\n * @title Ownable Contract\r\n * @dev contract that has a user and can implement user access restrictions based on it\r\n */\r\ncontract Ownable {\r\n\r\n  address public owner;\r\n\r\n  /**\r\n   * @dev sets owner of contract\r\n   */\r\n  function Ownable() public {\r\n    owner = msg.sender;\r\n  }\r\n\r\n  /**\r\n   * @dev changes owner of contract\r\n   * @param newOwner New owner\r\n   */\r\n  function changeOwner(address newOwner) public ownerOnly {\r\n    require(newOwner != address(0));\r\n    owner = newOwner;\r\n  }\r\n\r\n  /**\r\n   * @dev Throws if called by other account than owner\r\n   */\r\n  modifier ownerOnly() {\r\n    require(msg.sender == owner);\r\n    _;\r\n  }\r\n}\r\n\r\n/**\r\n * @title Emergency Safety contract\r\n * @dev Allows token and ether drain and pausing of contract\r\n */ \r\ncontract EmergencySafe is Ownable{ \r\n\r\n  event PauseToggled(bool isPaused);\r\n\r\n  bool public paused;\r\n\r\n\r\n  /**\r\n   * @dev Throws if contract is paused\r\n   */\r\n  modifier isNotPaused() {\r\n    require(!paused);\r\n    _;\r\n  }\r\n\r\n  /**\r\n   * @dev Throws if contract is not paused\r\n   */\r\n  modifier isPaused() {\r\n    require(paused);\r\n    _; \r\n  }\r\n\r\n  /**\r\n   * @dev Initialises contract to non-paused\r\n   */\r\n  function EmergencySafe() public {\r\n    paused = false;\r\n  }\r\n\r\n  /**\r\n   * @dev Allows draining of tokens (to owner) that might accidentally be sent to this address\r\n   * @param token Address of ERC20 token\r\n   * @param amount Amount to drain\r\n   */\r\n  function emergencyERC20Drain(ERC20Interface token, uint amount) public ownerOnly{\r\n    token.transfer(owner, amount);\r\n  }\r\n\r\n  /**\r\n   * @dev Allows draining of Ether\r\n   * @param amount Amount to drain\r\n   */\r\n  function emergencyEthDrain(uint amount) public ownerOnly returns (bool){\r\n    return owner.send(amount);\r\n  }\r\n\r\n  /**\r\n   * @dev Switches the contract from paused to non-paused or vice-versa\r\n   */\r\n  function togglePause() public ownerOnly {\r\n    paused = !paused;\r\n    emit PauseToggled(paused);\r\n  }\r\n}\r\n\r\n\r\n/**\r\n * @title Upgradeable Conract\r\n * @dev contract that implements doubly linked list to keep track of old and new \r\n * versions of this contract\r\n */ \r\ncontract Upgradeable is Ownable{\r\n\r\n  address public lastContract;\r\n  address public nextContract;\r\n  bool public isOldVersion;\r\n  bool public allowedToUpgrade;\r\n\r\n  /**\r\n   * @dev makes contract upgradeable \r\n   */\r\n  function Upgradeable() public {\r\n    allowedToUpgrade = true;\r\n  }\r\n\r\n  /**\r\n   * @dev signals that new upgrade is available, contract must be most recent \r\n   * upgrade and allowed to upgrade\r\n   * @param newContract Address of upgraded contract \r\n   */\r\n  function upgradeTo(Upgradeable newContract) public ownerOnly{\r\n    require(allowedToUpgrade && !isOldVersion);\r\n    nextContract = newContract;\r\n    isOldVersion = true;\r\n    newContract.confirmUpgrade();   \r\n  }\r\n\r\n  /**\r\n   * @dev confirmation that this is indeed the next version,\r\n   * called from previous version of contract. Anyone can call this function,\r\n   * which basically makes this instance unusable if that happens. Once called,\r\n   * this contract can not serve as upgrade to another contract. Not an ideal solution\r\n   * but will work until we have a more sophisticated approach using a dispatcher or similar\r\n   */\r\n  function confirmUpgrade() public {\r\n    require(lastContract == address(0));\r\n    lastContract = msg.sender;\r\n  }\r\n}\r\n\r\n/**\r\n * @title IXT payment contract in charge of administaring IXT payments \r\n * @dev contract looks up price for appropriate tasks and sends transferFrom() for user,\r\n * user must approve this contract to spend IXT for them before being able to use it\r\n */ \r\ncontract IXTPaymentContract is Ownable, EmergencySafe, Upgradeable{\r\n\r\n  event IXTPayment(address indexed from, address indexed to, uint value, string indexed action);\r\n\r\n  ERC20Interface public tokenContract;\r\n\r\n  mapping(string => uint) private actionPrices;\r\n  mapping(address => bool) private allowed;\r\n\r\n  /**\r\n   * @dev Throws if called by non-allowed contract\r\n   */\r\n  modifier allowedOnly() {\r\n    require(allowed[msg.sender] || msg.sender == owner);\r\n    _;\r\n  }\r\n\r\n  /**\r\n   * @dev sets up token address of IXT token\r\n   * adds owner to allowds, if owner is changed in the future, remember to remove old\r\n   * owner if desired\r\n   * @param tokenAddress IXT token address\r\n   */\r\n  function IXTPaymentContract(address tokenAddress) public {\r\n    tokenContract = ERC20Interface(tokenAddress);\r\n    allowed[owner] = true;\r\n  }\r\n\r\n  /**\r\n   * @dev transfers IXT \r\n   * @param from User address\r\n   * @param to Recipient\r\n   * @param action Service the user is paying for \r\n   */\r\n  function transferIXT(address from, address to, string action) public allowedOnly isNotPaused returns (bool) {\r\n    if (isOldVersion) {\r\n      IXTPaymentContract newContract = IXTPaymentContract(nextContract);\r\n      return newContract.transferIXT(from, to, action);\r\n    } else {\r\n      uint price = actionPrices[action];\r\n\r\n      if(price != 0 && !tokenContract.transferFrom(from, to, price)){\r\n        return false;\r\n      } else {\r\n        emit IXTPayment(from, to, price, action);     \r\n        return true;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @dev sets new token address in case of update\r\n   * @param erc20Token Token address\r\n   */\r\n  function setTokenAddress(address erc20Token) public ownerOnly isNotPaused {\r\n    tokenContract = ERC20Interface(erc20Token);\r\n  }\r\n\r\n  /**\r\n   * @dev creates/updates action\r\n   * @param action Action to be paid for \r\n   * @param price Price (in units * 10 ^ (<decimal places of token>))\r\n   */\r\n  function setAction(string action, uint price) public ownerOnly isNotPaused {\r\n    actionPrices[action] = price;\r\n  }\r\n\r\n  /**\r\n   * @dev retrieves price for action\r\n   * @param action Name of action, e.g. 'create_insurance_contract'\r\n   */\r\n  function getActionPrice(string action) public view returns (uint) {\r\n    return actionPrices[action];\r\n  }\r\n\r\n\r\n  /**\r\n   * @dev add account to allow calling of transferIXT\r\n   * @param allowedAddress Address of account \r\n   */\r\n  function setAllowed(address allowedAddress) public ownerOnly {\r\n    allowed[allowedAddress] = true;\r\n  }\r\n\r\n  /**\r\n   * @dev remove account from allowed accounts\r\n   * @param allowedAddress Address of account \r\n   */\r\n  function removeAllowed(address allowedAddress) public ownerOnly {\r\n    allowed[allowedAddress] = false;\r\n  }\r\n}\r\n\r\ncontract ERC20Interface {\r\n    uint public totalSupply;\r\n    function balanceOf(address tokenOwner) public constant returns (uint balance);\r\n    function allowance(address tokenOwner, address spender) public constant returns (uint remaining);\r\n    function transfer(address to, uint tokens) public returns (bool success);\r\n    function approve(address spender, uint tokens) public returns (bool success);\r\n    function transferFrom(address from, address to, uint tokens) public returns (bool success);\r\n\r\n    event Transfer(address indexed from, address indexed to, uint tokens);\r\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"isOldVersion\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"erc20Token\",\"type\":\"address\"}],\"name\":\"setTokenAddress\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"from\",\"type\":\"address\"},{\"name\":\"to\",\"type\":\"address\"},{\"name\":\"action\",\"type\":\"string\"}],\"name\":\"transferIXT\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"emergencyEthDrain\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newContract\",\"type\":\"address\"}],\"name\":\"upgradeTo\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"paused\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"allowedAddress\",\"type\":\"address\"}],\"name\":\"removeAllowed\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"allowedToUpgrade\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"confirmUpgrade\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"changeOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lastContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"allowedAddress\",\"type\":\"address\"}],\"name\":\"setAllowed\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"togglePause\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"action\",\"type\":\"string\"}],\"name\":\"getActionPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"nextContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"token\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"emergencyERC20Drain\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"action\",\"type\":\"string\"},{\"name\":\"price\",\"type\":\"uint256\"}],\"name\":\"setAction\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"tokenAddress\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"value\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"action\",\"type\":\"string\"}],\"name\":\"IXTPayment\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"isPaused\",\"type\":\"bool\"}],\"name\":\"PauseToggled\",\"type\":\"event\"}]","ContractName":"IXTPaymentContract","CompilerVersion":"v0.4.21+commit.dfe3193c","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"000000000000000000000000fca47962d45adfdfd1ab2d972315db4ce7ccf094","Library":"","SwarmSource":"bzzr://0f8b952b80d2d4c449cc9b9035d34fa10b1408145790f0742427155b5ef035a8"}]}