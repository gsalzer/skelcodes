{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.18;\r\n\r\n//\r\n// LimeEyes\r\n// Decentralized art on the Ethereum blockchain!\r\n// (https://limeeyes.com/)\r\n/*\r\n             ___                  ___        \r\n         .-''   ''-.          .-''   ''-.    \r\n       .'           '.      .'           '.  \r\n      /   . -  ;  - . \\    /   . -  ;  - . \\ \r\n     (  ' `-._|_,'_,.- )  (  ' `-._|_,'_,.- )\r\n      ',,.--_,4\"-;_  ,'    ',,.--_,4\"-;_  ,' \r\n        '-.;   \\ _.-'        '-.;   \\ _.-'   \r\n            '''''                '''''       \r\n*/\r\n// Welcome to LimeEyes!\r\n//\r\n// This smart contract allows users to purchase shares of any artwork that's\r\n// been added to the system and it will pay dividends to all shareholders\r\n// upon the purchasing of new shares! It's special in the way it works because\r\n// the shares can only be bought in certain amounts and the price of those \r\n// shares is dependant on how many other shares there are already. Each\r\n// artwork starts with 1 share available for purchase and upon each sale,\r\n// the number of shares for purchase will increase by one (1 -> 2 -> 3...),\r\n// each artwork also has an owner and they will always get the dividends from \r\n// the number of shares up for purchase, for example;\r\n/*\r\n    If the artwork has had shares purchased 4 times, the next purchase will\r\n    be for 5 shares of the artwork. Upon the purchasing of these shares, the\r\n    owner will receive the dividends equivelent to 5 shares worth of the sale\r\n    value. It's also important to note that the artwork owner cannot purchase\r\n    shares of their own art, instead they just inherit the shares for purchase\r\n    and pass it onto the next buyer at each sale.\r\n*/ \r\n// The price of the shares also follows a special formula in order to maintain\r\n// stability over time, it uses the base price of an artwork (set by the dev \r\n// upon the creation of the artwork) and the total number of shares purchased\r\n// of the artwork. From here you simply treat the number of shares as a percentage\r\n// and add that much on top of your base price, for example;\r\n/*\r\n    If the artwork has a base price of 0.01 ETH and there have been 250 shares \r\n    purchased so far, it would mean that the base price will gain 250% of it's\r\n    value which comes to 0.035 ETH (100% + 250% of the base price).\r\n*/\r\n// The special thing about this is because the shares are intrinsicly linked with\r\n// the price, the dividends from your shares will trend to a constant value instead\r\n// of continually decreasing over time. Because our sequence of shares is a triangular\r\n// number (1 + 2 + 3...) the steady state of any purchased shares will equal the number\r\n// of shares owned (as a percentage) * the artworks base price, for example;\r\n/*\r\n    If the artwork has a base price of 0.01 ETH and you own 5 shares, in the long run\r\n    you should expect to see 5% * 0.01 ETH = 0.0005 ETH each time the artwork has any\r\n    shares purchased. In contrast, if you own 250 shares of the artwork, you should \r\n    expect to see 250% * 0.01 ETH = 0.025 ETH each time the artwork has shares bought.\r\n  \r\n    It's good to point out that if you were the first buyer and owned 1 share, the next\r\n    buyer is going to be purchasing 2 shares which means you have 1 out of the 3 shares\r\n    total and hence you will receive 33% of that sale, at the next step there will be\r\n    6 shares total and your 1 share is now worth 16% of the sale price, as mentioned\r\n    above though, your earnings upon the purchasing of new shares from your original\r\n    1 share will trend towards 1% of the base price over a long period of time.\r\n*/\r\n//\r\n// If you're an artist and are interested in listing some of your works on the site\r\n// and in this contract, please visit the website (https://limeeyes.com/) and contact\r\n// the main developer via the links on the site!\r\n//\r\n\r\ncontract LimeEyes {\r\n\r\n\t//////////////////////////////////////////////////////////////////////\r\n\t//  Variables, Storage and Events\r\n\r\n\r\n\taddress private _dev;\r\n\r\n\tstruct Artwork {\r\n\t\tstring _title;\r\n\t\taddress _owner;\r\n\t\tbool _visible;\r\n\t\tuint256 _basePrice;\r\n\t\tuint256 _purchases;\r\n\t\taddress[] _shareholders;\r\n\t\tmapping (address => bool) _hasShares;\r\n\t\tmapping (address => uint256) _shares;\r\n\t}\r\n\tArtwork[] private _artworks;\r\n\r\n\tevent ArtworkCreated(\r\n\t\tuint256 artworkId,\r\n\t\tstring title,\r\n\t\taddress owner,\r\n\t\tuint256 basePrice);\r\n\tevent ArtworkSharesPurchased(\r\n\t\tuint256 artworkId,\r\n\t\tstring title,\r\n\t\taddress buyer,\r\n\t\tuint256 sharesBought);\r\n\r\n\r\n\t//////////////////////////////////////////////////////////////////////\r\n\t//  Constructor and Admin Functions\r\n\r\n\r\n\tfunction LimeEyes() public {\r\n\t\t_dev = msg.sender;\r\n\t}\r\n\r\n\tmodifier onlyDev() {\r\n\t\trequire(msg.sender == _dev);\r\n\t\t_;\r\n\t}\r\n\r\n\t// This function will create a new artwork within the contract,\r\n\t// the title is changeable later by the dev but the owner and\r\n\t// basePrice cannot be changed once it's been created.\r\n\t// The owner of the artwork will start off with 1 share and any\r\n\t// other addresses may now purchase shares for it.\r\n\tfunction createArtwork(string title, address owner, uint256 basePrice) public onlyDev {\r\n\r\n\t\trequire(basePrice != 0);\r\n\t\t_artworks.push(Artwork({\r\n\t\t\t_title: title,\r\n\t\t\t_owner: owner,\r\n\t\t\t_visible: true,\r\n\t\t\t_basePrice: basePrice,\r\n\t\t\t_purchases: 0,\r\n\t\t\t_shareholders: new address[](0)\r\n\t\t}));\r\n\t\tuint256 artworkId = _artworks.length - 1;\r\n\t\tArtwork storage newArtwork = _artworks[artworkId];\r\n\t\tnewArtwork._hasShares[owner] = true;\r\n\t\tnewArtwork._shareholders.push(owner);\r\n\t\tnewArtwork._shares[owner] = 1;\r\n\r\n\t\tArtworkCreated(artworkId, title, owner, basePrice);\r\n\r\n\t}\r\n\r\n\t// Simple renaming function for the artworks, it is good to\r\n\t// keep in mind that when the website syncs with the blockchain,\r\n\t// any titles over 32 characters will be clipped.\r\n\tfunction renameArtwork(uint256 artworkId, string newTitle) public onlyDev {\r\n\t\t\r\n\t\trequire(_exists(artworkId));\r\n\t\tArtwork storage artwork = _artworks[artworkId];\r\n\t\tartwork._title = newTitle;\r\n\r\n\t}\r\n\r\n\t// This function is only for the website and whether or not\r\n\t// it displays a certain artwork, any user may still buy shares\r\n\t// for an invisible artwork although it's not really art unless\r\n\t// you can view it.\r\n\t// This is exclusively reserved for copyright cases should any\r\n\t// artworks be flagged as such.\r\n\tfunction toggleArtworkVisibility(uint256 artworkId) public onlyDev {\r\n\t\t\r\n\t\trequire(_exists(artworkId));\r\n\t\tArtwork storage artwork = _artworks[artworkId];\r\n\t\tartwork._visible = !artwork._visible;\r\n\r\n\t}\r\n\r\n\t// The two withdrawal functions below are here so that the dev\r\n\t// can access the dividends of the contract if it owns any\r\n\t// artworks. As all ETH is transferred straight away upon the\r\n\t// purchasing of shares, the only ETH left in the contract will\r\n\t// be from dividends or the rounding errors (although the error\r\n\t// will only be a few wei each transaction) due to the nature\r\n\t// of dividing and working with integers.\r\n\tfunction withdrawAmount(uint256 amount, address toAddress) public onlyDev {\r\n\r\n\t\trequire(amount != 0);\r\n\t\trequire(amount <= this.balance);\r\n\t\ttoAddress.transfer(amount);\r\n\r\n\t}\r\n\r\n\t// Used to empty the contracts balance to an address.\r\n\tfunction withdrawAll(address toAddress) public onlyDev {\r\n\t\ttoAddress.transfer(this.balance);\r\n\t}\r\n\r\n\r\n\t//////////////////////////////////////////////////////////////////////\r\n\t//  Main Artwork Share Purchasing Function\r\n\r\n\r\n\t// This is the main point of interaction in this contract,\r\n\t// it will allow a user to purchase shares in an artwork\r\n\t// and hence with their investment, they pay dividends to\r\n\t// all the current shareholders and then the user themselves\r\n\t// will become a shareholder and earn dividends on any future\r\n\t// purchases of shares.\r\n\t// See the getArtwork() function for more information on pricing\r\n\t// and how shares work.\r\n\tfunction purchaseSharesOfArtwork(uint256 artworkId) public payable {\r\n\r\n\t\t// This makes sure only people, and not contracts, can buy shares.\r\n\t\trequire(msg.sender == tx.origin);\r\n\r\n\t\trequire(_exists(artworkId));\r\n\t\tArtwork storage artwork = _artworks[artworkId];\r\n\r\n\t\t// The artwork owner is not allowed to purchase shares of their\r\n\t\t// own art, instead they will earn dividends automatically.\r\n\t\trequire(msg.sender != artwork._owner);\r\n\r\n\t\tuint256 totalShares;\r\n\t\tuint256[3] memory prices;\r\n\t\t( , , , prices, totalShares, , ) = getArtwork(artworkId);\r\n\t\tuint256 currentPrice = prices[1];\r\n\r\n\t\t// Make sure the buyer sent enough ETH\r\n\t\trequire(msg.value >= currentPrice);\r\n\r\n\t\t// Send back the excess if there's any.\r\n\t\tuint256 purchaseExcess = msg.value - currentPrice;\r\n\t\tif (purchaseExcess > 0)\r\n\t\t\tmsg.sender.transfer(purchaseExcess);\r\n\r\n\t\t// Now pay all the shareholders accordingly.\r\n\t\t// (this will potentially cost a lot of gas)\r\n\t\tfor (uint256 i = 0; i < artwork._shareholders.length; i++) {\r\n\t\t\taddress shareholder = artwork._shareholders[i];\r\n\t\t\tif (shareholder != address(this)) { // transfer ETH if the shareholder isn't this contract\r\n\t\t\t\tshareholder.transfer((currentPrice * artwork._shares[shareholder]) / totalShares);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Add the buyer to the registry.\r\n\t\tif (!artwork._hasShares[msg.sender]) {\r\n\t\t\tartwork._hasShares[msg.sender] = true;\r\n\t\t\tartwork._shareholders.push(msg.sender);\r\n\t\t}\r\n\r\n\t\tartwork._purchases++; // track our purchase\r\n\t\tartwork._shares[msg.sender] += artwork._purchases; // add the shares to the sender\r\n\t\tartwork._shares[artwork._owner] = artwork._purchases + 1; // set the owners next shares\r\n\r\n\t\tArtworkSharesPurchased(artworkId, artwork._title, msg.sender, artwork._purchases);\r\n\t\t\r\n\t}\r\n\r\n\r\n\t//////////////////////////////////////////////////////////////////////\r\n\t//  Getters\r\n\r\n\r\n\tfunction _exists(uint256 artworkId) private view returns (bool) {\r\n\t\treturn artworkId < _artworks.length;\r\n\t}\r\n\r\n\tfunction getArtwork(uint256 artworkId) public view returns (string artworkTitle, address ownerAddress, bool isVisible, uint256[3] artworkPrices, uint256 artworkShares, uint256 artworkPurchases, uint256 artworkShareholders) {\r\n\t\t\r\n\t\trequire(_exists(artworkId));\r\n\r\n\t\tArtwork memory artwork = _artworks[artworkId];\r\n\r\n\t\t// As at each step we are simply increasing the number of shares given by 1, the resulting\r\n\t\t// total from adding up consecutive numbers from 1 is the same as the triangular number\r\n\t\t// series (1 + 2 + 3 + ...). the formula for finding the nth triangular number is as follows;\r\n\t\t// Tn = (n * (n + 1)) / 2\r\n\t\t// For example the 10th triangular number is (10 * 11) / 2 = 55\r\n\t\t// In our case however, the owner of the artwork always inherits the shares being bought\r\n\t\t// before transferring them to the buyer but the owner cannot buy shares of their own artwork.\r\n\t\t// This means that when calculating how many shares, we need to add 1 to the total purchases\r\n\t\t// in order to accommodate for the owner. from here we just need to adjust the triangular\r\n\t\t// number formula slightly to get;\r\n\t\t// Shares After n Purchases = ((n + 1) * (n + 2)) / 2\r\n\t\t// Let's say the art is being purchased for a second time which means the purchaser is\r\n\t\t// buying 3 shares and therefore the owner will get 3 shares worth of dividends from the\r\n\t\t// overall purchase value. As it's the 2nd purchase, there are (3 * 4) / 2 = 6 shares total\r\n\t\t// according to our formula which is as expected.\r\n\t\tuint256 totalShares = ((artwork._purchases + 1) * (artwork._purchases + 2)) / 2;\r\n\r\n\t\t// Set up our prices array;\r\n\t\t// 0: base price\r\n\t\t// 1: current price\r\n\t\t// 2: next price\r\n\t\tuint256[3] memory prices;\r\n\t\tprices[0] = artwork._basePrice;\r\n\t\t// The current price is also directly related the total number of shares, it simply treats\r\n\t\t// the total number of shares as a percentage and adds that much on top of the base price.\r\n\t\t// For example if the base price was 0.01 ETH and there were 250 shares total it would mean\r\n\t\t// that the price would gain 250% of it's value = 0.035 ETH (100% + 250%);\r\n\t\t// Current Price = (Base Price * (100 + Total Shares)) / 100\r\n\t\tprices[1] = (prices[0] * (100 + totalShares)) / 100;\r\n\t\t// The next price would just be the same as the current price but we have a few extra shares.\r\n\t\t// If there are 0 purchases then you are buying 1 share (purchases + 1) so the next buyer would\r\n\t\t// be purchasing 2 shares (purchases + 2) so therefore;\r\n\t\tprices[2] = (prices[0] * (100 + totalShares + (artwork._purchases + 2))) / 100;\r\n\r\n\t\treturn (\r\n\t\t\t\tartwork._title,\r\n\t\t\t\tartwork._owner,\r\n\t\t\t\tartwork._visible,\r\n\t\t\t\tprices,\r\n\t\t\t\ttotalShares,\r\n\t\t\t\tartwork._purchases,\r\n\t\t\t\tartwork._shareholders.length\r\n\t\t\t);\r\n\r\n\t}\r\n\r\n\tfunction getAllShareholdersOfArtwork(uint256 artworkId) public view returns (address[] shareholders, uint256[] shares) {\r\n\r\n\t\trequire(_exists(artworkId));\r\n\r\n\t\tArtwork storage artwork = _artworks[artworkId];\r\n\r\n\t\tuint256[] memory shareholderShares = new uint256[](artwork._shareholders.length);\r\n\t\tfor (uint256 i = 0; i < artwork._shareholders.length; i++) {\r\n\t\t\taddress shareholder = artwork._shareholders[i];\r\n\t\t\tshareholderShares[i] = artwork._shares[shareholder];\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t\tartwork._shareholders,\r\n\t\t\t\tshareholderShares\r\n\t\t\t);\r\n\r\n\t}\r\n\r\n\tfunction getAllArtworks() public view returns (bytes32[] titles, address[] owners, bool[] isVisible, uint256[3][] artworkPrices, uint256[] artworkShares, uint256[] artworkPurchases, uint256[] artworkShareholders) {\r\n\r\n\t\tbytes32[] memory allTitles = new bytes32[](_artworks.length);\r\n\t\taddress[] memory allOwners = new address[](_artworks.length);\r\n\t\tbool[] memory allIsVisible = new bool[](_artworks.length);\r\n\t\tuint256[3][] memory allPrices = new uint256[3][](_artworks.length);\r\n\t\tuint256[] memory allShares = new uint256[](_artworks.length);\r\n\t\tuint256[] memory allPurchases = new uint256[](_artworks.length);\r\n\t\tuint256[] memory allShareholders = new uint256[](_artworks.length);\r\n\r\n\t\tfor (uint256 i = 0; i < _artworks.length; i++) {\r\n\t\t\tstring memory tmpTitle;\r\n\t\t\t(tmpTitle, allOwners[i], allIsVisible[i], allPrices[i], allShares[i], allPurchases[i], allShareholders[i]) = getArtwork(i);\r\n\t\t\tallTitles[i] = stringToBytes32(tmpTitle);\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t\tallTitles,\r\n\t\t\t\tallOwners,\r\n\t\t\t\tallIsVisible,\r\n\t\t\t\tallPrices,\r\n\t\t\t\tallShares,\r\n\t\t\t\tallPurchases,\r\n\t\t\t\tallShareholders\r\n\t\t\t);\r\n\r\n\t}\r\n\r\n\tfunction stringToBytes32(string memory source) internal pure returns (bytes32 result) {\r\n\t\tbytes memory tmpEmptyStringTest = bytes(source);\r\n\t\tif (tmpEmptyStringTest.length == 0) {\r\n\t\t\treturn 0x0;\r\n\t\t}\r\n\r\n\t\tassembly {\r\n\t\t\tresult := mload(add(source, 32))\r\n\t\t}\r\n\t}\r\n\r\n\t\r\n\t//////////////////////////////////////////////////////////////////////\r\n\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"artworkId\",\"type\":\"uint256\"}],\"name\":\"purchaseSharesOfArtwork\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"artworkId\",\"type\":\"uint256\"}],\"name\":\"getArtwork\",\"outputs\":[{\"name\":\"artworkTitle\",\"type\":\"string\"},{\"name\":\"ownerAddress\",\"type\":\"address\"},{\"name\":\"isVisible\",\"type\":\"bool\"},{\"name\":\"artworkPrices\",\"type\":\"uint256[3]\"},{\"name\":\"artworkShares\",\"type\":\"uint256\"},{\"name\":\"artworkPurchases\",\"type\":\"uint256\"},{\"name\":\"artworkShareholders\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"artworkId\",\"type\":\"uint256\"}],\"name\":\"toggleArtworkVisibility\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"artworkId\",\"type\":\"uint256\"}],\"name\":\"getAllShareholdersOfArtwork\",\"outputs\":[{\"name\":\"shareholders\",\"type\":\"address[]\"},{\"name\":\"shares\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getAllArtworks\",\"outputs\":[{\"name\":\"titles\",\"type\":\"bytes32[]\"},{\"name\":\"owners\",\"type\":\"address[]\"},{\"name\":\"isVisible\",\"type\":\"bool[]\"},{\"name\":\"artworkPrices\",\"type\":\"uint256[3][]\"},{\"name\":\"artworkShares\",\"type\":\"uint256[]\"},{\"name\":\"artworkPurchases\",\"type\":\"uint256[]\"},{\"name\":\"artworkShareholders\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"title\",\"type\":\"string\"},{\"name\":\"owner\",\"type\":\"address\"},{\"name\":\"basePrice\",\"type\":\"uint256\"}],\"name\":\"createArtwork\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"artworkId\",\"type\":\"uint256\"},{\"name\":\"newTitle\",\"type\":\"string\"}],\"name\":\"renameArtwork\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"toAddress\",\"type\":\"address\"}],\"name\":\"withdrawAll\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"toAddress\",\"type\":\"address\"}],\"name\":\"withdrawAmount\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"artworkId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"title\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"basePrice\",\"type\":\"uint256\"}],\"name\":\"ArtworkCreated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"artworkId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"title\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"buyer\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"sharesBought\",\"type\":\"uint256\"}],\"name\":\"ArtworkSharesPurchased\",\"type\":\"event\"}]","ContractName":"LimeEyes","CompilerVersion":"v0.4.18+commit.9cf6e910","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://fd5b66896d12862c51da945003bbe5b30c3d4adf3e9a28c57f643e5c10befae4"}]}