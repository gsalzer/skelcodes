{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.21;\r\n\r\n/**\r\n* Issued by\r\n*       _                              __ _     _\r\n*      | |                            / _| |   (_)\r\n*    __| | __ _ _ __  _ __  ___  ___ | |_| |_   _  ___\r\n*   / _` |/ _` | '_ \\| '_ \\/ __|/ _ \\|  _| __| | |/ _ \\\r\n*  | (_| | (_| | |_) | |_) \\__ \\ (_) | | | |_ _| | (_) |\r\n*   \\__,_|\\__,_| .__/| .__/|___/\\___/|_|  \\__(_)_|\\___/\r\n*              | |   | |\r\n*              |_|   |_|\r\n*\r\n* 以太武侠(ethwuxia)\r\n* wangangang1991 @ gmail.com\r\n*/\r\n\r\nlibrary SafeMath {\r\n\r\n  /**\r\n  * @dev Multiplies two numbers, throws on overflow.\r\n  */\r\n  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    if (a == 0) {\r\n      return 0;\r\n    }\r\n    uint256 c = a * b;\r\n    assert(c / a == b);\r\n    return c;\r\n  }\r\n\r\n  /**\r\n  * @dev Integer division of two numbers, truncating the quotient.\r\n  */\r\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    // assert(b > 0); // Solidity automatically throws when dividing by 0\r\n    uint256 c = a / b;\r\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\r\n    return c;\r\n  }\r\n\r\n  /**\r\n  * @dev Substracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).\r\n  */\r\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    assert(b <= a);\r\n    return a - b;\r\n  }\r\n\r\n  /**\r\n  * @dev Adds two numbers, throws on overflow.\r\n  */\r\n  function add(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    uint256 c = a + b;\r\n    assert(c >= a);\r\n    return c;\r\n  }\r\n\r\n  function max(uint a, uint b) internal pure returns (uint) {\r\n    if (a > b) return a;\r\n    else return b;\r\n  }\r\n\r\n  function min(uint a, uint b) internal pure returns (uint) {\r\n    if (a < b) return a;\r\n    else return b;\r\n  }\r\n}\r\n\r\n\r\n/// @title Interface for contracts conforming to ERC-721: Non-Fungible Tokens\r\n/// @author Dieter Shirley <dete@axiomzen.co> (https://github.com/dete)\r\ncontract ERC721 {\r\n    // Required methods\r\n    function totalSupply() public view returns (uint256 total);\r\n    function balanceOf(address _owner) public view returns (uint256 balance);\r\n    function ownerOf(uint256 _tokenId) public view returns (address owner);\r\n    function approve(address _to, uint256 _tokenId) public;\r\n    function transfer(address _to, uint256 _tokenId) public;\r\n    function transferFrom(address _from, address _to, uint256 _tokenId) public;\r\n\r\n    // Events\r\n    event Transfer(address from, address to, uint256 tokenId);\r\n    event Approval(address owner, address approved, uint256 tokenId);\r\n\r\n    // Optional\r\n    // function name() public view returns (string name);\r\n    // function symbol() public view returns (string symbol);\r\n    // function tokensOfOwner(address _owner) external view returns (uint256[] tokenIds);\r\n    // function tokenMetadata(uint256 _tokenId, string _preferredTransport) public view returns (string infoUrl);\r\n\r\n    // ERC-165 Compatibility (https://github.com/ethereum/EIPs/issues/165)\r\n    // function supportsInterface(bytes4 _interfaceID) external view returns (bool);\r\n}\r\n\r\ncontract EthWuxia is ERC721{\r\n  using SafeMath for uint256;\r\n\r\n  event Bought (uint256 indexed _itemId, address indexed _owner, uint256 _price);\r\n  event Sold (uint256 indexed _itemId, address indexed _owner, uint256 _price);\r\n  event Transfer(address indexed _from, address indexed _to, uint256 _tokenId);\r\n  event Approval(address indexed _owner, address indexed _approved, uint256 _tokenId);\r\n\r\n  uint public produceUnitSeconds = 86400;  // 每1天进行一次高级卡投放\r\n  uint public freeLotterySeconds = 3600 * 6;  // 每1天有一次免费抽卡的机会\r\n  uint public unitRareGrowth = 3;  // 每单位时间 稀有卡投放数量\r\n  uint public unitEpicGrowth = 0;  // 史诗卡投放数量\r\n  uint public unitMythGrowth = 0;  // 传说卡投放数量\r\n  uint public initialMartialTimes=1;  // 新的门派会有一定的概率加成 => 2被\r\n  uint public stepPrice = 1 finney;\r\n  uint public lotteryPrice = 10 finney;  // lotteryPrice\r\n  uint public dragonGirlLotteryPrice = 10 finney;\r\n  uint public dragonGirlLotteryNumber = 0;\r\n  address[] public listedDragonGirlLotteryUser = [address(0), address(0), address(0), address(0), address(0)];\r\n  address public wuxiaMaster = address(0);\r\n  uint public wuxiaMasterPrice = 100 finney;  // 每次加价100finny;\r\n  mapping (uint256 => address) public approvedOfItem;\r\n  uint public littleMonster = 1 ether; // 游戏收入每到1ether就生成一个以太怪\r\n\r\n\r\n  uint public totalEarning = 0;  // 总收入 => 总收入的10%用于生成EthMonster\r\n  uint public totalTrading = 0;  // 总流水  \r\n  uint public lotteryTotalEarning = 0;  // 抽卡收入 => 掌门人5%\r\n  uint public marketTotalEarning = 0;  // 市场交易收入 => 武林盟主5%\r\n  uint public smartSpeedEarning = 0;\r\n  uint public luckyStoneEarning = 0;\r\n  uint public hunterLicenceEarning = 0;\r\n  uint public travelTotalEarning = 0;\r\n  uint public masterTotalEarning = 0;\r\n  // 开服活动 抽奖10次送狩猎证书\r\n  bool public lotteryGiveHunt = false;\r\n  uint public lotteryGiveHuntMinimalNumber = 10;\r\n  uint public randNonce = 0;\r\n\r\n\r\n  mapping (address => uint) public mapUserLastFreeLotteryTimestamp;  // 用户上次抽奖的时间\r\n  mapping (address => uint) public mapUserPower;  // 实时维护用户的战斗力\r\n\r\n  // ability does not support trade\r\n  mapping (address => bool) public mapUserHasSmartSpeed;  // 用户是否会凌波微步\r\n  uint public currentSmartSpeedNumber = 0;\r\n  // smartSpeedPrice = Min(0.1ether, 0.01ether*currentSmartSpeedNumber)\r\n\r\n  mapping (address => bool) public mapUserHasLuckyStone;  // 用户是否有幸运宝石\r\n  uint public currentLuckyStoneNumber = 0;\r\n  // luckyStonePrice = Min(0.1ether, 0.01*ether*currentLuckyStoneNumber)\r\n\r\n  mapping (address => bool) public mapUserHasHunterLicence;\r\n  uint public currentHunterNumber = 0;\r\n  // hunterPrice = Min(0.1ether, 0.01ether*currentHunterNumber)\r\n\r\n  uint public totalUserNumber = 0;\r\n  uint public totalLotteryNumber = 0;\r\n  uint public totalBuyCardNumber = 0;\r\n  uint public totalSellCardNumber = 0;\r\n  uint public totalDragonLotteryNumber = 0;\r\n  mapping (uint => uint) public mapMartialUserCount;  // martial total user count\r\n  mapping (uint => uint) public mapMartialLotteryCount;  // martial total lottery count\r\n  mapping (address => uint) public mapUserLotteryNumber;\r\n\r\n  // 合约支持动态增加新据点\r\n  struct Martial {\r\n      uint x;  // 门派坐标\r\n      uint y;  // 门派坐标\r\n      address owner;  // 门派盟主\r\n      uint lastProduceTime;  // 上一次的极品卡出产时间\r\n      uint martialId;\r\n      uint rareNumber;  // 稀有的\r\n      uint epicNumber;  // 史诗的\r\n      uint mythNumber;  // 传说的\r\n      uint enterPrice;  // 入场费 => 剑冢入场费为1ether\r\n      uint[] cardTypeList;  // 该门派出产的卡片\r\n  }\r\n\r\n  // 充值额度的20%会被用作奖品\r\n  // 每1个ether 有一个0.1ether的以太怪 以太怪的血量为2*最高攻击力玩家的战斗力\r\n  // 每10个ether 有一个1ether的以太怪 以太怪血量为5*最高攻击力玩家的战斗力\r\n  // 以太怪奖励的10%将发给门派创始人\r\n  struct EtherMonster {\r\n      uint monsterId;\r\n      uint martialId;  // 该怪兽出现在哪个据点\r\n      uint balance;  // 奖金 => 奖励点的5%\r\n      uint blood;  // 血量 对于0.2ether的以太怪是3*最高攻击力玩家的战斗力 对于1ether的以太怪是10*最高攻击力玩家的战斗力\r\n      uint produceTime;  // 怪兽出现的时间 怪物需要在指定的时间内被击杀 掌门人将获得20%的收益\r\n      uint currentBlood;  // 当前血量\r\n      bool defeated;  // 是否已经被消灭\r\n      address winner;  // 获奖者\r\n  }\r\n\r\n  mapping (address => uint) public mapUserLastAttackMonsterTimestamp;\r\n  uint public userAttackMonsterCDSeconds = 600;  // 用户每10分钟可以攻击一次EtherMonster怪\r\n  uint public maxUserPower = 0;  // 用于etherMonster血量估计\r\n  address public maxPowerUserAddress = address(0);\r\n  uint etherMonsterHuntSeconds = 3600;  // etherMonster的狩猎时间\r\n  uint littleEtherMonsterUnit = 0.5 ether;  // 3倍最高战力\r\n  uint bigEtherMonsterUnit = 5 ether;  // 10倍最高战力\r\n\r\n  struct CardType {\r\n      uint typeId;\r\n      uint martialId;  // 卡片从属于那个门派\r\n      uint initPower;  // 初始战斗力\r\n      uint growthFactor;  // 成长系数\r\n      uint category;  // 卡片分类 => 1表示武侠 2表示武器 3表示武功 4表示阵法\r\n  }\r\n\r\n  // 合成新卡的方式是: 两张旧卡片销毁 生成一张新卡片\r\n  struct Card {\r\n      uint cardId;\r\n      uint typeId;\r\n      uint level;  // 卡片等级 => 0表示普通 1表示稀有 2表示史诗 3表示传说\r\n      bool onSell;\r\n      uint sellPrice;\r\n      address owner;\r\n  }\r\n\r\n\r\n  address private owner;\r\n  mapping (address => bool) private admins;\r\n\r\n  IItemRegistry private itemRegistry;\r\n  uint public travelUnitFee = 1 finney; // 0.001ether for each step\r\n\r\n  uint256[] private listedItems;\r\n  Martial[] public listedMartials;  // 门派列表\r\n  CardType[] public listedCardType;  // 卡牌列表\r\n  Card[] public listedCard;\r\n  EtherMonster[] public listedEtherMonster;\r\n\r\n  uint smallMonsterPowerFactor = 3;\r\n  uint bigMonsterPowerFactor = 5;\r\n\r\n  mapping (uint256 => address) public mapOwnerOfCard;\r\n  mapping (address => uint) private mapUserCurrentMartialId;  // 用户当前的门派\r\n  mapping (address => bool) public mapUesrAlreadyMartialOwner;\r\n  mapping (address => bytes32) public mapUserNickname;\r\n\r\n  bool public hasInitMartial = false;\r\n  bool public hasInitCard1 = false;\r\n  bool public hasInitCard2 = false;\r\n\r\n  function EthWuxia () public {\r\n      owner = msg.sender;\r\n      admins[owner] = true;\r\n      lotteryGiveHunt = true;\r\n  }\r\n\r\n  /* Modifiers */\r\n  modifier onlyOwner() {\r\n    require(owner == msg.sender);\r\n    _;\r\n  }\r\n\r\n  modifier onlyAdmins() {\r\n    require(admins[msg.sender]);\r\n    _;\r\n  }\r\n\r\n  /* Owner */\r\n  function setOwner (address _owner) onlyOwner() public {\r\n    owner = _owner;\r\n  }\r\n\r\n  function getOwner() public view returns(address){\r\n      return owner;\r\n  }\r\n  function setItemRegistry (address _itemRegistry) onlyOwner() public {\r\n    itemRegistry = IItemRegistry(_itemRegistry);\r\n  }\r\n\r\n  function addAdmin (address _admin) onlyOwner() public {\r\n    admins[_admin] = true;\r\n  }\r\n\r\n  function removeAdmin (address _admin) onlyOwner() public {\r\n    delete admins[_admin];\r\n  }\r\n  \r\n  function disableLotteryGiveHunt() onlyOwner() public {\r\n      lotteryGiveHunt = false;\r\n  }\r\n  \r\n  function enableLotteryGiveHunt() onlyOwner() public {\r\n      lotteryGiveHunt = true;\r\n  }\r\n\r\n  // 功能列表\r\n  // 1. 游戏更新 => 创建门派\r\n  // 1.1 createNewMartial\r\n  // 1.2 createNewCardType\r\n  function createNewMartial (uint x, uint y, uint enterPrice) onlyOwner() public {\r\n    require(x>=1);\r\n    require(y>=1);\r\n    Martial memory martial = Martial(x, y, address(0), now, listedMartials.length, unitRareGrowth * initialMartialTimes, unitEpicGrowth * initialMartialTimes, unitMythGrowth * initialMartialTimes, enterPrice, new uint[](0));\r\n    listedMartials.push(martial);\r\n  }\r\n\r\n  // 1.2 创建卡片类型\r\n  function createNewCardType (uint martialId, uint initPower, uint growthFactor, uint category) onlyOwner() public {\r\n    require(initPower>=1);\r\n    require(growthFactor>=2);\r\n    require(category>=1);\r\n    require(category<=4);  // 武侠, 装备, 武功, 阵法\r\n    require(martialId < listedMartials.length);\r\n    listedMartials[martialId].cardTypeList.push(listedCardType.length);\r\n    CardType memory cardType = CardType(listedCardType.length, martialId, initPower, growthFactor, category);\r\n    listedCardType.push(cardType);\r\n  }\r\n\r\n  // 2. 用户操作\r\n  // 2.1 凌波微步\r\n  // 2.2 幸运宝石\r\n  // 2.3 猎手\r\n  // 2.4 旅行location\r\n  // 2.5 抽奖\r\n  // 2.6 卡片合成\r\n  // 2.7 战斗力维护\r\n  // 2.8 掌门人\r\n  // 2.9 交易市场\r\n  // 2.10 武林盟主 => 10percent of market exchage\r\n  // 2.11 龙女彩票\r\n  // 2.12 etherMonster\r\n\r\n  // 2.1 凌波微步\r\n  function userHasSmartSpeed(address userAddress) public view returns(bool) {\r\n    return mapUserHasSmartSpeed[userAddress];\r\n  }\r\n\r\n  function getCurrentSmartSpeedPrice() public view returns(uint) {\r\n    // Min(0.1ether, 0.01ether+0.01ether*current)\r\n    return SafeMath.mul(SafeMath.min(10, currentSmartSpeedNumber), 10 finney);\r\n  }\r\n\r\n  function buySmartSpeed () public payable {\r\n    uint currentSmartSpeedPrice = SafeMath.mul(SafeMath.min(10, currentSmartSpeedNumber), 10 finney);\r\n    require(msg.value >= currentSmartSpeedPrice);\r\n    require(!mapUserHasSmartSpeed[msg.sender]);\r\n    uint excess = msg.value.sub(currentSmartSpeedPrice);\r\n    currentSmartSpeedNumber += 1;\r\n\r\n    if (excess > 0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    mapUserHasSmartSpeed[msg.sender] = true;\r\n\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(currentSmartSpeedPrice));\r\n    totalEarning = totalEarning.add(currentSmartSpeedPrice);\r\n    totalTrading = totalTrading.add(currentSmartSpeedPrice);\r\n    smartSpeedEarning = smartSpeedEarning.add(currentSmartSpeedPrice);\r\n  }\r\n\r\n  // 2.2 幸运宝石\r\n  function userHasLuckyStone(address userAddress) public view returns(bool) {\r\n    return mapUserHasLuckyStone[userAddress];\r\n  }\r\n\r\n  function getCurrentLuckyStonePrice() public view returns(uint) {\r\n    // Min(0.1ether, 0.01ether+0.01ether*current)\r\n    return SafeMath.mul(SafeMath.min(10, currentLuckyStoneNumber), 10 finney);\r\n  }\r\n\r\n  function buyLuckyStone() public payable {\r\n    uint currentLuckyStonePrice = SafeMath.mul(SafeMath.min(10, currentLuckyStoneNumber), 10 finney);\r\n    require(msg.value >= currentLuckyStonePrice);\r\n    require(!mapUserHasLuckyStone[msg.sender]);\r\n    uint excess = msg.value.sub(currentLuckyStonePrice);\r\n    currentLuckyStoneNumber += 1;\r\n    if (excess > 0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    mapUserHasLuckyStone[msg.sender] = true;\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(currentLuckyStonePrice));\r\n    totalEarning = totalEarning.add(currentLuckyStonePrice);\r\n    totalTrading = totalTrading.add(currentLuckyStonePrice);\r\n    luckyStoneEarning = luckyStoneEarning.add(currentLuckyStonePrice);\r\n  }\r\n\r\n  function createEtherMonster(uint martialId, uint balance, uint blood) public onlyOwner {\r\n      require(martialId<listedMartials.length);\r\n      require(balance>0);\r\n      require(blood>0);\r\n      require(balance<address(this).balance);\r\n      EtherMonster memory monster = EtherMonster(listedEtherMonster.length, martialId, balance, blood, now, blood, false, address(0));\r\n      listedEtherMonster.push(monster);\r\n  }\r\n\r\n\r\n  // 2.3 狩猎证书\r\n  function userHasHunterLicence(address userAddress) public view returns(bool) {\r\n      return mapUserHasHunterLicence[userAddress];\r\n  }\r\n\r\n  function getCurrentHunterLicencePrice() public view returns(uint) {\r\n    return SafeMath.mul(SafeMath.min(10, currentHunterNumber), 10 finney);\r\n  }\r\n\r\n  function buyHunterLicence() public payable {\r\n    uint currentHunterLicencePrice = SafeMath.mul(SafeMath.min(10, currentHunterNumber), 10 finney);\r\n    require(msg.value >= currentHunterNumber);\r\n    require(!mapUserHasHunterLicence[msg.sender]);\r\n    uint excess = msg.value.sub(currentHunterLicencePrice);\r\n    currentHunterNumber += 1;\r\n    if (excess > 0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    mapUserHasHunterLicence[msg.sender] = true;\r\n\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(currentHunterLicencePrice));\r\n    totalEarning = totalEarning.add(currentHunterLicencePrice);\r\n    totalTrading = totalTrading.add(currentHunterLicencePrice);\r\n    hunterLicenceEarning = hunterLicenceEarning.add(currentHunterLicencePrice);\r\n  }\r\n\r\n  // 2.4 travel\r\n  // 用户当前的Martial\r\n  function getUserCurrentMartialId() public view returns(uint) {\r\n      return mapUserCurrentMartialId[msg.sender];\r\n  }\r\n\r\n  // workaround for struct\r\n  // https://github.com/ethereum/remix-ide/issues/920#issuecomment-348069589\r\n  function getMartialInfo(uint martialId) public view returns(uint, uint, address, uint, uint, uint, uint, uint, uint, uint[]) {\r\n    require(martialId < listedMartials.length);\r\n    Martial memory martial = listedMartials[martialId];\r\n    return (martial.x, martial.y, martial.owner, martial.lastProduceTime, martial.martialId, martial.rareNumber, martial.epicNumber, martial.mythNumber, martial.enterPrice, martial.cardTypeList);\r\n  }\r\n  \r\n  function getMartialListInfo() public view returns(uint[]) {\r\n      // rareNumber, epicNumber, mythNumber, ownerPower\r\n      uint[] memory result = new uint[](listedMartials.length.mul(5)+1);\r\n      uint index = 1;\r\n      result[0] = listedMartials.length;\r\n      for (uint i=0; i<listedMartials.length;i++) {\r\n          Martial memory martial = listedMartials[i];\r\n          result[index] = martial.rareNumber;\r\n          result[index+1] = martial.epicNumber;\r\n          result[index+2] = martial.mythNumber;\r\n          result[index+3] = mapUserPower[martial.owner];\r\n          result[index+4] = mapMartialUserCount[i];\r\n          index += 5;\r\n      }\r\n      return result;\r\n  }\r\n  \r\n  function getMartialOwner() public view returns(address[]) {\r\n    address[] memory result = new address[](listedMartials.length);\r\n    for (uint i=0;i<listedMartials.length;i++) {\r\n        result[i] = listedMartials[i].owner;\r\n    }\r\n    return result;\r\n  }\r\n  \r\n  function getMartialNumber() public view returns(uint) {\r\n    return listedMartials.length;\r\n  }\r\n\r\n  function absSub(uint a, uint b) private pure returns(uint) {\r\n    if (a>b) return a.sub(b);\r\n    return b.sub(a);\r\n  }\r\n  // 用户当前旅行的成本\r\n  function _getTravelPrice(address userAddress, uint martialId) private view returns(uint) {\r\n    Martial storage currentMartial = listedMartials[mapUserCurrentMartialId[userAddress]];\r\n    Martial storage nextMartial = listedMartials[martialId];\r\n    require(currentMartial.martialId != nextMartial.martialId);  // 旅程起点、终点不能相同\r\n    uint stepNumber = absSub(currentMartial.x, nextMartial.x).add(absSub(currentMartial.y, nextMartial.y));\r\n    uint travelPrice = stepNumber.mul(stepPrice).add(nextMartial.enterPrice);\r\n    // 凌波微步的旅行成本减半\r\n    if (mapUserHasSmartSpeed[userAddress]) {\r\n      travelPrice = travelPrice.div(2);\r\n    }\r\n    return travelPrice;\r\n  }\r\n\r\n  function getTravelPrice(uint martialId) public view returns(uint) {\r\n    return _getTravelPrice(msg.sender, martialId);\r\n  }\r\n\r\n  // 旅行\r\n  function changeMartial(uint martialId) public payable {\r\n    uint travelPrice = _getTravelPrice(msg.sender, martialId);\r\n    require(msg.value>=travelPrice);\r\n    require(martialId<listedMartials.length);\r\n    if (mapUserLotteryNumber[msg.sender] > 0) {\r\n        if (mapMartialUserCount[mapUserCurrentMartialId[msg.sender]] > 0) {\r\n            mapMartialUserCount[mapUserCurrentMartialId[msg.sender]] = mapMartialUserCount[mapUserCurrentMartialId[msg.sender]].sub(1);\r\n        }\r\n        mapMartialUserCount[martialId] += 1;\r\n    }\r\n    uint excess = msg.value.sub(travelPrice);\r\n    if (excess>0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    mapUserCurrentMartialId[msg.sender] = martialId;\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(travelPrice));\r\n    totalEarning = totalEarning.add(travelPrice);\r\n    travelTotalEarning = travelTotalEarning.add(travelPrice);\r\n  }\r\n\r\n  // 2.5 lottery\r\n  // get random number in [0, maxNumber)\r\n  function getRandomNumber(uint maxNumber) private returns(uint) {\r\n    require(maxNumber>0);\r\n    randNonce += 1;\r\n    return uint(keccak256(now, randNonce, block.blockhash(block.number - 1), block.coinbase)) % maxNumber;\r\n  }\r\n  // 2.5 lottery\r\n  // whether user can lottery for free\r\n  function _canLotteryFree(address userAddress) private view returns(bool) {\r\n    uint lastLotteryTimestamp = mapUserLastFreeLotteryTimestamp[userAddress];\r\n    return now - lastLotteryTimestamp > freeLotterySeconds;\r\n  }\r\n\r\n// Test for Remix support of tuple params\r\n//   uint public debugNumber = 0;\r\n//   function setDebugNumber(uint a) {\r\n//       debugNumber = a;\r\n//   }\r\n\r\n//   function setDebugNumber2(uint a, uint b) {\r\n//       debugNumber = b;\r\n//   }\r\n\r\n//   function getDebugNumber() public view returns(uint) {\r\n//       return debugNumber;\r\n//   }\r\n  function debug() public view returns(uint, uint, uint, uint, bool) {\r\n      uint lastLotteryTimestamp = mapUserLastFreeLotteryTimestamp[msg.sender];\r\n      return (now, lastLotteryTimestamp, now-lastLotteryTimestamp, freeLotterySeconds, now - lastLotteryTimestamp > freeLotterySeconds);\r\n  }\r\n\r\n  function getNowTimestamp() public view returns(uint) {\r\n      return now;\r\n  }\r\n\r\n  function getMyLastFreeLotteryTimestamp() public view returns(uint) {\r\n    return mapUserLastFreeLotteryTimestamp[msg.sender];\r\n  }\r\n\r\n  function canLotteryFree() public view returns(bool) {\r\n    return _canLotteryFree(msg.sender);\r\n  }\r\n\r\n  //获取某个门派的所有卡片\r\n  function getMartialCardTypeIdList(uint martialId) public view returns(uint[]) {\r\n    require(martialId<listedMartials.length);\r\n    return listedMartials[martialId].cardTypeList;\r\n  }\r\n\r\n  function getCardTypeInfo(uint typeId) public view returns(uint, uint, uint, uint, uint) {\r\n    require(typeId < listedCardType.length);\r\n    CardType memory cardType = listedCardType[typeId];\r\n    return (cardType.typeId, cardType.martialId, cardType.initPower, cardType.growthFactor, cardType.category);\r\n  }\r\n\r\n  function getCardPower(uint cardTypeId, uint cardLevel) public view returns(uint){\r\n    require(cardLevel<=3);\r\n    require(cardTypeId<listedCardType.length);\r\n    CardType memory cardType = listedCardType[cardTypeId];\r\n    if (cardLevel == 0) {\r\n      return cardType.initPower;\r\n    } else if (cardLevel == 1) {\r\n      return cardType.initPower.mul(cardType.growthFactor);\r\n    } else if (cardLevel == 2) {\r\n      return cardType.initPower.mul(cardType.growthFactor).mul(cardType.growthFactor);\r\n    } else if (cardLevel == 3) {\r\n      return cardType.initPower.mul(cardType.growthFactor).mul(cardType.growthFactor).mul(cardType.growthFactor);\r\n    }\r\n  }\r\n\r\n  function getUserPower(address userAddress) public view returns(uint) {\r\n      return mapUserPower[userAddress];\r\n  }\r\n  // 用户只能在自己的据点抽卡\r\n  function lottery() public payable {\r\n    require((msg.value >= lotteryPrice || _canLotteryFree(msg.sender)));\r\n    totalLotteryNumber = totalLotteryNumber.add(1);\r\n    uint currentLotteryPrice = 0;\r\n    if (_canLotteryFree(msg.sender)) {\r\n      mapUserLastFreeLotteryTimestamp[msg.sender] = now;\r\n    } else {\r\n      currentLotteryPrice = lotteryPrice;\r\n    }\r\n    uint excess = msg.value.sub(currentLotteryPrice);\r\n    // 掌门抽成\r\n    uint userCurrentMartialId = mapUserCurrentMartialId[msg.sender];\r\n    if (currentLotteryPrice > 0) {\r\n      address martialOwner = listedMartials[userCurrentMartialId].owner;\r\n      if (martialOwner != address(0)) {\r\n        uint martialOwnerCut = currentLotteryPrice.mul(30).div(100);\r\n        martialOwner.transfer(martialOwnerCut);\r\n        // martialOwner.transfer(currentLotteryPrice);\r\n      }\r\n    }\r\n    if (excess>0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n  \r\n    // cardType && cardLevel\r\n    // cardType\r\n    uint martialCardTypeCount = listedMartials[userCurrentMartialId].cardTypeList.length;\r\n    // 3个随机 50%概率本据点的卡 epic_number%抽到特殊卡 lotteryId抽到的卡片数量\r\n    uint randomNumber = getRandomNumber(martialCardTypeCount.mul(1000));\r\n\r\n    uint lotteryCardTypeId = listedMartials[userCurrentMartialId].cardTypeList[randomNumber % martialCardTypeCount];\r\n    // 据点玩家有50%的概率抽到本据点的卡\r\n    if (randomNumber % 10 >= 5) {\r\n        lotteryCardTypeId = randomNumber % listedCardType.length;\r\n    }\r\n    randomNumber = randomNumber.div(10).div(martialCardTypeCount);\r\n    // cardLevel\r\n    if (now - listedMartials[userCurrentMartialId].lastProduceTime >= produceUnitSeconds) {\r\n      listedMartials[userCurrentMartialId].epicNumber += unitEpicGrowth;\r\n      listedMartials[userCurrentMartialId].rareNumber += unitRareGrowth;\r\n      listedMartials[userCurrentMartialId].mythNumber += unitMythGrowth;\r\n      listedMartials[userCurrentMartialId].lastProduceTime = listedMartials[userCurrentMartialId].lastProduceTime.add(produceUnitSeconds);\r\n    }\r\n    uint lotteryCardLevel = 0;\r\n    Martial memory userCurrentMartial = listedMartials[userCurrentMartialId];\r\n    uint luckyStoneFactor = 1;\r\n    if (mapUserHasLuckyStone[msg.sender]) {\r\n      luckyStoneFactor = 2;\r\n    }\r\n\r\n    // 如果用户拥有luckyStone 那么抽到好卡的概率翻倍\r\n    // Free lottery can only get normal card\r\n    if (randomNumber % 100 < userCurrentMartial.mythNumber.mul(luckyStoneFactor) && userCurrentMartial.mythNumber > 0 && currentLotteryPrice>0) {\r\n      lotteryCardLevel = 3;\r\n      listedMartials[userCurrentMartialId].mythNumber = listedMartials[userCurrentMartialId].mythNumber.sub(1);\r\n    } else if (randomNumber % 100 < luckyStoneFactor.mul(userCurrentMartial.mythNumber.add(userCurrentMartial.epicNumber)) && userCurrentMartial.epicNumber > 0 && currentLotteryPrice > 0) {\r\n      lotteryCardLevel = 2;\r\n      listedMartials[userCurrentMartialId].epicNumber = listedMartials[userCurrentMartialId].epicNumber.sub(1);\r\n    } else if (randomNumber % 100 < luckyStoneFactor.mul(userCurrentMartial.mythNumber.add(userCurrentMartial.epicNumber.add(userCurrentMartial.rareNumber))) && userCurrentMartial.rareNumber > 0 && currentLotteryPrice > 0) {\r\n      lotteryCardLevel = 1;\r\n      listedMartials[userCurrentMartialId].rareNumber = listedMartials[userCurrentMartialId].rareNumber.sub(1);\r\n    }\r\n\r\n    // issue card\r\n    Card memory card = Card(listedCard.length, lotteryCardTypeId, lotteryCardLevel, false, 0, msg.sender);\r\n    mapOwnerOfCard[listedCard.length] = msg.sender;\r\n    if (mapUserLotteryNumber[msg.sender] == 0) {\r\n        totalUserNumber = totalUserNumber.add(1);\r\n        mapMartialUserCount[mapUserCurrentMartialId[msg.sender]] += 1;\r\n    }\r\n    mapUserLotteryNumber[msg.sender] += 1;\r\n    if (lotteryGiveHunt && mapUserLotteryNumber[msg.sender] >= lotteryGiveHuntMinimalNumber) {\r\n        if (mapUserHasHunterLicence[msg.sender] == false) {\r\n            mapUserHasHunterLicence[msg.sender] = true;\r\n        }\r\n    }\r\n    mapMartialLotteryCount[mapUserCurrentMartialId[msg.sender]] += 1;\r\n    mapUserPower[msg.sender] = mapUserPower[msg.sender].add(getCardPower(lotteryCardTypeId, lotteryCardLevel));\r\n    if (mapUserPower[msg.sender] > maxUserPower) {\r\n      maxUserPower = mapUserPower[msg.sender];\r\n      maxPowerUserAddress = msg.sender;\r\n    }\r\n    listedCard.push(card);\r\n\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(currentLotteryPrice));\r\n    totalEarning = totalEarning.add(currentLotteryPrice);\r\n    totalTrading = totalTrading.add(currentLotteryPrice);\r\n    lotteryTotalEarning = lotteryTotalEarning.add(currentLotteryPrice);\r\n  }\r\n\r\n  function getCardNumber() public view returns(uint) {\r\n      return listedCard.length;\r\n  }\r\n\r\n  function getCardInfo(uint cardId) public view returns(uint, uint, uint, bool, uint, address) {\r\n      require(cardId<listedCard.length);\r\n      Card memory card = listedCard[cardId];\r\n      return (card.cardId, card.typeId, card.level, card.onSell, card.sellPrice, card.owner);\r\n  }\r\n  \r\n  function getGameStats() public view returns(uint, uint, uint, uint, uint, address) {\r\n      return (totalUserNumber, totalBuyCardNumber, totalLotteryNumber, totalEarning, totalTrading, wuxiaMaster);\r\n  }\r\n\r\n  // 2.6 卡片合成\r\n  // 两张卡必须不能在卖出状态\r\n  function mergeCard(uint a, uint b) public {\r\n    require(a<listedCard.length);\r\n    require(b<listedCard.length);\r\n    require(listedCard[a].typeId==listedCard[b].typeId);\r\n    require(listedCard[a].level==listedCard[b].level);\r\n    require(listedCard[a].level<=2);  // 0 for normal, 1 for rare, 2 for epic, 3 for myth\r\n    require(!listedCard[a].onSell);\r\n    require(!listedCard[b].onSell);\r\n    require(mapOwnerOfCard[a]==msg.sender);\r\n    require(mapOwnerOfCard[b]==msg.sender);\r\n    Card memory card = Card(listedCard.length, listedCard[a].typeId, listedCard[a].level.add(1), false, 0, msg.sender);\r\n    mapOwnerOfCard[a] = address(0);\r\n    mapOwnerOfCard[b] = address(0);\r\n    listedCard[a].owner = address(0);\r\n    listedCard[b].owner = address(0);\r\n    mapOwnerOfCard[listedCard.length] = msg.sender;\r\n    listedCard.push(card);\r\n    // 需要维护用户的战斗力\r\n    mapUserPower[msg.sender] = mapUserPower[msg.sender].add(getCardPower(listedCard[a].typeId, listedCard[a].level.add(1)).sub(getCardPower(listedCard[a].typeId, listedCard[a].level).mul(2)));\r\n    if (mapUserPower[msg.sender] > maxUserPower) {\r\n      maxUserPower = mapUserPower[msg.sender];\r\n      maxPowerUserAddress = msg.sender;\r\n    }\r\n  }\r\n\r\n  // 2.7 掌门人\r\n  // 争夺掌门人\r\n  function beatMartialOwner() public returns (bool){\r\n    uint myMartialId = mapUserCurrentMartialId[msg.sender];\r\n    address martialOwner = listedMartials[myMartialId].owner;\r\n    require(msg.sender!=martialOwner);\r\n    require(!mapUesrAlreadyMartialOwner[msg.sender]);\r\n    // 空的门派可以直接被占领\r\n    if (martialOwner==address(0)) {\r\n      listedMartials[myMartialId].owner = msg.sender;\r\n      mapUesrAlreadyMartialOwner[msg.sender] = true;\r\n      mapUesrAlreadyMartialOwner[martialOwner] = false;\r\n      return true;\r\n    } else {\r\n      if (mapUserPower[msg.sender] > mapUserPower[martialOwner]) {\r\n        listedMartials[myMartialId].owner = msg.sender;\r\n        mapUesrAlreadyMartialOwner[msg.sender] = true;\r\n        mapUesrAlreadyMartialOwner[martialOwner] = false;\r\n        return true;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n\r\n  // 2.8 wuxiaMaster\r\n  // 回本周期长, 投资需谨慎\r\n  // 武林盟主将获得所有卡牌交易费用的5% 每获得1.1单位收益 武林盟主的价格会下降1 也就是说你最多可以获得投资的110%的收益\r\n  // 设立wuxiaMaster的主要目的是希望有看得起这个游戏的人 投一点钱 让我请女朋友吃顿自助\r\n  // 希望不会让你亏损~\r\n  function currentWulinMasterPrice() public view returns(uint){\r\n    return wuxiaMasterPrice;\r\n  }\r\n\r\n  function buyWuxiaMaster() payable public {\r\n    require(msg.value>=wuxiaMasterPrice);\r\n    require(msg.sender!=wuxiaMaster);\r\n    // 给老的owner转出当时买入的价钱\r\n    wuxiaMaster.transfer(wuxiaMasterPrice - 100 finney);\r\n    uint excess = msg.value.sub(wuxiaMasterPrice);\r\n    // 转出余额\r\n    if (excess>0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    // wuxiaMaster其实是亏钱买卖 不计入totalEarning\r\n    masterTotalEarning = masterTotalEarning.add(wuxiaMasterPrice);\r\n    totalTrading = totalTrading.add(wuxiaMasterPrice);\r\n\r\n    // 更新武林盟主\r\n    wuxiaMaster = msg.sender;\r\n    wuxiaMasterPrice = wuxiaMasterPrice.add(100 finney);\r\n  }\r\n\r\n\r\n  // 2.9 card Trading\r\n  function sellCard(uint cardId, uint price) public {\r\n    require(cardId<listedCard.length);\r\n    totalSellCardNumber = totalSellCardNumber.add(1);\r\n    address cardOwner = mapOwnerOfCard[cardId];\r\n    require(cardOwner!=address(0));  // 不能卖出被销毁的卡\r\n    require(cardOwner==msg.sender);  // 只能卖出自己的卡\r\n    require(!listedCard[cardId].onSell); // 不能卖出已在卖出状态的卡\r\n    listedCard[cardId].onSell = true;\r\n    listedCard[cardId].sellPrice = price;\r\n  }\r\n\r\n  function cancelSell(uint cardId) public {\r\n    require(cardId<listedCard.length);\r\n    address cardOwner = mapOwnerOfCard[cardId];\r\n    require(cardOwner!=address(0));\r\n    require(cardOwner==msg.sender);  // 只能取消自己的卡\r\n    require(listedCard[cardId].onSell); // 必须在待卖出状态\r\n    listedCard[cardId].onSell = false;\r\n  }\r\n\r\n  // 用户卖出卡片 需要支付5%的佣金 其中2%给开发者 3%给武林盟主\r\n  function buyCard(uint cardId) payable public {\r\n    require(mapOwnerOfCard[cardId]!=address(0));\r\n    require(msg.sender!=mapOwnerOfCard[cardId]);\r\n    require(listedCard[cardId].onSell);\r\n    uint buyPrice = listedCard[cardId].sellPrice;\r\n    totalBuyCardNumber = totalBuyCardNumber.add(1);\r\n    require(msg.value>=buyPrice);\r\n    // 处理余额\r\n    uint excess = msg.value.sub(buyPrice);\r\n    if (excess>0) {\r\n      msg.sender.transfer(excess);\r\n    }\r\n    // 给开发5%\r\n    uint devCut = buyPrice.div(100).mul(0);\r\n    uint masterCut = buyPrice.div(100).mul(5);\r\n    if (wuxiaMaster==address(0)) {\r\n      devCut = devCut.add(masterCut);\r\n      masterCut = 0;\r\n    } else {\r\n      wuxiaMaster.transfer(masterCut);\r\n    }\r\n    // 修改wuxiaMaster的price\r\n    // 保证MasterPrice>=100 finney\r\n    uint masterPriceMinus = masterCut.mul(100).div(110);\r\n    if (wuxiaMasterPrice >= masterPriceMinus.add(100 finney)) {\r\n        wuxiaMasterPrice = wuxiaMasterPrice.sub(masterPriceMinus);\r\n    } else {\r\n        wuxiaMasterPrice = 100 finney;\r\n    }\r\n    // 给用户95%\r\n    uint moneyToSeller = buyPrice.sub(devCut.add(masterCut));\r\n    mapOwnerOfCard[cardId].transfer(moneyToSeller);\r\n    // 维护战力\r\n    uint cardPower = getCardPower(listedCard[cardId].typeId, listedCard[cardId].level);\r\n    // change onSell\r\n    listedCard[cardId].onSell = false;\r\n    mapUserPower[mapOwnerOfCard[cardId]] = mapUserPower[mapOwnerOfCard[cardId]].sub(cardPower);\r\n    mapUserPower[msg.sender] = mapUserPower[msg.sender].add(cardPower);\r\n    // // 所有权转移\r\n    mapOwnerOfCard[cardId] = msg.sender;\r\n    listedCard[cardId].owner = msg.sender;\r\n    // etherMonster\r\n    _tryCreateEtherMonster(totalEarning, totalEarning.add(devCut));\r\n    totalEarning = totalEarning.add(devCut);\r\n    totalTrading = totalTrading.add(buyPrice);\r\n    marketTotalEarning = marketTotalEarning.add(devCut);\r\n  }\r\n\r\n  // 2.10 龙女彩票 => 每5张彩票开奖一次\r\n  // 获得一张普通的小龙女 cardType为0的卡片定义为小龙女\r\n  function getCurrentDragonGirlLotteryNumber() public view returns(uint) {\r\n    return dragonGirlLotteryNumber;\r\n  }\r\n\r\n  function buyLittleDragonGirlLottery() public payable{\r\n    require(msg.value>=dragonGirlLotteryPrice);\r\n    require(listedCardType.length>0);\r\n    totalDragonLotteryNumber = totalDragonLotteryNumber.add(1);\r\n    listedDragonGirlLotteryUser[dragonGirlLotteryNumber] = msg.sender;\r\n    dragonGirlLotteryNumber = dragonGirlLotteryNumber.add(1);\r\n\r\n    if (dragonGirlLotteryNumber == 5) {\r\n      // 抽奖\r\n      uint randomNumber = getRandomNumber(5);\r\n      address winner = listedDragonGirlLotteryUser[randomNumber];\r\n      mapOwnerOfCard[listedCard.length] = winner;\r\n      Card memory card = Card(listedCard.length, 0, 0, false, 0, winner);\r\n      listedCard.push(card);\r\n      // 更新获奖者战力\r\n      mapUserPower[winner] = mapUserPower[winner].add(getCardPower(0, 0));\r\n      dragonGirlLotteryNumber = 0;\r\n    }\r\n  }\r\n\r\n  // 收入的30%反馈给掌门人和猎以太怪人\r\n  function _tryCreateEtherMonster(uint price_a, uint price_b) private {\r\n    uint priceTimes = price_b.div(0.5 ether);\r\n    // 40% for little monster\r\n    if (price_a<priceTimes*0.5 ether && price_b>=priceTimes*0.5 ether) {\r\n      // 生成小怪兽\r\n      uint martialId = getRandomNumber(listedMartials.length);\r\n      EtherMonster memory monster = EtherMonster(listedEtherMonster.length, martialId, 0.2 ether, maxUserPower.mul(smallMonsterPowerFactor), now, maxUserPower.mul(smallMonsterPowerFactor), false, address(0));\r\n      listedEtherMonster.push(monster);\r\n    }\r\n    priceTimes = price_b.div(5 ether);\r\n    // 20% for large monster\r\n    if (price_a<priceTimes*5 ether && price_b>=priceTimes*5 ether) {\r\n      // 生成大怪兽\r\n      uint bigMartialId = (getRandomNumber(listedEtherMonster.length).add(10007)) % listedMartials.length;\r\n      EtherMonster memory bigMonster = EtherMonster(listedEtherMonster.length, bigMartialId, 1 ether, maxUserPower.mul(bigMonsterPowerFactor), now, maxUserPower.mul(bigMonsterPowerFactor), false, address(0));\r\n      listedEtherMonster.push(bigMonster);\r\n    }\r\n  }\r\n\r\n  function getEtherMonsterNumber() public view returns(uint) {\r\n    return listedEtherMonster.length;\r\n  }\r\n\r\n  function getCanAttackMonsterIds() public view returns(uint[]) {\r\n      uint[] memory result = new uint[](listedEtherMonster.length+1);\r\n      uint index=0;\r\n      for (uint i=0; i<listedEtherMonster.length; i++) {\r\n        EtherMonster memory monster = listedEtherMonster[i];\r\n        if (monster.produceTime.add(etherMonsterHuntSeconds)>now && !monster.defeated) {\r\n            result[index] = i+1;\r\n            index += 1;\r\n        }\r\n      }\r\n      return result;\r\n    }\r\n\r\n  function getOnSellCardIds() public view returns(uint[]) {\r\n      uint[] memory result = new uint[](listedCard.length+1);\r\n      uint index = 0;\r\n      for (uint i=0; i<listedCard.length; i++) {\r\n          if (listedCard[i].onSell) {\r\n              result[index] = i+1;\r\n              index += 1;\r\n          }\r\n      }\r\n      return result;\r\n  }\r\n\r\n  function getEtherMonsterInfo(uint monsterId) public view returns(uint, uint, uint, uint, uint, uint, bool, address) {\r\n      require(monsterId<listedEtherMonster.length);\r\n      EtherMonster memory monster = listedEtherMonster[monsterId];\r\n      return (monster.monsterId, monster.martialId, monster.balance, monster.blood, monster.produceTime, monster.currentBlood, monster.defeated, monster.winner);\r\n  }\r\n\r\n  // 掌门人会获得\r\n  function attackMonster(uint monsterId) public {\r\n    // 每个人只能攻击一次\r\n    require(!listedEtherMonster[monsterId].defeated);  // 没有被打败过\r\n    require(address(this).balance>=listedEtherMonster[monsterId].balance);  // 要有足够的奖金\r\n    require(mapUserLastAttackMonsterTimestamp[msg.sender].add(userAttackMonsterCDSeconds) < now);\r\n    require(listedEtherMonster[monsterId].produceTime.add(etherMonsterHuntSeconds) > now);\r\n    require(mapUserHasHunterLicence[msg.sender]);  // 用户有狩猎凭证\r\n    // 只要在该门派的人才能攻击\r\n    require(mapUserCurrentMartialId[msg.sender]==listedEtherMonster[monsterId].martialId);\r\n    // 判断monster当前的血量\r\n    uint monsterCurrentBlood = listedEtherMonster[monsterId].currentBlood;\r\n    uint monsterTotalBlood = listedEtherMonster[monsterId].blood;\r\n    mapUserLastAttackMonsterTimestamp[msg.sender] = now;\r\n    if (mapUserPower[msg.sender] >= monsterCurrentBlood) {\r\n      // 战力取胜\r\n      listedEtherMonster[monsterId].defeated = true;\r\n      listedEtherMonster[monsterId].winner = msg.sender;\r\n      _sendMonsterPrize(monsterId, msg.sender);\r\n    } else {\r\n      // 判断能否概率取胜\r\n      uint randomNumber = getRandomNumber(monsterTotalBlood);\r\n      if (randomNumber < mapUserPower[msg.sender]) {\r\n        listedEtherMonster[monsterId].defeated = true;\r\n        listedEtherMonster[monsterId].winner = msg.sender;\r\n        _sendMonsterPrize(monsterId, msg.sender);\r\n      } else {\r\n        listedEtherMonster[monsterId].currentBlood = monsterCurrentBlood.sub(mapUserPower[msg.sender]);\r\n      }\r\n    }\r\n  }\r\n\r\n  function _sendMonsterPrize(uint monsterId, address winner) private {\r\n    uint totalPrize = listedEtherMonster[monsterId].balance;\r\n    uint martialOwnerCut = 0;\r\n    if (listedMartials[listedEtherMonster[monsterId].martialId].owner != address(0)) {\r\n      martialOwnerCut = totalPrize.mul(10).div(100);\r\n    }\r\n    winner.transfer(totalPrize.sub(martialOwnerCut));\r\n    listedMartials[listedEtherMonster[monsterId].martialId].owner.transfer(martialOwnerCut);\r\n  }\r\n\r\n  // 2.12 用户设nickname\r\n  function setNickname(bytes32 nickname) public {\r\n    mapUserNickname[msg.sender] = nickname;\r\n  }\r\n\r\n  function getAddressNickname(address userAddress) public view returns(bytes32){\r\n    return mapUserNickname[userAddress];\r\n  }\r\n\r\n  // 2.13 统计指标\r\n  function listedMartialsLength() public view returns(uint length) {\r\n      return listedMartials.length;\r\n  }\r\n\r\n\r\n    function initMartial() onlyOwner() public {\r\n        require(!hasInitMartial);\r\n        createNewMartial(16,14,0);\r\n        createNewMartial(10,11,0);\r\n        createNewMartial(13,10,0);\r\n        createNewMartial(12,12,0);\r\n        createNewMartial(4,3,0);\r\n        createNewMartial(11,10,0);\r\n        createNewMartial(6,14,0);\r\n        createNewMartial(9,9,0);\r\n        createNewMartial(10,10,0);\r\n        createNewMartial(9,7,0);\r\n        createNewMartial(12,10,0);\r\n        hasInitMartial = true;\r\n    }\r\n\r\n  function initCard1() onlyOwner() public {\r\n    require(!hasInitCard1);\r\n    createNewCardType(1,8,10,1);\r\n    createNewCardType(1,10,10,1);\r\n    createNewCardType(1,8,10,1);\r\n    createNewCardType(1,5,12,3);\r\n    createNewCardType(1,4,12,3);\r\n    createNewCardType(1,200,3,2);\r\n    createNewCardType(1,200,3,2);\r\n    createNewCardType(0,1,2,1);\r\n    createNewCardType(0,1,30,3);\r\n    createNewCardType(0,5,2,2);\r\n    createNewCardType(0,3,2,2);\r\n    createNewCardType(0,2,2,3);\r\n    createNewCardType(0,4,2,3);\r\n    createNewCardType(0,8,2,2);\r\n    createNewCardType(2,12,10,1);\r\n    createNewCardType(2,10,10,1);\r\n    createNewCardType(2,5,12,3);\r\n    createNewCardType(2,5,12,3);\r\n    createNewCardType(2,4,12,3);\r\n    createNewCardType(2,5,20,4);\r\n    createNewCardType(2,18,15,4);\r\n    createNewCardType(3,13,10,1);\r\n    createNewCardType(3,5,13,3);\r\n    createNewCardType(3,5,12,3);\r\n    createNewCardType(3,5,10,3);\r\n    createNewCardType(3,10,8,3);\r\n    createNewCardType(3,80,5,2);\r\n    createNewCardType(3,7,20,4);\r\n    createNewCardType(4,11,10,1);\r\n    createNewCardType(4,10,10,1);\r\n    createNewCardType(4,9,10,1);\r\n    createNewCardType(4,5,12,3);\r\n    createNewCardType(4,5,11,3);\r\n    createNewCardType(4,5,10,3);\r\n    createNewCardType(4,200,3,2);\r\n    hasInitCard1 = true;\r\n  }\r\n\r\n    function initCard2() onlyOwner() public {\r\n    require(!hasInitCard2);\r\n    createNewCardType(5,10,10,1);\r\n    createNewCardType(5,8,10,1);\r\n    createNewCardType(5,5,8,1);\r\n    createNewCardType(5,3,10,3);\r\n    createNewCardType(5,5,12,3);\r\n    createNewCardType(5,3,11,3);\r\n    createNewCardType(5,70,4,2);\r\n    createNewCardType(6,10,10,1);\r\n    createNewCardType(6,6,8,1);\r\n    createNewCardType(6,5,8,1);\r\n    createNewCardType(6,4,12,3);\r\n    createNewCardType(6,5,12,3);\r\n    createNewCardType(6,5,12,3);\r\n    createNewCardType(6,80,5,2);\r\n    createNewCardType(7,10,12,1);\r\n    createNewCardType(7,100,4,2);\r\n    createNewCardType(7,100,5,2);\r\n    createNewCardType(7,100,4,2);\r\n    createNewCardType(7,100,4,2);\r\n    createNewCardType(7,100,4,2);\r\n    createNewCardType(8,10,10,1);\r\n    createNewCardType(8,9,10,1);\r\n    createNewCardType(8,5,6,1);\r\n    createNewCardType(8,4,12,3);\r\n    createNewCardType(8,5,12,3);\r\n    createNewCardType(8,4,12,3);\r\n    createNewCardType(8,4,20,4);\r\n    createNewCardType(9,10,10,1);\r\n    createNewCardType(9,7,10,1);\r\n    createNewCardType(9,1,20,1);\r\n    createNewCardType(9,5,13,3);\r\n    createNewCardType(9,5,13,3);\r\n    createNewCardType(9,80,5,2);\r\n    createNewCardType(9,90,5,2);\r\n    createNewCardType(10,9,10,1);\r\n    createNewCardType(10,10,10,1);\r\n    createNewCardType(10,4,12,1);\r\n    createNewCardType(10,80,5,2);\r\n    createNewCardType(10,5,12,3);\r\n    createNewCardType(10,5,12,3);\r\n    hasInitCard2 = true;\r\n  }\r\n\r\n  /* Withdraw */\r\n  /*\r\n    NOTICE: These functions withdraw the developer's cut which is left\r\n    in the contract by `buy`. User funds are immediately sent to the old\r\n    owner in `buy`, no user funds are left in the contract.\r\n  */\r\n  function withdrawAll () onlyAdmins() public {\r\n   msg.sender.transfer(address(this).balance);\r\n  }\r\n\r\n  function withdrawAmount (uint256 _amount) onlyAdmins() public {\r\n    msg.sender.transfer(_amount);\r\n  }\r\n\r\n  /* ERC721 */\r\n\r\n  function name() public pure returns (string) {\r\n    return \"Ethwuxia.pro\";\r\n  }\r\n\r\n  function symbol() public pure returns (string) {\r\n    return \"EWX\";\r\n  }\r\n\r\n  function totalSupply() public view returns (uint256) {\r\n    return listedCard.length;\r\n  }\r\n\r\n  function balanceOf (address _owner) public view returns (uint256 _balance) {\r\n    uint counter = 0;\r\n\r\n    for (uint i = 0; i < listedCard.length; i++) {\r\n      if (ownerOf(listedCard[i].cardId) == _owner) {\r\n        counter++;\r\n      }\r\n    }\r\n\r\n    return counter;\r\n  }\r\n\r\n  function ownerOf (uint256 _itemId) public view returns (address _owner) {\r\n    return mapOwnerOfCard[_itemId];\r\n  }\r\n\r\n  function tokensOf (address _owner) public view returns (uint[]) {\r\n    uint[] memory result = new uint[](balanceOf(_owner));\r\n\r\n    uint256 itemCounter = 0;\r\n    for (uint256 i = 0; i < listedCard.length; i++) {\r\n      if (ownerOf(i) == _owner) {\r\n        result[itemCounter] = listedCard[i].cardId;\r\n        itemCounter += 1;\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  function tokenExists (uint256 _itemId) public view returns (bool _exists) {\r\n    return mapOwnerOfCard[_itemId] != address(0);\r\n  }\r\n\r\n  function approvedFor(uint256 _itemId) public view returns (address _approved) {\r\n    return approvedOfItem[_itemId];\r\n  }\r\n\r\n  function approve(address _to, uint256 _itemId) public {\r\n    require(msg.sender != _to);\r\n    require(tokenExists(_itemId));\r\n    require(ownerOf(_itemId) == msg.sender);\r\n\r\n    if (_to == 0) {\r\n      if (approvedOfItem[_itemId] != 0) {\r\n        delete approvedOfItem[_itemId];\r\n        emit Approval(msg.sender, 0, _itemId);\r\n      }\r\n    } else {\r\n      approvedOfItem[_itemId] = _to;\r\n      emit Approval(msg.sender, _to, _itemId);\r\n    }\r\n  }\r\n\r\n  /* Transferring a country to another owner will entitle the new owner the profits from `buy` */\r\n  function transfer(address _to, uint256 _itemId) public {\r\n    require(msg.sender == ownerOf(_itemId));\r\n    _transfer(msg.sender, _to, _itemId);\r\n  }\r\n\r\n  function transferFrom(address _from, address _to, uint256 _itemId) public {\r\n    require(approvedFor(_itemId) == msg.sender);\r\n    _transfer(_from, _to, _itemId);\r\n  }\r\n\r\n  function _transfer(address _from, address _to, uint256 _itemId) internal {\r\n    require(tokenExists(_itemId));\r\n    require(ownerOf(_itemId) == _from);\r\n    require(_to != address(0));\r\n    require(_to != address(this));\r\n    return ;  // disable card transfer\r\n\r\n    mapOwnerOfCard[_itemId] = _to;\r\n    approvedOfItem[_itemId] = 0;\r\n\r\n    emit Transfer(_from, _to, _itemId);\r\n  }\r\n\r\n  /* Read */\r\n  function isAdmin (address _admin) public view returns (bool _isAdmin) {\r\n    return admins[_admin];\r\n  }\r\n\r\n  /* Util */\r\n  function isContract(address addr) internal view returns (bool) {\r\n    uint size;\r\n    assembly { size := extcodesize(addr) } // solium-disable-line\r\n    return size > 0;\r\n  }\r\n}\r\n\r\ninterface IItemRegistry {\r\n  function itemsForSaleLimit (uint256 _from, uint256 _take) external view returns (uint256[] _items);\r\n  function ownerOf (uint256 _itemId) external view returns (address _owner);\r\n  function priceOf (uint256 _itemId) external view returns (uint256 _price);\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"tokenExists\",\"outputs\":[{\"name\":\"_exists\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"userAddress\",\"type\":\"address\"}],\"name\":\"getUserPower\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserNickname\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserLastAttackMonsterTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdrawAmount\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCardNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"smartSpeedEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"initMartial\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"cardId\",\"type\":\"uint256\"}],\"name\":\"cancelSell\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"a\",\"type\":\"uint256\"},{\"name\":\"b\",\"type\":\"uint256\"}],\"name\":\"mergeCard\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getEtherMonsterNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"approve\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"beatMartialOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"}],\"name\":\"changeMartial\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"setOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getMartialListInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"unitMythGrowth\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lotteryTotalEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_admin\",\"type\":\"address\"}],\"name\":\"removeAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSupply\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"nickname\",\"type\":\"bytes32\"}],\"name\":\"setNickname\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getGameStats\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"}],\"name\":\"getTravelPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_itemRegistry\",\"type\":\"address\"}],\"name\":\"setItemRegistry\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCurrentHunterLicencePrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"monsterId\",\"type\":\"uint256\"}],\"name\":\"attackMonster\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"transferFrom\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_admin\",\"type\":\"address\"}],\"name\":\"isAdmin\",\"outputs\":[{\"name\":\"_isAdmin\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"mapMartialUserCount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"canLotteryFree\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"mapOwnerOfCard\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"approvedFor\",\"outputs\":[{\"name\":\"_approved\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"listedMartials\",\"outputs\":[{\"name\":\"x\",\"type\":\"uint256\"},{\"name\":\"y\",\"type\":\"uint256\"},{\"name\":\"owner\",\"type\":\"address\"},{\"name\":\"lastProduceTime\",\"type\":\"uint256\"},{\"name\":\"martialId\",\"type\":\"uint256\"},{\"name\":\"rareNumber\",\"type\":\"uint256\"},{\"name\":\"epicNumber\",\"type\":\"uint256\"},{\"name\":\"mythNumber\",\"type\":\"uint256\"},{\"name\":\"enterPrice\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCurrentSmartSpeedPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"initCard2\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"luckyStoneEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"monsterId\",\"type\":\"uint256\"}],\"name\":\"getEtherMonsterInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bool\"},{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"initialMartialTimes\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"enableLotteryGiveHunt\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"},{\"name\":\"initPower\",\"type\":\"uint256\"},{\"name\":\"growthFactor\",\"type\":\"uint256\"},{\"name\":\"category\",\"type\":\"uint256\"}],\"name\":\"createNewCardType\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buyLuckyStone\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalTrading\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserHasHunterLicence\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"listedCardType\",\"outputs\":[{\"name\":\"typeId\",\"type\":\"uint256\"},{\"name\":\"martialId\",\"type\":\"uint256\"},{\"name\":\"initPower\",\"type\":\"uint256\"},{\"name\":\"growthFactor\",\"type\":\"uint256\"},{\"name\":\"category\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"currentWulinMasterPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getMyLastFreeLotteryTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalBuyCardNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalDragonLotteryNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"travelUnitFee\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"debug\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"tokensOf\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"listedMartialsLength\",\"outputs\":[{\"name\":\"length\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dragonGirlLotteryPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buyHunterLicence\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"randNonce\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"ownerOf\",\"outputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserHasSmartSpeed\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_admin\",\"type\":\"address\"}],\"name\":\"addAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"balanceOf\",\"outputs\":[{\"name\":\"_balance\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"travelTotalEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserHasLuckyStone\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOnSellCardIds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"listedDragonGirlLotteryUser\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"},{\"name\":\"balance\",\"type\":\"uint256\"},{\"name\":\"blood\",\"type\":\"uint256\"}],\"name\":\"createEtherMonster\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getNowTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"userAddress\",\"type\":\"address\"}],\"name\":\"userHasHunterLicence\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxUserPower\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"mapMartialLotteryCount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"userAddress\",\"type\":\"address\"}],\"name\":\"userHasSmartSpeed\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"userAddress\",\"type\":\"address\"}],\"name\":\"getAddressNickname\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"initCard1\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdrawAll\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buyLittleDragonGirlLottery\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"marketTotalEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buyWuxiaMaster\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getMartialNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"hunterLicenceEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"x\",\"type\":\"uint256\"},{\"name\":\"y\",\"type\":\"uint256\"},{\"name\":\"enterPrice\",\"type\":\"uint256\"}],\"name\":\"createNewMartial\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"}],\"name\":\"getMartialInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"symbol\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"unitEpicGrowth\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"cardId\",\"type\":\"uint256\"}],\"name\":\"getCardInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bool\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"listedEtherMonster\",\"outputs\":[{\"name\":\"monsterId\",\"type\":\"uint256\"},{\"name\":\"martialId\",\"type\":\"uint256\"},{\"name\":\"balance\",\"type\":\"uint256\"},{\"name\":\"blood\",\"type\":\"uint256\"},{\"name\":\"produceTime\",\"type\":\"uint256\"},{\"name\":\"currentBlood\",\"type\":\"uint256\"},{\"name\":\"defeated\",\"type\":\"bool\"},{\"name\":\"winner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"cardId\",\"type\":\"uint256\"},{\"name\":\"price\",\"type\":\"uint256\"}],\"name\":\"sellCard\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSellCardNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"},{\"name\":\"_itemId\",\"type\":\"uint256\"}],\"name\":\"transfer\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"typeId\",\"type\":\"uint256\"}],\"name\":\"getCardTypeInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"wuxiaMaster\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCurrentDragonGirlLotteryNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lotteryGiveHunt\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCurrentLuckyStonePrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"lottery\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"littleMonster\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"freeLotterySeconds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getUserCurrentMartialId\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUesrAlreadyMartialOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalLotteryNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"cardId\",\"type\":\"uint256\"}],\"name\":\"buyCard\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"unitRareGrowth\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buySmartSpeed\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"cardTypeId\",\"type\":\"uint256\"},{\"name\":\"cardLevel\",\"type\":\"uint256\"}],\"name\":\"getCardPower\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"dragonGirlLotteryNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"listedCard\",\"outputs\":[{\"name\":\"cardId\",\"type\":\"uint256\"},{\"name\":\"typeId\",\"type\":\"uint256\"},{\"name\":\"level\",\"type\":\"uint256\"},{\"name\":\"onSell\",\"type\":\"bool\"},{\"name\":\"sellPrice\",\"type\":\"uint256\"},{\"name\":\"owner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserPower\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"hasInitMartial\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"currentSmartSpeedNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"currentLuckyStoneNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"userAttackMonsterCDSeconds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCanAttackMonsterIds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"approvedOfItem\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"wuxiaMasterPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"martialId\",\"type\":\"uint256\"}],\"name\":\"getMartialCardTypeIdList\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lotteryPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"lotteryGiveHuntMinimalNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getMartialOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"masterTotalEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalUserNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"userAddress\",\"type\":\"address\"}],\"name\":\"userHasLuckyStone\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"hasInitCard2\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"disableLotteryGiveHunt\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxPowerUserAddress\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalEarning\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"stepPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"hasInitCard1\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserLastFreeLotteryTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"currentHunterNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"produceUnitSeconds\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"mapUserLotteryNumber\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_itemId\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"Bought\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_itemId\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"Sold\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"_approved\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_tokenId\",\"type\":\"uint256\"}],\"name\":\"Approval\",\"type\":\"event\"}]","ContractName":"EthWuxia","CompilerVersion":"v0.4.21+commit.dfe3193c","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://cd242fc891417052525c2dbf8547b62439d6b3a8059afe8b9c44e491d038d4cb"}]}