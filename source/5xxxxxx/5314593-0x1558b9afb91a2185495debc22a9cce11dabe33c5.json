{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.18;\r\n\r\ncontract TittyBase {\r\n\r\n    event Transfer(address indexed from, address indexed to);\r\n    event Creation(address indexed from, uint256 tittyId, uint256 wpId);\r\n    event AddAccessory(uint256 tittyId, uint256 accessoryId);\r\n\r\n    struct Accessory {\r\n\r\n        uint256 id;\r\n        string name;\r\n        uint256 price;\r\n        bool isActive;\r\n\r\n    }\r\n\r\n    struct Titty {\r\n\r\n        uint256 id;\r\n        string name;\r\n        string gender;\r\n        uint256 originalPrice;\r\n        uint256 salePrice;\r\n        uint256[] accessories;\r\n        bool forSale;\r\n    }\r\n\r\n    //Storage\r\n    Titty[] Titties;\r\n    Accessory[] Accessories;\r\n    mapping (uint256 => address) public tittyIndexToOwner;\r\n    mapping (address => uint256) public ownerTittiesCount;\r\n    mapping (uint256 => address) public tittyApproveIndex;\r\n\r\n    function _transfer(address _from, address _to, uint256 _tittyId) internal {\r\n\r\n        ownerTittiesCount[_to]++;\r\n\r\n        tittyIndexToOwner[_tittyId] = _to;\r\n        if (_from != address(0)) {\r\n            ownerTittiesCount[_from]--;\r\n            delete tittyApproveIndex[_tittyId];\r\n        }\r\n\r\n        Transfer(_from, _to);\r\n\r\n    }\r\n\r\n    function _changeTittyPrice (uint256 _newPrice, uint256 _tittyId) internal {\r\n\r\n        require(tittyIndexToOwner[_tittyId] == msg.sender);\r\n        Titty storage _titty = Titties[_tittyId];\r\n        _titty.salePrice = _newPrice;\r\n\r\n        Titties[_tittyId] = _titty;\r\n    }\r\n\r\n    function _setTittyForSale (bool _forSale, uint256 _tittyId) internal {\r\n\r\n        require(tittyIndexToOwner[_tittyId] == msg.sender);\r\n        Titty storage _titty = Titties[_tittyId];\r\n        _titty.forSale = _forSale;\r\n\r\n        Titties[_tittyId] = _titty;\r\n    }\r\n\r\n    function _changeName (string _name, uint256 _tittyId) internal {\r\n\r\n        require(tittyIndexToOwner[_tittyId] == msg.sender);\r\n        Titty storage _titty = Titties[_tittyId];\r\n        _titty.name = _name;\r\n\r\n        Titties[_tittyId] = _titty;\r\n    }\r\n\r\n    function addAccessory (uint256 _id, string _name, uint256 _price, uint256 tittyId ) internal returns (uint) {\r\n\r\n        Accessory memory _accessory = Accessory({\r\n\r\n            id: _id,\r\n            name: _name,\r\n            price: _price,\r\n            isActive: true\r\n\r\n        });\r\n\r\n        Titty storage titty = Titties[tittyId];\r\n        uint256 newAccessoryId = Accessories.push(_accessory) - 1;\r\n        titty.accessories.push(newAccessoryId);\r\n        AddAccessory(tittyId, newAccessoryId);\r\n\r\n        return newAccessoryId;\r\n\r\n    }\r\n\r\n    function totalAccessories(uint256 _tittyId) public view returns (uint256) {\r\n\r\n        Titty storage titty = Titties[_tittyId];\r\n        return titty.accessories.length;\r\n\r\n    }\r\n\r\n    function getAccessory(uint256 _tittyId, uint256 _aId) public view returns (uint256 id, string name,  uint256 price, bool active) {\r\n\r\n        Titty storage titty = Titties[_tittyId];\r\n        uint256 accId = titty.accessories[_aId];\r\n        Accessory storage accessory = Accessories[accId];\r\n        id = accessory.id;\r\n        name = accessory.name;\r\n        price = accessory.price;\r\n        active = accessory.isActive;\r\n\r\n    }\r\n\r\n    function createTitty (uint256 _id, string _gender, uint256 _price, address _owner, string _name) internal returns (uint) {\r\n        \r\n        Titty memory _titty = Titty({\r\n            id: _id,\r\n            name: _name,\r\n            gender: _gender,\r\n            originalPrice: _price,\r\n            salePrice: _price,\r\n            accessories: new uint256[](0),\r\n            forSale: false\r\n        });\r\n\r\n        uint256 newTittyId = Titties.push(_titty) - 1;\r\n\r\n        Creation(\r\n            _owner,\r\n            newTittyId,\r\n            _id\r\n        );\r\n\r\n        _transfer(0, _owner, newTittyId);\r\n        return newTittyId;\r\n    }\r\n\r\n    \r\n\r\n}\r\n\r\n\r\n/// @title Interface for contracts conforming to ERC-721: Non-Fungible Tokens\r\n/// @author Dieter Shirley <dete@axiomzen.co> (https://github.com/dete)\r\ncontract ERC721 {\r\n    function implementsERC721() public pure returns (bool);\r\n    function totalSupply() public view returns (uint256 total);\r\n    function balanceOf(address _owner) public view returns (uint256 balance);\r\n    function ownerOf(uint256 _tokenId) public view returns (address owner);\r\n    function approve(address _to, uint256 _tokenId) public;\r\n    function transferFrom(address _from, address _to, uint256 _tokenId) public;\r\n    function transfer(address _to, uint256 _tokenId) public;\r\n    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);\r\n    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);\r\n\r\n    // Optional\r\n    // function name() public view returns (string name);\r\n    // function symbol() public view returns (string symbol);\r\n    // function tokenOfOwnerByIndex(address _owner, uint256 _index) external view returns (uint256 tokenId);\r\n    // function tokenMetadata(uint256 _tokenId) public view returns (string infoUrl);\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\ncontract TittyOwnership is TittyBase, ERC721 {\r\n\r\n    string public name = \"CryptoTittes\";\r\n    string public symbol = \"CT\";\r\n\r\n    function implementsERC721() public pure returns (bool) {\r\n        return true;\r\n    }\r\n\r\n    function _isOwner(address _user, uint256 _tittyId) internal view returns (bool) {\r\n        return tittyIndexToOwner[_tittyId] == _user;\r\n    }\r\n\r\n    function _approve(uint256 _tittyId, address _approved) internal {\r\n         tittyApproveIndex[_tittyId] = _approved; \r\n    }\r\n\r\n    function _approveFor(address _user, uint256 _tittyId) internal view returns (bool) {\r\n         return tittyApproveIndex[_tittyId] == _user; \r\n    }\r\n\r\n    function totalSupply() public view returns (uint256 total) {\r\n        return Titties.length - 1;\r\n    }\r\n\r\n    function balanceOf(address _owner) public view returns (uint256 balance) {\r\n        return ownerTittiesCount[_owner];\r\n    }\r\n    \r\n    function ownerOf(uint256 _tokenId) public view returns (address owner) {\r\n        owner = tittyIndexToOwner[_tokenId];\r\n        require(owner != address(0));\r\n    }\r\n\r\n    function approve(address _to, uint256 _tokenId) public {\r\n        require(_isOwner(msg.sender, _tokenId));\r\n        _approve(_tokenId, _to);\r\n        Approval(msg.sender, _to, _tokenId);\r\n    }\r\n\r\n    function transferFrom(address _from, address _to, uint256 _tokenId) public {\r\n        require(_approveFor(msg.sender, _tokenId));\r\n        require(_isOwner(_from, _tokenId));\r\n\r\n        _transfer(_from, _to, _tokenId);\r\n        \r\n\r\n    }\r\n    function transfer(address _to, uint256 _tokenId) public {\r\n        require(_to != address(0));\r\n        require(_isOwner(msg.sender, _tokenId));\r\n\r\n        _transfer(msg.sender, _to, _tokenId);\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\ncontract TittyPurchase is TittyOwnership {\r\n\r\n    address private wallet;\r\n    address private boat;\r\n\r\n    function TittyPurchase(address _wallet, address _boat) public {\r\n        wallet = _wallet;\r\n        boat = _boat;\r\n\r\n        createTitty(0, \"unissex\", 1000000000, address(0), \"genesis\");\r\n    }\r\n\r\n    function purchaseNew(uint256 _id, string _name, string _gender, uint256 _price) public payable {\r\n\r\n        if (msg.value == 0 && msg.value != _price)\r\n            revert();\r\n\r\n        uint256 boatFee = calculateBoatFee(msg.value);\r\n        createTitty(_id, _gender, _price, msg.sender, _name);\r\n        wallet.transfer(msg.value - boatFee);\r\n        boat.transfer(boatFee);\r\n\r\n    }\r\n\r\n    function purchaseExistent(uint256 _tittyId) public payable {\r\n\r\n        Titty storage titty = Titties[_tittyId];\r\n        uint256 fee = calculateFee(titty.salePrice);\r\n        if (msg.value == 0 && msg.value != titty.salePrice)\r\n            revert();\r\n        \r\n        uint256 val = msg.value - fee;\r\n        address owner = tittyIndexToOwner[_tittyId];\r\n        _approve(_tittyId, msg.sender);\r\n        transferFrom(owner, msg.sender, _tittyId);\r\n        owner.transfer(val);\r\n        wallet.transfer(fee);\r\n\r\n    }\r\n\r\n    function purchaseAccessory(uint256 _tittyId, uint256 _accId, string _name, uint256 _price) public payable {\r\n\r\n        if (msg.value == 0 && msg.value != _price)\r\n            revert();\r\n\r\n        wallet.transfer(msg.value);\r\n        addAccessory(_accId, _name, _price,  _tittyId);\r\n        \r\n        \r\n    }\r\n\r\n    function getAmountOfTitties() public view returns(uint) {\r\n        return Titties.length;\r\n    }\r\n\r\n    function getLatestId() public view returns (uint) {\r\n        return Titties.length - 1;\r\n    }\r\n\r\n    function getTittyByWpId(address _owner, uint256 _wpId) public view returns (bool own, uint256 tittyId) {\r\n        \r\n        for (uint256 i = 1; i<=totalSupply(); i++) {\r\n            Titty storage titty = Titties[i];\r\n            bool isOwner = _isOwner(_owner, i);\r\n            if (titty.id == _wpId && isOwner) {\r\n                return (true, i);\r\n            }\r\n        }\r\n        \r\n        return (false, 0);\r\n    }\r\n\r\n    function belongsTo(address _account, uint256 _tittyId) public view returns (bool) {\r\n        return _isOwner(_account, _tittyId);\r\n    }\r\n\r\n    function changePrice(uint256 _price, uint256 _tittyId) public {\r\n        _changeTittyPrice(_price, _tittyId);\r\n    }\r\n\r\n    function changeName(string _name, uint256 _tittyId) public {\r\n        _changeName(_name, _tittyId);\r\n    }\r\n\r\n    function makeItSellable(uint256 _tittyId) public {\r\n        _setTittyForSale(true, _tittyId);\r\n    }\r\n\r\n    function calculateFee (uint256 _price) internal pure returns(uint) {\r\n        return (_price * 10)/100;\r\n    }\r\n\r\n    function calculateBoatFee (uint256 _price) internal pure returns(uint) {\r\n        return (_price * 25)/100;\r\n    }\r\n\r\n    function() external {}\r\n\r\n    function getATitty(uint256 _tittyId)\r\n        public \r\n        view \r\n        returns (\r\n        uint256 id,\r\n        string name,\r\n        string gender,\r\n        uint256 originalPrice,\r\n        uint256 salePrice,\r\n        bool forSale\r\n        ) {\r\n\r\n            Titty storage titty = Titties[_tittyId];\r\n            id = titty.id;\r\n            name = titty.name;\r\n            gender = titty.gender;\r\n            originalPrice = titty.originalPrice;\r\n            salePrice = titty.salePrice;\r\n            forSale = titty.forSale;\r\n        }\r\n\r\n}\r\n\r\ncontract CTBoatGame {\r\n\r\n    address private wallet;\r\n    address private contractOwner;\r\n    uint endDate;\r\n\r\n    uint256 votePrice = 3 finney;\r\n\r\n    TittyPurchase public tittyContract;\r\n\r\n    struct Vote {\r\n        uint256 totalRaised;\r\n        uint256 votes;\r\n    }\r\n\r\n    Vote[] votes;\r\n    mapping (uint256 => uint256) public tittyVotes;\r\n\r\n    event Voted(uint voteId, uint titty);\r\n    \r\n    function CTBoatGame(address _wallet, address _tittyPurchaseAddress, uint _endDate) public {\r\n        wallet = _wallet;\r\n        contractOwner = msg.sender;\r\n        endDate = _endDate;\r\n        tittyContract = TittyPurchase(_tittyPurchaseAddress);\r\n        \r\n        \r\n    }\r\n\r\n    function doVote (uint256 _tittyId, uint256 _amount) public payable {\r\n\r\n        require (now < endDate);\r\n        \r\n        uint256 total = calculatePrice(_amount);\r\n        if (msg.value < 0 || msg.value != total)\r\n            revert();\r\n\r\n        uint256 voteId = tittyVotes[_tittyId];\r\n        if (voteId == 0) {\r\n            voteId = _createVote(_tittyId, _amount, total);\r\n            tittyVotes[_tittyId] = voteId;\r\n        } else {\r\n            Vote storage vote = votes[voteId];\r\n            _addVote(vote, voteId, _amount, total);\r\n        }\r\n\r\n        Voted(voteId, _tittyId);\r\n        \r\n        address ownerAddress = tittyContract.ownerOf(_tittyId);\r\n\r\n        uint256 charityFee = calculateCharityFee(msg.value);\r\n        uint256 ownerFee = calculateOwnerFee(msg.value);\r\n        ownerAddress.transfer(ownerFee);\r\n        wallet.transfer(msg.value - (charityFee + ownerFee));\r\n\r\n    }\r\n\r\n    function transferToCharity(address _charity) public {\r\n        \r\n        require(msg.sender == contractOwner);\r\n        _charity.transfer(this.balance);\r\n\r\n    }\r\n\r\n    function calculatePrice(uint256 _amount) internal view returns (uint) {\r\n        return votePrice * _amount;\r\n    }\r\n\r\n    function getOwner(uint256 id) public view returns (address owner) {\r\n        owner = tittyContract.ownerOf(id);\r\n    }\r\n\r\n    function _createVote (uint256 _tittyId, uint256 _amount, uint256 _value) internal returns (uint) {\r\n\r\n        Vote memory newVote = Vote({\r\n            totalRaised: _value,\r\n            votes: _amount\r\n        });\r\n\r\n        uint256 voteId = votes.push(newVote) - 1;\r\n        tittyVotes[_tittyId] = voteId;\r\n\r\n        return voteId;\r\n    }\r\n\r\n    function _addVote (Vote vote, uint256 voteId, uint256 _amount, uint256 _value) internal {\r\n\r\n        vote.totalRaised = vote.totalRaised + _value;\r\n        vote.votes = vote.votes + _amount;\r\n        votes[voteId] = vote;\r\n\r\n    }\r\n\r\n    function getNumberOfVotes (uint256 _tittyId) public view returns (uint256, uint256) {\r\n\r\n        uint256 voteId = tittyVotes[_tittyId];\r\n        Vote storage vote = votes[voteId];\r\n\r\n        return (vote.votes, vote.totalRaised);\r\n\r\n    }\r\n\r\n    function calculateCharityFee (uint256 _price) internal pure returns(uint) {\r\n        return (_price * 70)/100;\r\n    }\r\n    \r\n    function calculateOwnerFee (uint256 _price) internal pure returns(uint) {\r\n        return (_price * 25)/100;\r\n    }\r\n\r\n    function() external {}\r\n\r\n\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"tittyContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"tittyVotes\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_tittyId\",\"type\":\"uint256\"},{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"doVote\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"id\",\"type\":\"uint256\"}],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"owner\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_tittyId\",\"type\":\"uint256\"}],\"name\":\"getNumberOfVotes\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_charity\",\"type\":\"address\"}],\"name\":\"transferToCharity\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_wallet\",\"type\":\"address\"},{\"name\":\"_tittyPurchaseAddress\",\"type\":\"address\"},{\"name\":\"_endDate\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"voteId\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"titty\",\"type\":\"uint256\"}],\"name\":\"Voted\",\"type\":\"event\"}]","ContractName":"CTBoatGame","CompilerVersion":"v0.4.21+commit.dfe3193c","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"0000000000000000000000000ad5fe68345484f2e37a20854361243d005febb8000000000000000000000000b39d10435d7d0f2ea26a1c86c42be0fd8a94f59b000000000000000000000000000000000000000000000000000000005b2871af","Library":"","SwarmSource":"bzzr://2fd7499f923d9b00e8ad6b330e067f768a178b14840425166157b110be1d005c"}]}