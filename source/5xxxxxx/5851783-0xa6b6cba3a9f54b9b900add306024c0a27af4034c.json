{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.24;\r\n\r\n/*\r\n\r\n    Copyright 2018, Angelo A. M. & Vicent Nos & Mireia Puig\r\n\r\n    This program is free software: you can redistribute it and/or modify\r\n    it under the terms of the GNU General Public License as published by\r\n    the Free Software Foundation, either version 3 of the License, or\r\n    (at your option) any later version.\r\n\r\n    This program is distributed in the hope that it will be useful,\r\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n    GNU General Public License for more details.\r\n\r\n    You should have received a copy of the GNU General Public License\r\n    along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n*/\r\n\r\n\r\n\r\nlibrary SafeMath {\r\n    function mul(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        if (a == 0) {\r\n            return 0;\r\n        }\r\n        uint256 c = a * b;\r\n        assert(c / a == b);\r\n        return c;\r\n    }\r\n\r\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        // assert(b > 0); // Solidity automatically throws when dividing by 0\r\n        uint256 c = a / b;\r\n        // assert(a == b * c + a % b); // There is no case in which this doesn't hold\r\n        return c;\r\n    }\r\n\r\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        assert(b <= a);\r\n        return a - b;\r\n    }\r\n\r\n    function add(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        uint256 c = a + b;\r\n        assert(c >= a);\r\n        return c;\r\n    }\r\n}\r\n\r\n\r\n\r\ncontract Ownable {\r\n\r\n    address public owner;\r\n\r\n    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\r\n\r\n    constructor() internal {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner);\r\n        _;\r\n    }\r\n\r\n    function transferOwnership(address newOwner) public onlyOwner {\r\n        require(newOwner != address(0));\r\n        emit OwnershipTransferred(owner, newOwner);\r\n        owner = newOwner;\r\n    }\r\n}\r\n\r\n\r\n\r\n////////////////////////////////////////////////////////\r\n//:                                                  ://\r\n//:            ESSENTIA Public Engagement            ://\r\n//:               https://essentia.one               ://\r\n//:..................................................://\r\n////////////////////////////////////////////////////////\r\n\r\n\r\n\r\n\r\ncontract TokenCHK {\r\n\r\n  function balanceOf(address _owner) public pure returns (uint256 balance) {}\r\n\r\n}\r\n\r\n\r\n\r\n\r\ncontract ESSENTIA_PE is Ownable {\r\n\r\n    using SafeMath for uint256;\r\n\r\n    string public name = \"ESSENTIA Public Engagement\";      // Extended name of this contract\r\n    uint256 public tokenPrice = 0;        // Set the fixed ESS token price\r\n    uint256 public maxCap = 0;            // Set the target maximum cap in ETH\r\n    address public FWDaddrETH;            // Set the address to forward the received ETH to\r\n    address public ESSgenesis;            // Set the ESSENTIA Genesis contract address\r\n    uint256 public totalSold;             // Keep track of the contributions total\r\n    uint256 public decimals = 18;         // The decimals to consider\r\n\r\n    mapping (address => uint256) public sold;       // Map the ESS token allcations\r\n\r\n    uint256 public pubEnd = 0;                      // Set the unixtime END for the public engagement\r\n    address contractAddr=this;                      // Better way to point to this from this\r\n\r\n    // Constant to simplify the conversion of token amounts into integer form\r\n    uint256 public tokenUnit = uint256(10)**decimals;\r\n\r\n    TokenCHK essToken;\r\n\r\n\r\n    //\r\n    // \"toETHaddr\" is the address to which the ETH contributions are forwarded to, aka FWDaddrETH\r\n    // \"addrESSgenesis\" is the address of the Essentia ERC20 token contract, aka ESSgenesis\r\n    //\r\n    // NOTE: this contract will sell only its token balance on the ERC20 specified in addrESSgenesis\r\n    //       the maxCap in ETH and the tokenPrice will indirectly set the ESS token amount on sale\r\n    //\r\n    // NOTE: this contract should have sufficient ESS token balance to be > maxCap / tokenPrice\r\n    //\r\n    // NOTE: this contract will stop REGARDLESS of the above (maxCap) when its token balance is all sold\r\n    //\r\n    // The Owner of this contract can set: Price, End, MaxCap, ESS Genesis and ETH Forward address\r\n    //\r\n    // The received ETH are directly forwarded to the external FWDaddrETH address\r\n    // The ESS tokens are transferred to the contributing addresses once withdrawPUB is executed\r\n    //\r\n\r\n\r\n    constructor\r\n        (\r\n        address toETHaddr,\r\n        address addrESSgenesis\r\n        ) public {\r\n        FWDaddrETH = toETHaddr;\r\n        ESSgenesis = addrESSgenesis;\r\n        essToken = TokenCHK(addrESSgenesis);\r\n    }\r\n\r\n\r\n\r\n    function () public payable {\r\n        buy();               // Allow to buy tokens sending ETH directly to the contract, fallback\r\n    }\r\n\r\n\r\n\r\n\r\n    function setFWDaddrETH(address _value) public onlyOwner{\r\n      FWDaddrETH=_value;     // Set the forward address default toETHaddr\r\n\r\n    }\r\n\r\n\r\n    function setGenesis(address _value) public onlyOwner{\r\n      ESSgenesis=_value;     // Set the ESS erc20 genesis contract address default ESSgenesis\r\n\r\n    }\r\n\r\n\r\n    function setMaxCap(uint256 _value) public onlyOwner{\r\n      maxCap=_value;         // Set the max cap in ETH default 0\r\n\r\n    }\r\n\r\n\r\n    function setPrice(uint256 _value) public onlyOwner{\r\n      tokenPrice=_value;     // Set the token price default 0\r\n\r\n    }\r\n\r\n\r\n    function setPubEnd(uint256 _value) public onlyOwner{\r\n      pubEnd=_value;         // Set the END of the public engagement unixtime default 0\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    function buy() public payable {\r\n\r\n        require(block.timestamp < pubEnd);          // Require the current unixtime to be lower than the END unixtime\r\n        require(msg.value > 0);                     // Require the sender to send an ETH tx higher than 0\r\n\r\n        // Requiring this to avoid going out of tokens, aka we are getting just true/false from the transfer call\r\n        require(msg.value + totalSold <= maxCap);\r\n\r\n        // Calculate the amount of tokens per contribution\r\n        uint256 tokenAmount = (msg.value * tokenUnit) / tokenPrice;\r\n\r\n        // Requiring sufficient token balance on this contract to accept the tx\r\n        require(tokenAmount <= essToken.balanceOf(this));\r\n\r\n        transferBuy(msg.sender, tokenAmount);       // Instruct the accounting function\r\n        totalSold = totalSold.add(msg.value);       // Account for the total contributed/sold\r\n        FWDaddrETH.transfer(msg.value);             // Forward the ETH received to the external address\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    function withdrawPUB() public returns(bool){\r\n\r\n        require(block.timestamp > pubEnd);          // Require the PE to be over - actual time higher than end unixtime\r\n        require(sold[msg.sender] > 0);              // Require the ESS token balance to be sent to be higher than 0\r\n\r\n        // Send ESS tokens to the contributors proportionally to their contribution/s\r\n        if(!ESSgenesis.call(bytes4(keccak256(\"transfer(address,uint256)\")), msg.sender, sold[msg.sender])){revert();}\r\n\r\n        delete sold[msg.sender];\r\n        return true;\r\n\r\n    }\r\n\r\n\r\n\r\n\r\n    function transferBuy(address _to, uint256 _value) internal returns (bool) {\r\n\r\n        require(_to != address(0));                 // Require the destination address being non-zero\r\n\r\n        sold[_to]=sold[_to].add(_value);            // Account for multiple txs from the same address\r\n\r\n        return true;\r\n\r\n    }\r\n\r\n\r\n\r\n        //\r\n        // Probably the sky would fall down first but, in case skynet feels funny..\r\n        // ..we try to make sure anyway that no ETH would get stuck in this contract\r\n        //\r\n    function EMGwithdraw(uint256 weiValue) external onlyOwner {\r\n        require(block.timestamp > pubEnd);          // Require the public engagement to be over\r\n        require(weiValue > 0);                      // Require a non-zero value\r\n\r\n        FWDaddrETH.transfer(weiValue);              // Transfer to the external ETH forward address\r\n    }\r\n\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxCap\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pubEnd\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"decimals\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"address\"}],\"name\":\"setFWDaddrETH\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"setPubEnd\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"setMaxCap\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"totalSold\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"setPrice\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"weiValue\",\"type\":\"uint256\"}],\"name\":\"EMGwithdraw\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buy\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ESSgenesis\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"sold\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FWDaddrETH\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdrawPUB\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenUnit\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"address\"}],\"name\":\"setGenesis\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"toETHaddr\",\"type\":\"address\"},{\"name\":\"addrESSgenesis\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"}]","ContractName":"ESSENTIA_PE","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"000000000000000000000000b33532656433f4eca3782f6b20298d1424d1f2cf000000000000000000000000fc05987bd2be489accf0f509e44b0145d68240f7","Library":"","SwarmSource":"bzzr://bb1aa481845c808e992bd3087cf6efb7ef48194aa99e4837d27596a5366202c6"}]}