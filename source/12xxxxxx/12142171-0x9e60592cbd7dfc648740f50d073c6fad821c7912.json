{"status":"1","message":"OK","result":[{"SourceCode":"{{\r\n  \"language\": \"Solidity\",\r\n  \"sources\": {\r\n    \"contracts/protocol/integration/SynthetixExchangeAdapter.sol\": {\r\n      \"content\": \"/*\\n    Copyright 2021 Set Labs Inc.\\n\\n    Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n    you may not use this file except in compliance with the License.\\n    You may obtain a copy of the License at\\n\\n    http://www.apache.org/licenses/LICENSE-2.0\\n\\n    Unless required by applicable law or agreed to in writing, software\\n    distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n    See the License for the specific language governing permissions and\\n    limitations under the License.\\n\\n    SPDX-License-Identifier: Apache License, Version 2.0\\n*/\\n\\npragma solidity 0.6.10;\\npragma experimental \\\"ABIEncoderV2\\\";\\n\\nimport { ISynth } from \\\"../../interfaces/external/ISynth.sol\\\";\\nimport { ISynthetixExchanger } from \\\"../../interfaces/external/ISynthetixExchanger.sol\\\";\\n\\n/**\\n * @title SynthetixTradeAdapter\\n * @author Set Protocol\\n *\\n * Exchange adapter for Synthetix that returns data for trades\\n */\\ncontract SynthetixExchangeAdapter {\\n\\n    /* ============ Structs ============ */\\n\\n    /**\\n     * Struct containing information for trade function\\n     */\\n    struct SynthetixTradeInfo {\\n        bytes32 sourceCurrencyKey;        // Currency key of the token to send\\n        bytes32 destinationCurrencyKey;   // Currency key the token to receive\\n    }\\n\\n    /* ============ State Variables ============ */\\n\\n    // Address of Synthetix's Exchanger contract\\n    address public immutable synthetixExchangerAddress;\\n\\n    /* ============ Constructor ============ */\\n\\n    /**\\n     * Set state variables\\n     *\\n     * @param _synthetixExchangerAddress    Address of Synthetix's Exchanger contract\\n     */\\n    constructor(address _synthetixExchangerAddress) public {\\n        synthetixExchangerAddress = _synthetixExchangerAddress;\\n    }\\n\\n    /* ============ External Getter Functions ============ */\\n\\n    /**\\n     * Calculate Synthetix trade encoded calldata. To be invoked on the SetToken.\\n     *\\n     * @param  _sourceToken              Address of source token to be sold\\n     * @param  _destinationToken         Address of destination token to buy\\n     * @param  _destinationAddress       Address to receive traded tokens\\n     * @param  _sourceQuantity           Amount of source token to sell\\n     *\\n     * @return address                   Target address\\n     * @return uint256                   Call value\\n     * @return bytes                     Trade calldata\\n     */\\n    function getTradeCalldata(\\n        address _sourceToken,\\n        address _destinationToken,\\n        address _destinationAddress,\\n        uint256 _sourceQuantity,\\n        uint256 /* _minDestinationQuantity */,\\n        bytes calldata /* _data */\\n    )\\n        external\\n        view\\n        returns (address, uint256, bytes memory)\\n    {\\n        SynthetixTradeInfo memory synthetixTradeInfo;\\n\\n        require(\\n            _sourceToken != _destinationToken,\\n            \\\"Source token cannot be same as destination token\\\"\\n        );\\n\\n        synthetixTradeInfo.sourceCurrencyKey = _getCurrencyKey(_sourceToken);\\n        synthetixTradeInfo.destinationCurrencyKey = _getCurrencyKey(_destinationToken);\\n\\n        // Encode method data for SetToken to invoke\\n        bytes memory methodData = abi.encodeWithSignature(\\n            \\\"exchange(address,bytes32,uint256,bytes32,address)\\\",\\n            _destinationAddress,\\n            synthetixTradeInfo.sourceCurrencyKey,\\n            _sourceQuantity,\\n            synthetixTradeInfo.destinationCurrencyKey,\\n            _destinationAddress\\n        );\\n\\n        return (synthetixExchangerAddress, 0, methodData);\\n    }\\n\\n    /**\\n     * Returns the Synthetix contract address.\\n     * There is no need to approve to SNX as its a proxy\\n     *\\n     * @return address\\n     */\\n    function getSpender()\\n        external\\n        view\\n        returns (address)\\n    {\\n        return synthetixExchangerAddress;\\n    }\\n\\n    /**\\n     * Returns the amount of destination token received for exchanging a quantity of\\n     * source token, less fees.\\n     *\\n     * @param  _sourceToken        Address of source token to be sold\\n     * @param  _destinationToken   Address of destination token to buy\\n     * @param  _sourceQuantity     Amount of source token to sell\\n     *\\n     * @return amountReceived      Amount of source token received for exchange\\n     */\\n    function getAmountReceivedForExchange(\\n        address _sourceToken,\\n        address _destinationToken,\\n        uint256 _sourceQuantity\\n    )\\n        external\\n        view\\n        returns (uint256 amountReceived)\\n    {\\n        SynthetixTradeInfo memory synthetixTradeInfo;\\n\\n        synthetixTradeInfo.sourceCurrencyKey = _getCurrencyKey(_sourceToken);\\n        synthetixTradeInfo.destinationCurrencyKey = _getCurrencyKey(_destinationToken);\\n\\n        (amountReceived,,) = ISynthetixExchanger(synthetixExchangerAddress).getAmountsForExchange(\\n            _sourceQuantity,\\n            synthetixTradeInfo.sourceCurrencyKey,\\n            synthetixTradeInfo.destinationCurrencyKey\\n        );\\n    }\\n\\n    /* ============ Internal Functions ============ */\\n\\n    /**\\n     * Gets the Synthetix currency key for _token\\n     *\\n     * @param _token  Address of token to get currency key for\\n     */\\n    function _getCurrencyKey(address _token) internal view returns (bytes32) {\\n\\n        try ISynth(_token).currencyKey() returns (bytes32 key){\\n\\n            return key;\\n\\n        } catch (bytes memory /* data */) {\\n\\n            revert(\\\"Invalid Synth token address\\\");\\n        }\\n    }\\n}\\n\"\r\n    },\r\n    \"contracts/interfaces/external/ISynth.sol\": {\r\n      \"content\": \"/*\\n    Copyright 2021 Set Labs Inc.\\n\\n    Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n    you may not use this file except in compliance with the License.\\n    You may obtain a copy of the License at\\n\\n    http://www.apache.org/licenses/LICENSE-2.0\\n\\n    Unless required by applicable law or agreed to in writing, software\\n    distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n    See the License for the specific language governing permissions and\\n    limitations under the License.\\n\\n    SPDX-License-Identifier: Apache License, Version 2.0\\n*/\\n\\npragma solidity 0.6.10;\\n\\n// https://docs.synthetix.io/contracts/source/interfaces/isynth\\ninterface ISynth {\\n    function currencyKey() external view returns (bytes32);\\n}\\n\"\r\n    },\r\n    \"contracts/interfaces/external/ISynthetixExchanger.sol\": {\r\n      \"content\": \"/*\\n    Copyright 2021 Set Labs Inc.\\n\\n    Licensed under the Apache License, Version 2.0 (the \\\"License\\\");\\n    you may not use this file except in compliance with the License.\\n    You may obtain a copy of the License at\\n\\n    http://www.apache.org/licenses/LICENSE-2.0\\n\\n    Unless required by applicable law or agreed to in writing, software\\n    distributed under the License is distributed on an \\\"AS IS\\\" BASIS,\\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\\n    See the License for the specific language governing permissions and\\n    limitations under the License.\\n\\n    SPDX-License-Identifier: Apache License, Version 2.0\\n*/\\n\\npragma solidity 0.6.10;\\n\\n// https://docs.synthetix.io/contracts/source/interfaces/iExchanger\\ninterface ISynthetixExchanger {\\n    function getAmountsForExchange(\\n        uint sourceAmount,\\n        bytes32 sourceCurrencyKey,\\n        bytes32 destinationCurrencyKey\\n    )\\n        external\\n        view\\n        returns (\\n            uint amountReceived,\\n            uint fee,\\n            uint exchangeFeeRate\\n        );\\n\\n    function exchange(\\n        address from,\\n        bytes32 sourceCurrencyKey,\\n        uint sourceAmount,\\n        bytes32 destinationCurrencyKey,\\n        address destinationAddress\\n    ) external returns (uint amountReceived);\\n}\\n\"\r\n    }\r\n  },\r\n  \"settings\": {\r\n    \"optimizer\": {\r\n      \"enabled\": true,\r\n      \"runs\": 200\r\n    },\r\n    \"outputSelection\": {\r\n      \"*\": {\r\n        \"*\": [\r\n          \"evm.bytecode\",\r\n          \"evm.deployedBytecode\",\r\n          \"abi\"\r\n        ]\r\n      }\r\n    },\r\n    \"metadata\": {\r\n      \"useLiteralContent\": true\r\n    },\r\n    \"libraries\": {}\r\n  }\r\n}}","ABI":"[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_synthetixExchangerAddress\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_sourceToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_destinationToken\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_sourceQuantity\",\"type\":\"uint256\"}],\"name\":\"getAmountReceivedForExchange\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"amountReceived\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getSpender\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_sourceToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_destinationToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_destinationAddress\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_sourceQuantity\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"\",\"type\":\"bytes\"}],\"name\":\"getTradeCalldata\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"},{\"internalType\":\"bytes\",\"name\":\"\",\"type\":\"bytes\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"synthetixExchangerAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"SynthetixExchangeAdapter","CompilerVersion":"v0.6.10+commit.00c0fcaf","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"0000000000000000000000000bfdc04b38251394542586969e2356d0d731f7de","EVMVersion":"Default","Library":"","LicenseType":"","Proxy":"0","Implementation":"","SwarmSource":""}]}