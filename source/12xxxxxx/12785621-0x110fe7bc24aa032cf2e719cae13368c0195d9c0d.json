{"status":"1","message":"OK","result":[{"SourceCode":"// SPDX-License-Identifier: AGPL-3.0-only\r\npragma solidity >=0.7.0;\r\npragma experimental ABIEncoderV2;\r\n\r\n// New Silver 2 addresses at Wed Jul  7 16:08:49 WEST 2021\r\ncontract Addresses {\r\n\taddress constant public ACTIONS = 0x80F33ED0A69935dd74310b9D0009D0BA647Cf223;\r\n\taddress constant public AO_REWARD_RECIPIENT = 0x7Cae9bD865610750a48575aF15CAFe1e460c96a8;\r\n\taddress constant public ASSESSOR = 0x83E2369A33104120746B589Cc90180ed776fFb91;\r\n\taddress constant public ASSESSOR_ADMIN = 0x46470030e1c732A9C2b541189471E47661311375;\r\n\taddress constant public CLERK = 0xA9eCF012dD36512e5fFCD5585D72386E46135Cdd;\r\n\taddress constant public COLLECTOR = 0x62f290512c690a817f47D2a4a544A5d48D1408BE;\r\n\taddress constant public COORDINATOR = 0xcC7AFB5DeED34CF67E72d4C53B142F44c9268ab9;\r\n\taddress constant public FEED = 0x41fAD1Eb242De19dA0206B0468763333BB6C2B3D;\r\n\taddress constant public JUNIOR_MEMBERLIST = 0x42C2483EEE8c1Fe46C398Ac296C59674F9eb88CD;\r\n\taddress constant public JUNIOR_OPERATOR = 0x4c4Cc6a0573db5823ECAA1d1d65EB64E5E0E5F01;\r\n\taddress constant public JUNIOR_TOKEN = 0x961e1d4c9A7C0C3e05F17285f5FA34A66b62dBb1;\r\n\taddress constant public JUNIOR_TRANCHE = 0x53CF3CCd97CA914F9e441B8cd9A901E69B170f27;\r\n\taddress constant public MAKER_MGR = 0x2474F297214E5d96Ba4C81986A9F0e5C260f445D;\r\n\taddress constant public MCD_JUG = 0x19c0976f590D67707E62397C87829d896Dc0f1F1;\r\n\taddress constant public MCD_VAT = 0x35D1b3F3D7966A1DFe207aa4514C12a259A0492B;\r\n\taddress constant public PILE = 0x3eC5c16E7f2C6A80E31997C68D8Fa6ACe089807f;\r\n\taddress constant public POOL_ADMIN = 0xd7fb14d5C1259a47d46D156E74a9c3B69a147b4A;\r\n\taddress constant public PROXY_REGISTRY = 0xC9045c815bF123ad12EA75b9A7c579C1e05051f9;\r\n\taddress constant public RESERVE = 0x1f5Fa2E665609CE4953C65CE532Ac8B47EC97cD5;\r\n\taddress constant public ROOT_CONTRACT = 0x53b2d22d07E069a3b132BfeaaD275b10273d381E;\r\n\taddress constant public SENIOR_MEMBERLIST = 0x5B5CFD6E45F1407ABCb4BFD9947aBea1EA6649dA;\r\n\taddress constant public SENIOR_OPERATOR = 0x230f2E19D6c2Dc0c441c2150D4dD9d67B563A60C;\r\n\taddress constant public SENIOR_TOKEN = 0xE4C72b4dE5b0F9ACcEA880Ad0b1F944F85A9dAA0;\r\n\taddress constant public SENIOR_TRANCHE = 0x3f06DB6334435fF4150e14aD69F6280BF8E8dA64;\r\n\taddress constant public SHELF = 0x7d057A056939bb96D682336683C10EC89b78D7CE;\r\n\taddress constant public TINLAKE_CURRENCY = 0x6B175474E89094C44Da98b954EedeAC495271d0F;\r\n\taddress constant public TITLE = 0x07cdD617c53B07208b0371C93a02deB8d8D49C6e;  \r\n}\r\n\r\n\r\ninterface SpellTinlakeRootLike {\r\n    function relyContract(address, address) external;\r\n}\r\n\r\ninterface SpellMemberlistLike {\r\n    function updateMember(address, uint) external;\r\n}\r\n\r\ninterface SpellReserveLike {\r\n    function payout(uint currencyAmount) external;\r\n}\r\n\r\ninterface DependLike {\r\n    function depend(bytes32, address) external;\r\n}\r\n\r\ninterface FileLike {\r\n    function file(bytes32, uint) external;\r\n    function file(bytes32, address) external;\r\n}\r\n\r\ninterface AuthLike {\r\n    function rely(address) external;\r\n    function deny(address) external;\r\n}\r\n\r\ninterface MigrationLike {\r\n    function migrate(address) external;\r\n}\r\n\r\ninterface PoolAdminLike {\r\n    function relyAdmin(address) external;\r\n}\r\n\r\ninterface MgrLike {\r\n    function lock(uint) external;\r\n}\r\n\r\ninterface SpellERC20Like {\r\n    function balanceOf(address) external view returns (uint256);\r\n    function transferFrom(address, address, uint) external returns (bool);\r\n    function approve(address, uint) external;\r\n}\r\n\r\ninterface NAVFeedLike {\r\n    function file(bytes32, uint) external;\r\n    function discountRate() external view returns (uint256);\r\n}\r\n\r\ncontract TinlakeSpell is Addresses {\r\n\r\n    bool public done;\r\n    string constant public description = \"Tinlake coordinator migration mainnet spell\";\r\n\r\n    address constant public COORDINATOR_NEW = 0x22a1caca2EE82e9cE7Ef900FD961891b66deB7cA;\r\n\r\n    uint[4] discountRates = [1000000002243467782851344495, 1000000002108701166920345002, 1000000001973934550989345509, 1000000001839167935058346017];\r\n    uint[4] timestamps;\r\n    bool[4] rateAlreadySet = [false, false, false, false];\r\n    \r\n    // permissions to be set\r\n    function cast() public {\r\n        require(!done, \"spell-already-cast\");\r\n        done = true;\r\n        execute();\r\n    }\r\n\r\n    function execute() internal {\r\n        SpellTinlakeRootLike root = SpellTinlakeRootLike(ROOT_CONTRACT);\r\n\r\n        // set spell as ward on the core contract to be able to wire the new contracts correctly\r\n        root.relyContract(JUNIOR_TRANCHE, address(this));\r\n        root.relyContract(SENIOR_TRANCHE, address(this));\r\n        root.relyContract(ASSESSOR, address(this));\r\n        root.relyContract(RESERVE, address(this));\r\n        root.relyContract(COORDINATOR_NEW, address(this));\r\n        root.relyContract(CLERK, address(this));\r\n        root.relyContract(FEED, address(this));\r\n\r\n        // contract migration --> assumption: root contract is already ward on the new contracts\r\n        migrateCoordinator();\r\n\r\n        timestamps = [\r\n            block.timestamp + 0 days,\r\n            block.timestamp + 4 days,\r\n            block.timestamp + 8 days,\r\n            block.timestamp + 12 days\r\n        ];\r\n\r\n        setDiscount(0);\r\n    }\r\n\r\n    function migrateCoordinator() internal {\r\n        // migrate dependencies\r\n        DependLike(COORDINATOR_NEW).depend(\"assessor\", ASSESSOR);\r\n        DependLike(COORDINATOR_NEW).depend(\"juniorTranche\", JUNIOR_TRANCHE);\r\n        DependLike(COORDINATOR_NEW).depend(\"seniorTranche\", SENIOR_TRANCHE);\r\n        DependLike(COORDINATOR_NEW).depend(\"reserve\", RESERVE);\r\n        \r\n        DependLike(JUNIOR_TRANCHE).depend(\"epochTicker\", COORDINATOR_NEW);\r\n        DependLike(SENIOR_TRANCHE).depend(\"epochTicker\", COORDINATOR_NEW);\r\n        DependLike(CLERK).depend(\"coordinator\", COORDINATOR_NEW);\r\n\r\n        // migrate permissions\r\n        AuthLike(ASSESSOR).rely(COORDINATOR_NEW); \r\n        AuthLike(ASSESSOR).deny(COORDINATOR);\r\n        AuthLike(JUNIOR_TRANCHE).rely(COORDINATOR_NEW); \r\n        AuthLike(JUNIOR_TRANCHE).deny(COORDINATOR); \r\n        AuthLike(SENIOR_TRANCHE).rely(COORDINATOR_NEW);\r\n        AuthLike(SENIOR_TRANCHE).deny(COORDINATOR);\r\n\r\n        // migrate state\r\n        MigrationLike(COORDINATOR_NEW).migrate(COORDINATOR);\r\n    }\r\n\r\n    function setDiscount(uint i) public {\r\n        require(block.timestamp >= timestamps[i], \"not-yet-executable\");\r\n        require(i == 0 || NAVFeedLike(FEED).discountRate() == discountRates[i-1], \"incorrect-execution-order\");\r\n        require(rateAlreadySet[i] == false, \"already-executed\");\r\n\r\n        rateAlreadySet[i] = true;\r\n        NAVFeedLike(FEED).file(\"discountRate\", discountRates[i]);\r\n    }\r\n\r\n}","ABI":"[{\"inputs\":[],\"name\":\"ACTIONS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"AO_REWARD_RECIPIENT\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"ASSESSOR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"ASSESSOR_ADMIN\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"CLERK\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"COLLECTOR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"COORDINATOR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"COORDINATOR_NEW\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"FEED\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"JUNIOR_MEMBERLIST\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"JUNIOR_OPERATOR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"JUNIOR_TOKEN\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"JUNIOR_TRANCHE\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"MAKER_MGR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"MCD_JUG\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"MCD_VAT\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"PILE\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"POOL_ADMIN\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"PROXY_REGISTRY\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"RESERVE\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"ROOT_CONTRACT\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"SENIOR_MEMBERLIST\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"SENIOR_OPERATOR\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"SENIOR_TOKEN\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"SENIOR_TRANCHE\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"SHELF\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"TINLAKE_CURRENCY\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"TITLE\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"cast\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"description\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"done\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"i\",\"type\":\"uint256\"}],\"name\":\"setDiscount\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]","ContractName":"TinlakeSpell","CompilerVersion":"v0.7.6+commit.7338295f","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"None","Proxy":"0","Implementation":"","SwarmSource":"ipfs://7ac6b109751867ce9b244c0fa0b9798b8479d9dae4afd909cd28d9e586cbffc0"}]}