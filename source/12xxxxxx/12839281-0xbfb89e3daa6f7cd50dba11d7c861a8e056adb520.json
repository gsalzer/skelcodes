{"status":"1","message":"OK","result":[{"SourceCode":"// File: contracts\\farming\\util\\DFOHub.sol\r\n\r\n// SPDX-License-Identifier: MIT\r\n\r\npragma solidity ^0.7.6;\r\n\r\ninterface IDoubleProxy {\r\n    function proxy() external view returns (address);\r\n}\r\n\r\ninterface IMVDProxy {\r\n    function getMVDFunctionalitiesManagerAddress() external view returns(address);\r\n    function getMVDWalletAddress() external view returns (address);\r\n    function getStateHolderAddress() external view returns(address);\r\n    function submit(string calldata codeName, bytes calldata data) external payable returns(bytes memory returnData);\r\n}\r\n\r\ninterface IMVDFunctionalitiesManager {\r\n    function getFunctionalityData(string calldata codeName) external view returns(address, uint256, string memory, address, uint256);\r\n    function isAuthorizedFunctionality(address functionality) external view returns(bool);\r\n}\r\n\r\ninterface IStateHolder {\r\n    function getUint256(string calldata name) external view returns(uint256);\r\n    function getAddress(string calldata name) external view returns(address);\r\n    function clear(string calldata varName) external returns(string memory oldDataType, bytes memory oldVal);\r\n}\r\n\r\n// File: contracts\\farming\\IFarmFactory.sol\r\n\r\n//SPDX_License_Identifier: MIT\r\npragma solidity ^0.7.6;\r\n\r\ninterface IFarmFactory {\r\n\r\n    event ExtensionCloned(address indexed);\r\n\r\n    function feePercentageInfo() external view returns (uint256, address);\r\n    function farmDefaultExtension() external view returns(address);\r\n    function cloneFarmDefaultExtension() external returns(address);\r\n    function getFarmTokenCollectionURI() external view returns (string memory);\r\n    function getFarmTokenURI() external view returns (string memory);\r\n}\r\n\r\n// File: contracts\\farming\\FarmFactory.sol\r\n\r\n//SPDX_License_Identifier: MIT\r\npragma solidity ^0.7.6;\r\n\r\n\r\n\r\ncontract FarmFactory is IFarmFactory {\r\n\r\n    // farm contract implementation address\r\n    address public farmMainImplAddress;\r\n    // farming default extension\r\n    address public override farmDefaultExtension;\r\n    // double proxy address of the linked DFO\r\n    address public _doubleProxy;\r\n    // linked DFO exit fee\r\n    uint256 private _feePercentage;\r\n    // collection uri\r\n    string public farmTokenCollectionURI;\r\n    // farm token uri\r\n    string public farmTokenURI;\r\n\r\n    // event that tracks farm main contracts deployed\r\n    event FarmMainDeployed(address indexed farmMainAddress, address indexed sender, bytes initResultData);\r\n    // event that tracks logic contract address change\r\n    event FarmMainLogicSet(address indexed newAddress);\r\n    // event that tracks default extension contract address change\r\n    event FarmDefaultExtensionSet(address indexed newAddress);\r\n    // event that tracks wallet changes\r\n    event FeePercentageSet(uint256 newFeePercentage);\r\n\r\n    constructor(address doubleProxy, address _farmMainImplAddress, address _farmDefaultExtension, uint256 feePercentage, string memory farmTokenCollectionUri, string memory farmTokenUri) {\r\n        _doubleProxy = doubleProxy;\r\n        farmTokenCollectionURI = farmTokenCollectionUri;\r\n        farmTokenURI = farmTokenUri;\r\n        emit FarmMainLogicSet(farmMainImplAddress = _farmMainImplAddress);\r\n        emit FarmDefaultExtensionSet(farmDefaultExtension = _farmDefaultExtension);\r\n        emit FeePercentageSet(_feePercentage = feePercentage);\r\n    }\r\n\r\n    /** PUBLIC METHODS */\r\n\r\n    function feePercentageInfo() public override view returns (uint256, address) {\r\n        return (_feePercentage, IMVDProxy(IDoubleProxy(_doubleProxy).proxy()).getMVDWalletAddress());\r\n    }\r\n\r\n    /** @dev allows the DFO to update the double proxy address.\r\n      * @param newDoubleProxy new double proxy address.\r\n    */\r\n    function setDoubleProxy(address newDoubleProxy) public onlyDFO {\r\n        _doubleProxy = newDoubleProxy;\r\n    }\r\n\r\n    /** @dev change the fee percentage\r\n     * @param feePercentage new fee percentage.\r\n     */\r\n    function updateFeePercentage(uint256 feePercentage) public onlyDFO {\r\n        emit FeePercentageSet(_feePercentage = feePercentage);\r\n    }\r\n\r\n    /** @dev allows the factory owner to update the logic contract address.\r\n     * @param _implAddress new farm logic implementation address.\r\n     */\r\n    function updateLogicAddress(address _implAddress) public {\r\n        emit FarmMainLogicSet(farmMainImplAddress = _implAddress);\r\n    }\r\n\r\n    /** @dev allows the factory owner to update the default extension contract address.\r\n     * @param _farmDefaultExtensionAddress new farm extension address.\r\n     */\r\n    function updateDefaultExtensionAddress(address _farmDefaultExtensionAddress) public {\r\n        emit FarmDefaultExtensionSet(farmDefaultExtension = _farmDefaultExtensionAddress);\r\n    }\r\n\r\n    /** @dev allows the factory owner to update the farm token collection uri.\r\n     * @param farmTokenCollectionUri new farm token collection uri.\r\n     */\r\n    function updateFarmTokenCollectionURI(string memory farmTokenCollectionUri) public onlyDFO {\r\n        farmTokenCollectionURI = farmTokenCollectionUri;\r\n    }\r\n\r\n    /** @dev allows the factory owner to update the farm token uri.\r\n     * @param farmTokenUri new farm token collection uri.\r\n     */\r\n    function updateFarmTokenURI(string memory farmTokenUri) public onlyDFO {\r\n        farmTokenURI = farmTokenUri;\r\n    }\r\n\r\n    /** @dev returns the farm token collection uri.\r\n      * @return farm token collection uri.\r\n     */\r\n    function getFarmTokenCollectionURI() public override view returns (string memory) {\r\n        return farmTokenCollectionURI;\r\n    }\r\n\r\n    /** @dev returns the farm token uri.\r\n      * @return farm token uri.\r\n     */\r\n    function getFarmTokenURI() public override view returns (string memory) {\r\n        return farmTokenURI;\r\n    }\r\n\r\n    /** @dev utlity method to clone default extension\r\n     * @return clonedExtension the address of the actually-cloned farming extension\r\n     */\r\n    function cloneFarmDefaultExtension() public override returns(address clonedExtension) {\r\n        emit ExtensionCloned(clonedExtension = _clone(farmDefaultExtension));\r\n    }\r\n\r\n    /** @dev this function deploys a new Farming contract and calls the encoded function passed as data.\r\n     * @param data encoded initialize function for the farming contract (check Farming contract code).\r\n     * @return contractAddress new farming contract address.\r\n     * @return initResultData new farming contract call result.\r\n     */\r\n    function deploy(bytes memory data) public returns (address contractAddress, bytes memory initResultData) {\r\n        initResultData = _call(contractAddress = _clone(farmMainImplAddress), data);\r\n        emit FarmMainDeployed(contractAddress, msg.sender, initResultData);\r\n    }\r\n\r\n    /** PRIVATE METHODS */\r\n\r\n    /** @dev clones the input contract address and returns the copied contract address.\r\n     * @param original address of the original contract.\r\n     * @return copy copied contract address.\r\n     */\r\n    function _clone(address original) private returns (address copy) {\r\n        assembly {\r\n            mstore(\r\n                0,\r\n                or(\r\n                    0x5880730000000000000000000000000000000000000000803b80938091923cF3,\r\n                    mul(original, 0x1000000000000000000)\r\n                )\r\n            )\r\n            copy := create(0, 0, 32)\r\n            switch extcodesize(copy)\r\n                case 0 {\r\n                    invalid()\r\n                }\r\n        }\r\n    }\r\n\r\n    /** @dev calls the contract at the given location using the given payload and returns the returnData.\r\n      * @param location location to call.\r\n      * @param payload call payload.\r\n      * @return returnData call return data.\r\n     */\r\n    function _call(address location, bytes memory payload) private returns(bytes memory returnData) {\r\n        assembly {\r\n            let result := call(gas(), location, 0, add(payload, 0x20), mload(payload), 0, 0)\r\n            let size := returndatasize()\r\n            returnData := mload(0x40)\r\n            mstore(returnData, size)\r\n            let returnDataPayloadStart := add(returnData, 0x20)\r\n            returndatacopy(returnDataPayloadStart, 0, size)\r\n            mstore(0x40, add(returnDataPayloadStart, size))\r\n            switch result case 0 {revert(returnDataPayloadStart, size)}\r\n        }\r\n    }\r\n\r\n    /** @dev onlyDFO modifier used to check for unauthorized accesses. */\r\n    modifier onlyDFO() {\r\n        require(IMVDFunctionalitiesManager(IMVDProxy(IDoubleProxy(_doubleProxy).proxy()).getMVDFunctionalitiesManagerAddress()).isAuthorizedFunctionality(msg.sender), \"Unauthorized.\");\r\n        _;\r\n    }\r\n}","ABI":"[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"doubleProxy\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_farmMainImplAddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_farmDefaultExtension\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"feePercentage\",\"type\":\"uint256\"},{\"internalType\":\"string\",\"name\":\"farmTokenCollectionUri\",\"type\":\"string\"},{\"internalType\":\"string\",\"name\":\"farmTokenUri\",\"type\":\"string\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"ExtensionCloned\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newAddress\",\"type\":\"address\"}],\"name\":\"FarmDefaultExtensionSet\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"farmMainAddress\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"sender\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"bytes\",\"name\":\"initResultData\",\"type\":\"bytes\"}],\"name\":\"FarmMainDeployed\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newAddress\",\"type\":\"address\"}],\"name\":\"FarmMainLogicSet\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"newFeePercentage\",\"type\":\"uint256\"}],\"name\":\"FeePercentageSet\",\"type\":\"event\"},{\"inputs\":[],\"name\":\"_doubleProxy\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"cloneFarmDefaultExtension\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"clonedExtension\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes\",\"name\":\"data\",\"type\":\"bytes\"}],\"name\":\"deploy\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"contractAddress\",\"type\":\"address\"},{\"internalType\":\"bytes\",\"name\":\"initResultData\",\"type\":\"bytes\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"farmDefaultExtension\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"farmMainImplAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"farmTokenCollectionURI\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"farmTokenURI\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"feePercentageInfo\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getFarmTokenCollectionURI\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getFarmTokenURI\",\"outputs\":[{\"internalType\":\"string\",\"name\":\"\",\"type\":\"string\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"newDoubleProxy\",\"type\":\"address\"}],\"name\":\"setDoubleProxy\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_farmDefaultExtensionAddress\",\"type\":\"address\"}],\"name\":\"updateDefaultExtensionAddress\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"farmTokenCollectionUri\",\"type\":\"string\"}],\"name\":\"updateFarmTokenCollectionURI\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"string\",\"name\":\"farmTokenUri\",\"type\":\"string\"}],\"name\":\"updateFarmTokenURI\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"feePercentage\",\"type\":\"uint256\"}],\"name\":\"updateFeePercentage\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_implAddress\",\"type\":\"address\"}],\"name\":\"updateLogicAddress\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]","ContractName":"FarmFactory","CompilerVersion":"v0.7.6+commit.7338295f","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"000000000000000000000000f869538e3904778a0cb1ff620c8e83c7df36b946000000000000000000000000137399331d4b375f0dc23148c3d665129f7f63c5000000000000000000000000769055225057fb3c7ce4ea82585af438cea18275000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","EVMVersion":"Default","Library":"","LicenseType":"MIT","Proxy":"0","Implementation":"","SwarmSource":"ipfs://a0c7578e79963505b07583b540d8e85527f60e0489ff511c1c53b5a9342233f1"}]}