{"status":"1","message":"OK","result":[{"SourceCode":"// SPDX-License-Identifier: MIT\r\n\r\npragma solidity 0.8.2;\r\n\r\ninterface IERC20Token {\r\n    function transferFrom(address _from, address _to, uint256 _value) external returns (bool success);\r\n}\r\n\r\ninterface IERC721 {\r\n\r\n    function setPaymentDate(uint256 _asset) external;\r\n    function getTokenDetails(uint256 index) external view returns (uint32 aType, uint32 customDetails, uint32 lastTx, uint32 lastPayment, uint256 initialvalue, string memory coin);\r\n    function ownerOf(uint256 tokenId) external view returns (address owner);\r\n    function balanceOf(address _owner) external view returns (uint256);\r\n}\r\n\r\ncontract Ownable {\r\n\r\n    address private owner;\r\n    \r\n    event OwnerSet(address indexed oldOwner, address indexed newOwner);\r\n    \r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner, \"Caller is not owner\");\r\n        _;\r\n    }\r\n\r\n    constructor() {\r\n        owner = msg.sender; // 'msg.sender' is sender of current call, contract deployer for a constructor\r\n        emit OwnerSet(address(0), owner);\r\n    }\r\n\r\n\r\n    function changeOwner(address newOwner) public onlyOwner {\r\n        emit OwnerSet(owner, newOwner);\r\n        owner = newOwner;\r\n    }\r\n\r\n    function getOwner() external view returns (address) {\r\n        return owner;\r\n    }\r\n}\r\n\r\ncontract PolkaProfitContract is Ownable {\r\n    \r\n    event Payment(address indexed _from, uint256 _amount, uint8 network);\r\n    \r\n    bool public paused;\r\n\r\n    struct Claim {\r\n        address account;\r\n        uint8 dNetwork;  // 1= Ethereum   2= BSC\r\n        uint256 assetId;\r\n        uint256 amount;\r\n        uint256 date;\r\n    }\r\n    \r\n    Claim[] public payments;\r\n    \r\n    mapping (address => bool) public blackListed;\r\n    mapping (uint256 => uint256) public weeklyByType;\r\n    address public nftAddress = 0xB20217bf3d89667Fa15907971866acD6CcD570C8;\r\n    address public tokenAddress = 0xaA8330FB2B4D5D07ABFE7A72262752a8505C6B37;\r\n    address public walletAddress = 0xeA50CE6EBb1a5E4A8F90Bfb35A2fb3c3F0C673ec;\r\n    uint256 public gasFee = 1000000000000000;\r\n\r\n    uint256 wUnit = 1 weeks;\r\n    \r\n    constructor() {\r\n        weeklyByType[20] = 18 ether;\r\n        weeklyByType[22] = 4 ether;\r\n        \r\n        weeklyByType[23] = 3 ether;\r\n        weeklyByType[25] = 1041 ether;\r\n        weeklyByType[26] = 44 ether;\r\n        weeklyByType[29] = 3125 ether;\r\n        weeklyByType[30] = 29 ether;\r\n        weeklyByType[31] = 5 ether;\r\n        weeklyByType[32] = 20 ether;\r\n        weeklyByType[34] = 10 ether;\r\n        \r\n        weeklyByType[36] = 70 ether;\r\n        weeklyByType[37] = 105 ether;\r\n        weeklyByType[38] = 150 ether;\r\n        weeklyByType[39] = 600 ether;\r\n        weeklyByType[40] = 20 ether;\r\n    }\r\n    \r\n    function profitsPayment(uint256 _assetId) public returns (bool success) {\r\n        require(paused == false, \"Contract is paused\");\r\n        IERC721 nft = IERC721(nftAddress);\r\n        address assetOwner = nft.ownerOf(_assetId);\r\n        require(assetOwner == msg.sender, \"Only asset owner can claim profits\");\r\n        require(blackListed[assetOwner] == false, \"This address cannot claim profits\");\r\n        (uint256 totalPayment, ) = calcProfit(_assetId);\r\n        require (totalPayment > 0, \"You need to wait at least 1 week to claim\");\r\n        nft.setPaymentDate(_assetId);\r\n        IERC20Token token = IERC20Token(tokenAddress);\r\n        require(token.transferFrom(walletAddress, assetOwner, totalPayment), \"ERC20 transfer fail\");\r\n        Claim memory thisclaim = Claim(msg.sender, 1, _assetId, totalPayment, block.timestamp);\r\n        payments.push(thisclaim);\r\n        emit Payment(msg.sender, totalPayment, 1);\r\n        return true;\r\n    }\r\n    \r\n    function profitsPaymentBSC(uint256 _assetId) public payable returns (bool success) {\r\n        require(paused == false, \"Contract is paused\");\r\n        require(msg.value >= gasFee, \"Gas fee too low\");\r\n        IERC721 nft = IERC721(nftAddress);\r\n        address assetOwner = nft.ownerOf(_assetId);\r\n        require(assetOwner == msg.sender, \"Only asset owner can claim profits\");\r\n        require(blackListed[assetOwner] == false, \"This address cannot claim profits\");\r\n        (uint256 totalPayment, ) = calcProfit(_assetId);\r\n        require (totalPayment > 0, \"You need to wait at least 1 week to claim\");\r\n        nft.setPaymentDate(_assetId);\r\n        Claim memory thisclaim = Claim(msg.sender, 2, _assetId, totalPayment, block.timestamp);\r\n        payments.push(thisclaim);\r\n        emit Payment(msg.sender, totalPayment, 2);\r\n        return true;\r\n    }\r\n    \r\n    function calcProfit(uint256 _assetId) public view returns (uint256 _profit, uint256 _lastPayment) {\r\n        IERC721 nft = IERC721(nftAddress);\r\n        (uint32 assetType,, uint32 lastTransfer, uint32 lastPayment,, ) = nft.getTokenDetails(_assetId);\r\n        uint256 cTime = block.timestamp - lastTransfer;\r\n        uint256 dTime = 0;\r\n        if (lastTransfer < lastPayment) {\r\n            dTime = lastPayment - lastTransfer;\r\n        }\r\n        if ((cTime) < wUnit) { \r\n            return (0, lastTransfer);\r\n        } else {\r\n             uint256 weekCount;  \r\n            if (dTime == 0) {\r\n                weekCount = ((cTime)/(wUnit));\r\n            } else {\r\n                weekCount = ((cTime)/(wUnit)) - (dTime)/(wUnit);\r\n            }\r\n            if (weekCount < 1) {\r\n                return (0, lastPayment);\r\n            } else {\r\n                uint256 totalPayment;\r\n                totalPayment = ((weekCount * weeklyByType[assetType]));\r\n                return (totalPayment, lastPayment);  \r\n                \r\n            }\r\n        }\r\n    }\r\n    \r\n    function calcTotalEarnings(uint256 _assetId) public view returns (uint256 _profit, uint256 _lastPayment) {\r\n        IERC721 nft = IERC721(nftAddress);\r\n        (uint32 assetType,, uint32 lastTransfer,,, ) = nft.getTokenDetails(_assetId);\r\n        uint256 timeFrame = block.timestamp - lastTransfer;\r\n        if (timeFrame < wUnit) {  \r\n            return (0, lastTransfer);\r\n        } else {\r\n            uint256 weekCount = timeFrame/(wUnit); \r\n            uint256 totalPayment;\r\n            totalPayment = ((weekCount * weeklyByType[assetType]));\r\n            return (totalPayment, lastTransfer);    \r\n        }\r\n\r\n    }\r\n    \r\n\r\n    function pauseContract(bool _paused) public onlyOwner {\r\n        paused = _paused;\r\n    }\r\n    \r\n    function blackList(address _wallet, bool _blacklist) public onlyOwner {\r\n        blackListed[_wallet] = _blacklist;\r\n    }\r\n\r\n    function paymentCount() public view returns (uint256 _paymentCount) {\r\n        return payments.length;\r\n    }\r\n    \r\n    function paymentDetail(uint256 _paymentIndex) public view returns (address _to, uint8 _network, uint256 assetId, uint256 _amount, uint256 _date) {\r\n        Claim memory thisPayment = payments[_paymentIndex];\r\n        return (thisPayment.account, thisPayment.dNetwork, thisPayment.assetId, thisPayment.amount, thisPayment.date);\r\n    }\r\n    \r\n    function addType(uint256 _aType, uint256 _weekly) public onlyOwner {\r\n        weeklyByType[_aType] = _weekly;\r\n    }\r\n    \r\n    function setGasFee(uint256 _gasFee) public onlyOwner {\r\n        gasFee = _gasFee;\r\n    }\r\n    \r\n}","ABI":"[{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"oldOwner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnerSet\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint8\",\"name\":\"network\",\"type\":\"uint8\"}],\"name\":\"Payment\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_aType\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_weekly\",\"type\":\"uint256\"}],\"name\":\"addType\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_wallet\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"_blacklist\",\"type\":\"bool\"}],\"name\":\"blackList\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"blackListed\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_assetId\",\"type\":\"uint256\"}],\"name\":\"calcProfit\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"_profit\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_lastPayment\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_assetId\",\"type\":\"uint256\"}],\"name\":\"calcTotalEarnings\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"_profit\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_lastPayment\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"changeOwner\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"gasFee\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getOwner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"nftAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bool\",\"name\":\"_paused\",\"type\":\"bool\"}],\"name\":\"pauseContract\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"paused\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"paymentCount\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"_paymentCount\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_paymentIndex\",\"type\":\"uint256\"}],\"name\":\"paymentDetail\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"uint8\",\"name\":\"_network\",\"type\":\"uint8\"},{\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_date\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"payments\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"account\",\"type\":\"address\"},{\"internalType\":\"uint8\",\"name\":\"dNetwork\",\"type\":\"uint8\"},{\"internalType\":\"uint256\",\"name\":\"assetId\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"date\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_assetId\",\"type\":\"uint256\"}],\"name\":\"profitsPayment\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_assetId\",\"type\":\"uint256\"}],\"name\":\"profitsPaymentBSC\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_gasFee\",\"type\":\"uint256\"}],\"name\":\"setGasFee\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"tokenAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"walletAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"weeklyByType\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"PolkaProfitContract","CompilerVersion":"v0.8.2+commit.661d1103","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"MIT","Proxy":"0","Implementation":"","SwarmSource":"ipfs://a65a12015a28ee0c9b80fb01c27e8029f2c370e420385f1872f61d93650d78b2"}]}