{"status":"1","message":"OK","result":[{"SourceCode":"/*\r\n\r\nAuthor: psdev\r\n\r\np@psdev.io\r\n\r\n0x13370CA2e8426a82BcfcCE21C97817A243c521Cf\r\n\r\n*/\r\n\r\ncontract TokenInterface {\r\n  function balanceOf(address _owner) constant returns (uint256 balance);\r\n  function transfer(address _to, uint256 _amount) returns (bool success);\r\n  function receiveEther() returns(bool);\r\n}\r\n\r\ncontract SellTokens {\r\n    address constant THE_DAO_ADDRESS = 0xbb9bc244d798123fde783fcc1c72d3bb8c189413;\r\n\r\n    TokenInterface public theDao;\r\n    mapping (address => uint) public allowedFreeExchanges;\r\n\r\n    event TransferEvent(address _from, address _to, uint256 _value);\r\n    event ReturnEvent(uint256 _value);\r\n    event NotEnoughEthErrorEvent(uint trySend, uint available);\r\n    event NotEnoughDaoErrorEvent(uint trySend, uint available);\r\n\r\n    function SellTokens(){\r\n        theDao = TokenInterface(THE_DAO_ADDRESS);\r\n        populateAllowedFreeExchanges();\r\n    }\r\n\r\n    function requestTokensBack() {\r\n        if (msg.value != 0 || allowedFreeExchanges[msg.sender] == 0) throw;\r\n        if (!theDao.transfer(msg.sender, allowedFreeExchanges[msg.sender])) throw;\r\n        allowedFreeExchanges[msg.sender] = 0;\r\n    }\r\n\r\n    function buy100DaoFor1Eth(){\r\n        var tokens_to_send = msg.value;\r\n        uint daoBalance = theDao.balanceOf(this);\r\n        if (tokens_to_send > daoBalance) {\r\n            NotEnoughDaoErrorEvent(tokens_to_send, daoBalance);\r\n            throw;\r\n        }\r\n        if (msg.value > this.balance) {\r\n            NotEnoughEthErrorEvent(msg.value, this.balance);\r\n            throw;\r\n        }\r\n\r\n        // send tokens back to buyer\r\n        if (!theDao.transfer(msg.sender, tokens_to_send)) throw;\r\n        TransferEvent(this, msg.sender, tokens_to_send);\r\n        // send eth from buyer to dao\r\n        if (!theDao.receiveEther.value(msg.value)()) throw;\r\n        ReturnEvent(msg.value);\r\n    }\r\n\r\n    // accounts and amounts sent to dao, rounded down & only txn > 100 tokens\r\n    function populateAllowedFreeExchanges() internal {\r\n        // from etherscan\r\n        allowedFreeExchanges[address(0x900b1d91f8931e3e1de3076341accb2f6011214f)] = 4000000000000000000;\r\n        allowedFreeExchanges[address(0x8b3b3b624c3c0397d3da8fd861512393d51dcbac)] = 31560000000000000000;\r\n        allowedFreeExchanges[address(0x0a869d79a7052c7f1b55a8ebabbea3420f0d1e13)] = 9900000000000000000;\r\n        allowedFreeExchanges[address(0x8b3b3b624c3c0397d3da8fd861512393d51dcbac)] = 1040000000000000000;\r\n        allowedFreeExchanges[address(0x8b3b3b624c3c0397d3da8fd861512393d51dcbac)] = 90000000000000000000;\r\n        allowedFreeExchanges[address(0xdf21fa922215b1a56f5a6d6294e6e36c85a0acfb)] = 49990000000000000000;\r\n        allowedFreeExchanges[address(0x0a9de66f5fda96a5b40d1ca9cd18bfb298c67d1c)] = 16440000000000000000;\r\n        allowedFreeExchanges[address(0x946c555081313c5e0986c6cd5f6978257a406237)] = 1000000000000000000;\r\n        allowedFreeExchanges[address(0x0a869d79a7052c7f1b55a8ebabbea3420f0d1e13)] = 295510000000000000000;\r\n    }\r\n\r\n\r\n\r\n\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"allowedFreeExchanges\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"buy100DaoFor1Eth\",\"outputs\":[],\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"requestTokensBack\",\"outputs\":[],\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"theDao\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"TransferEvent\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"ReturnEvent\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"trySend\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"available\",\"type\":\"uint256\"}],\"name\":\"NotEnoughEthErrorEvent\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"trySend\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"available\",\"type\":\"uint256\"}],\"name\":\"NotEnoughDaoErrorEvent\",\"type\":\"event\"}]","ContractName":"SellTokens","CompilerVersion":"v0.3.4-2016-05-31-7dab890","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":""}]}