{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.22;\r\n\r\ncontract Roulette {\r\n  \r\n  uint betAmount;\r\n  uint necessaryBalance;\r\n  uint nextRoundTimestamp;\r\n  address creator;\r\n  uint256 maxAmountAllowedInTheBank;\r\n  mapping (address => uint256) winnings;\r\n  uint8[] payouts;\r\n  uint8[] numberRange;\r\n  \r\n  /*\r\n    BetTypes are as follow:\r\n      0: color\r\n      1: column\r\n      2: dozen\r\n      3: eighteen\r\n      4: modulus\r\n      5: number\r\n      \r\n    Depending on the BetType, number will be:\r\n      color: 0 for black, 1 for red\r\n      column: 0 for left, 1 for middle, 2 for right\r\n      dozen: 0 for first, 1 for second, 2 for third\r\n      eighteen: 0 for low, 1 for high\r\n      modulus: 0 for even, 1 for odd\r\n      number: number\r\n  */\r\n  \r\n  struct Bet {\r\n    address player;\r\n    uint8 betType;\r\n    uint8 number;\r\n  }\r\n  Bet[] public bets;\r\n  \r\n  constructor() public payable {\r\n    creator = msg.sender;\r\n    necessaryBalance = 0;\r\n    nextRoundTimestamp = now;\r\n    payouts = [2,3,3,2,2,36];\r\n    numberRange = [1,2,2,1,1,36];\r\n    betAmount = 50000000000000000; /* 0.05 ether */\r\n    maxAmountAllowedInTheBank = 10000000000000000000; /* 2 ether */\r\n  }\r\n\r\n  event RandomNumber(uint256 number);\r\n  \r\n  function getStatus() public view returns(uint, uint, uint, uint, uint) {\r\n    return (\r\n      bets.length,             // number of active bets\r\n      bets.length * betAmount, // value of active bets\r\n      nextRoundTimestamp,      // when can we play again\r\n      address(this).balance,   // roulette balance\r\n      winnings[msg.sender]     // winnings of player\r\n    ); \r\n  }\r\n    \r\n  function addEther() payable public {}\r\n\r\n  function bet(uint8 number, uint8 betType) payable public {\r\n    /* \r\n       A bet is valid when:\r\n       1 - the value of the bet is correct (=betAmount)\r\n       2 - betType is known (between 0 and 5)\r\n       3 - the option betted is valid (don't bet on 37!)\r\n       4 - the bank has sufficient funds to pay the bet\r\n    */\r\n    require(msg.value == betAmount);                               // 1\r\n    require(betType >= 0 && betType <= 5);                         // 2\r\n    require(number >= 0 && number <= numberRange[betType]);        // 3\r\n    uint payoutForThisBet = payouts[betType] * msg.value;\r\n    uint provisionalBalance = necessaryBalance + payoutForThisBet;\r\n    require(provisionalBalance < address(this).balance);           // 4\r\n    /* we are good to go */\r\n    necessaryBalance += payoutForThisBet;\r\n    bets.push(Bet({\r\n      betType: betType,\r\n      player: msg.sender,\r\n      number: number\r\n    }));\r\n  }\r\n\r\n  function spinWheel() public {\r\n    /* are there any bets? */\r\n    require(bets.length > 0);\r\n    /* are we allowed to spin the wheel? */\r\n    require(now > nextRoundTimestamp);\r\n    /* next time we are allowed to spin the wheel again */\r\n    nextRoundTimestamp = now;\r\n    /* calculate 'random' number */\r\n    uint diff = block.difficulty;\r\n    bytes32 hash = blockhash(block.number-1);\r\n    Bet memory lb = bets[bets.length-1];\r\n    uint number = uint(keccak256(abi.encodePacked(now, diff, hash, lb.betType, lb.player, lb.number))) % 37;\r\n    /* check every bet for this number */\r\n    for (uint i = 0; i < bets.length; i++) {\r\n      bool won = false;\r\n      Bet memory b = bets[i];\r\n      if (number == 0) {\r\n        won = (b.betType == 5 && b.number == 0);                   /* bet on 0 */\r\n      } else {\r\n        if (b.betType == 5) { \r\n          won = (b.number == number);                              /* bet on number */\r\n        } else if (b.betType == 4) {\r\n          if (b.number == 0) won = (number % 2 == 0);              /* bet on even */\r\n          if (b.number == 1) won = (number % 2 == 1);              /* bet on odd */\r\n        } else if (b.betType == 3) {            \r\n          if (b.number == 0) won = (number <= 18);                 /* bet on low 18s */\r\n          if (b.number == 1) won = (number >= 19);                 /* bet on high 18s */\r\n        } else if (b.betType == 2) {                               \r\n          if (b.number == 0) won = (number <= 12);                 /* bet on 1st dozen */\r\n          if (b.number == 1) won = (number > 12 && number <= 24);  /* bet on 2nd dozen */\r\n          if (b.number == 2) won = (number > 24);                  /* bet on 3rd dozen */\r\n        } else if (b.betType == 1) {               \r\n          if (b.number == 0) won = (number % 3 == 1);              /* bet on left column */\r\n          if (b.number == 1) won = (number % 3 == 2);              /* bet on middle column */\r\n          if (b.number == 2) won = (number % 3 == 0);              /* bet on right column */\r\n        } else if (b.betType == 0) {\r\n          if (b.number == 0) {                                     /* bet on black */\r\n            if (number <= 10 || (number >= 20 && number <= 28)) {\r\n              won = (number % 2 == 0);\r\n            } else {\r\n              won = (number % 2 == 1);\r\n            }\r\n          } else {                                                 /* bet on red */\r\n            if (number <= 10 || (number >= 20 && number <= 28)) {\r\n              won = (number % 2 == 1);\r\n            } else {\r\n              won = (number % 2 == 0);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      /* if winning bet, add to player winnings balance */\r\n      if (won) {\r\n        winnings[b.player] += betAmount * payouts[b.betType];\r\n      }\r\n    }\r\n    /* delete all bets */\r\n    bets.length = 0;\r\n    /* reset necessaryBalance */\r\n    necessaryBalance = 0;\r\n    /* check if to much money in the bank */\r\n    if (address(this).balance > maxAmountAllowedInTheBank) takeProfits();\r\n    /* returns 'random' number to UI */\r\n    emit RandomNumber(number);\r\n  }\r\n  \r\n  function cashOut() public {\r\n    address player = msg.sender;\r\n    uint256 amount = winnings[player];\r\n    require(amount > 0);\r\n    require(amount <= address(this).balance);\r\n    winnings[player] = 0;\r\n    player.transfer(amount);\r\n  }\r\n  \r\n  function takeProfits() internal {\r\n    uint amount = address(this).balance - maxAmountAllowedInTheBank;\r\n    if (amount > 0) creator.transfer(amount);\r\n  }\r\n  \r\n  function creatorKill() public {\r\n    require(msg.sender == creator);\r\n    selfdestruct(creator);\r\n  }\r\n \r\n}","ABI":"[{\"constant\":false,\"inputs\":[],\"name\":\"spinWheel\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"bets\",\"outputs\":[{\"name\":\"player\",\"type\":\"address\"},{\"name\":\"betType\",\"type\":\"uint8\"},{\"name\":\"number\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getStatus\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"cashOut\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"addEther\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"creatorKill\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"number\",\"type\":\"uint8\"},{\"name\":\"betType\",\"type\":\"uint8\"}],\"name\":\"bet\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"number\",\"type\":\"uint256\"}],\"name\":\"RandomNumber\",\"type\":\"event\"}]","ContractName":"Roulette","CompilerVersion":"v0.4.22+commit.4cb486ee","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://8449d9ed0d7bd05fcbef7892e82fb631a2416e554f8d52d1a5373aa5644d077f"}]}