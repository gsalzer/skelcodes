{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.5.2;\r\n\r\n// File: node_modules/openzeppelin-solidity/contracts/access/Roles.sol\r\n\r\n/**\r\n * @title Roles\r\n * @dev Library for managing addresses assigned to a Role.\r\n */\r\nlibrary Roles {\r\n    struct Role {\r\n        mapping (address => bool) bearer;\r\n    }\r\n\r\n    /**\r\n     * @dev give an account access to this role\r\n     */\r\n    function add(Role storage role, address account) internal {\r\n        require(account != address(0));\r\n        require(!has(role, account));\r\n\r\n        role.bearer[account] = true;\r\n    }\r\n\r\n    /**\r\n     * @dev remove an account's access to this role\r\n     */\r\n    function remove(Role storage role, address account) internal {\r\n        require(account != address(0));\r\n        require(has(role, account));\r\n\r\n        role.bearer[account] = false;\r\n    }\r\n\r\n    /**\r\n     * @dev check if an account has this role\r\n     * @return bool\r\n     */\r\n    function has(Role storage role, address account) internal view returns (bool) {\r\n        require(account != address(0));\r\n        return role.bearer[account];\r\n    }\r\n}\r\n\r\n// File: contracts/Adminable.sol\r\n\r\ncontract Adminable {\r\n    using Roles for Roles.Role;\r\n\r\n    event AdminAdded(address indexed account);\r\n    event AdminRemoved(address indexed account);\r\n\r\n    Roles.Role private _admins;\r\n\r\n    constructor () internal {\r\n        _addAdmin(msg.sender);\r\n    }\r\n\r\n    modifier onlyAdmin() {\r\n        require(isAdmin(msg.sender));\r\n        _;\r\n    }\r\n\r\n    function isAdmin(address account) public view returns (bool) {\r\n        return _admins.has(account);\r\n    }\r\n\r\n    function addAdmin(address account) public onlyAdmin {\r\n        _addAdmin(account);\r\n    }\r\n\r\n    function renounceAdmin() public {\r\n        _removeAdmin(msg.sender);\r\n    }\r\n\r\n    function _addAdmin(address account) internal {\r\n        _admins.add(account);\r\n        emit AdminAdded(account);\r\n    }\r\n\r\n    function _removeAdmin(address account) internal {\r\n        _admins.remove(account);\r\n        emit AdminRemoved(account);\r\n    }\r\n}\r\n\r\n// File: contracts/Authorizable.sol\r\n\r\ncontract Authorizable is Adminable {\r\n\r\n    address public authorizedAddress;\r\n    \r\n    modifier onlyAuthorized() {\r\n        require(msg.sender == authorizedAddress);\r\n        _;\r\n    }\r\n\r\n    function updateAuthorizedAddress(address _address) onlyAdmin public {\r\n        authorizedAddress = _address;\r\n    }\r\n\r\n}\r\n\r\n// File: contracts/SoarStorage.sol\r\n\r\n/**\r\n    @title Soar Storage\r\n    @author Marek Tlacbaba (marek@soar.earth)\r\n    @dev This smart contract behave as simple storage and can be \r\n    accessed only by authorized caller who is responsible for any\r\n    checks and validation. The authorized caller can updated by \r\n    admins so it allows to update application logic \r\n    and keeping data and events untouched.\r\n*/\r\n\r\n//TODO\r\n// use safeMath\r\ncontract SoarStorage is Authorizable {\r\n\r\n    /**\r\n    Status: \r\n        0 - unknown\r\n        1 - created\r\n        2 - updated\r\n        3 - deleted\r\n    */\r\n    struct ListingObject {\r\n        address owner;\r\n        address sponsor;\r\n        bytes12 geohash;\r\n        mapping (address => mapping (bytes32 => uint )) sales;\r\n        uint256 salesCount;\r\n        uint8 status;\r\n    }\r\n\r\n    uint public counter = 0;\r\n    mapping (bytes32 => ListingObject) internal listings;\r\n\r\n    event Listing (\r\n        bytes32 filehash,\r\n        address indexed owner,\r\n        address indexed sponsor,\r\n        string previewUrl, \r\n        string url, \r\n        string pointWKT,\r\n        bytes12 geohash, \r\n        string metadata\r\n    );\r\n\r\n    event ListingUpdated (\r\n        bytes32 filehash,\r\n        address indexed owner, \r\n        address indexed sponsor,\r\n        string previewUrl, \r\n        string url, \r\n        string pointWKT,\r\n        bytes12 geohash, \r\n        string metadata \r\n    );\r\n\r\n    event ListingDeleted (\r\n        bytes32 filehash,\r\n        address indexed owner,\r\n        address indexed sponsor\r\n    );\r\n\r\n    event Sale(\r\n        address indexed buyer, \r\n        bytes32 id, \r\n        address indexed owner, \r\n        address sponsor,\r\n        bytes32 indexed filehash,\r\n        uint price \r\n    );\r\n\r\n    function putListing (\r\n        bytes32 _filehash,\r\n        address _owner,\r\n        address _sponsor,\r\n        string memory _previewUrl, \r\n        string memory _url, \r\n        string memory _pointWKT, \r\n        bytes12 _geohash, \r\n        string memory _metadata\r\n    ) \r\n        public \r\n        onlyAuthorized \r\n    {\r\n        listings[_filehash].owner = _owner;\r\n        listings[_filehash].sponsor = _sponsor;\r\n        listings[_filehash].geohash = _geohash;\r\n        listings[_filehash].status = 1;\r\n        counter++;\r\n        emit Listing(\r\n            _filehash, \r\n            _owner,\r\n            _sponsor, \r\n            _previewUrl, \r\n            _url, \r\n            _pointWKT, \r\n            _geohash, \r\n            _metadata\r\n        );\r\n    }\r\n\r\n    function updateListing (\r\n        bytes32 _filehash,\r\n        address _owner,\r\n        address _sponsor,\r\n        string memory _previewUrl, \r\n        string memory _url, \r\n        string memory _pointWKT, \r\n        bytes12 _geohash, \r\n        string memory _metadata \r\n    ) \r\n        public \r\n        onlyAuthorized \r\n    {\r\n        listings[_filehash].geohash = _geohash;\r\n        listings[_filehash].status = 2;\r\n        emit ListingUpdated(\r\n            _filehash, \r\n            _owner,\r\n            _sponsor, \r\n            _previewUrl, \r\n            _url, \r\n            _pointWKT, \r\n            _geohash, \r\n            _metadata\r\n        );\r\n    }\r\n\r\n    function deleteListing(\r\n        bytes32 _filehash \r\n    )\r\n        public \r\n        onlyAuthorized \r\n    {\r\n        listings[_filehash].status = 3;\r\n        counter--;\r\n        emit ListingDeleted(_filehash, listings[_filehash].owner, listings[_filehash].sponsor);\r\n    }\r\n\r\n    function putSale (\r\n        address _buyer,\r\n        bytes32 _id,\r\n        bytes32 _filehash, \r\n        uint256 _price\r\n    ) \r\n        public \r\n        onlyAuthorized \r\n    {\r\n        listings[_filehash].sales[_buyer][_id] = _price;\r\n        listings[_filehash].salesCount++;\r\n        emit Sale(_buyer, _id, listings[_filehash].owner, listings[_filehash].sponsor, _filehash, _price);\r\n    }\r\n\r\n    function getListingDetails(bytes32 _filehash, address _user, bytes32 _id) \r\n        public view\r\n        returns (\r\n            address owner_,\r\n            address sponsor_,\r\n            bytes12 geohash_,\r\n            uint8 status_,\r\n            uint256 sale_\r\n        )\r\n    {\r\n        owner_ = listings[_filehash].owner;\r\n        sponsor_ = listings[_filehash].sponsor;\r\n        geohash_ = listings[_filehash].geohash;\r\n        status_ = listings[_filehash].status;\r\n        sale_ = listings[_filehash].sales[_user][_id];\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"account\",\"type\":\"address\"}],\"name\":\"isAdmin\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"updateAuthorizedAddress\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"authorizedAddress\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_filehash\",\"type\":\"bytes32\"},{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_sponsor\",\"type\":\"address\"},{\"name\":\"_previewUrl\",\"type\":\"string\"},{\"name\":\"_url\",\"type\":\"string\"},{\"name\":\"_pointWKT\",\"type\":\"string\"},{\"name\":\"_geohash\",\"type\":\"bytes12\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"updateListing\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"counter\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"account\",\"type\":\"address\"}],\"name\":\"addAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_buyer\",\"type\":\"address\"},{\"name\":\"_id\",\"type\":\"bytes32\"},{\"name\":\"_filehash\",\"type\":\"bytes32\"},{\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"putSale\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_filehash\",\"type\":\"bytes32\"},{\"name\":\"_owner\",\"type\":\"address\"},{\"name\":\"_sponsor\",\"type\":\"address\"},{\"name\":\"_previewUrl\",\"type\":\"string\"},{\"name\":\"_url\",\"type\":\"string\"},{\"name\":\"_pointWKT\",\"type\":\"string\"},{\"name\":\"_geohash\",\"type\":\"bytes12\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"putListing\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"renounceAdmin\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_filehash\",\"type\":\"bytes32\"}],\"name\":\"deleteListing\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_filehash\",\"type\":\"bytes32\"},{\"name\":\"_user\",\"type\":\"address\"},{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getListingDetails\",\"outputs\":[{\"name\":\"owner_\",\"type\":\"address\"},{\"name\":\"sponsor_\",\"type\":\"address\"},{\"name\":\"geohash_\",\"type\":\"bytes12\"},{\"name\":\"status_\",\"type\":\"uint8\"},{\"name\":\"sale_\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"filehash\",\"type\":\"bytes32\"},{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"sponsor\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"previewUrl\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"url\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"pointWKT\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"geohash\",\"type\":\"bytes12\"},{\"indexed\":false,\"name\":\"metadata\",\"type\":\"string\"}],\"name\":\"Listing\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"filehash\",\"type\":\"bytes32\"},{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"sponsor\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"previewUrl\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"url\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"pointWKT\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"geohash\",\"type\":\"bytes12\"},{\"indexed\":false,\"name\":\"metadata\",\"type\":\"string\"}],\"name\":\"ListingUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"filehash\",\"type\":\"bytes32\"},{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"sponsor\",\"type\":\"address\"}],\"name\":\"ListingDeleted\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"buyer\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"id\",\"type\":\"bytes32\"},{\"indexed\":true,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"sponsor\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"filehash\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"price\",\"type\":\"uint256\"}],\"name\":\"Sale\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"AdminAdded\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"AdminRemoved\",\"type\":\"event\"}]","ContractName":"SoarStorage","CompilerVersion":"v0.5.2+commit.1df8f40c","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://f715806698f0d99c799931f03f14096a03f997bdfd17559b88de454567ed91d1"}]}