{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.5.7;\r\n\r\ncontract Ownable {\r\n    address public owner;\r\n    \r\n    event SetOwner(address _owner);\r\n\r\n    modifier onlyOwner() {\r\n        require(msg.sender == owner);\r\n        _;\r\n    }\r\n\r\n    constructor() public {\r\n        emit SetOwner(msg.sender);\r\n        owner = msg.sender; \r\n    }\r\n\r\n    /**\r\n        @dev Transfers the ownership of the contract.\r\n\r\n        @param _to Address of the new owner\r\n    */\r\n    function setOwner(address _to) external onlyOwner returns (bool) {\r\n        require(_to != address(0));\r\n        emit SetOwner(_to);\r\n        owner = _to;\r\n        return true;\r\n    } \r\n}\r\n\r\ninterface Oracle {\r\n    function getRate(bytes32 currency, bytes calldata data) external returns (uint256, uint256);\r\n}\r\n\r\nlibrary SafeCast {\r\n    function toUint8(uint256 _v) internal pure returns (uint8) {\r\n        require(_v < 2 ** 8, \"uint8 overflow\");\r\n        return uint8(_v);\r\n    }\r\n\r\n    function toUint40(uint256 _v) internal pure returns (uint40) {\r\n        require(_v < 2 ** 40, \"uint40 overflow\");\r\n        return uint40(_v);\r\n    }\r\n\r\n    function toUint208(uint256 _v) internal pure returns (uint208) {\r\n        require(_v < 2 ** 208, \"uint208 overflow\");\r\n        return uint208(_v);\r\n    }\r\n}\r\n\r\ncontract SimpleOracle is Ownable {\r\n    using SafeCast for uint256;\r\n\r\n    event DelegatedCall(\r\n        address requester,\r\n        address to\r\n    );\r\n\r\n    event DeliveredRate(\r\n        address requester,\r\n        bytes32 currency,\r\n        uint256 deliverTimestamp,\r\n        uint256 rate,\r\n        uint256 decimals\r\n    );\r\n\r\n    event UpdatedRate(\r\n        address delegate,\r\n        bytes32 currency,\r\n        uint256 timestamp,\r\n        uint256 rate,\r\n        uint256 decimals\r\n    );\r\n    \r\n    event SetExpirationTime(uint256 _time);\r\n    event SetUrl(string _url);\r\n    event SetFallback(address _fallback);\r\n    event SetDelegate(address _delegate);\r\n\r\n    Oracle public fallback;\r\n    address public delegate;\r\n    uint256 public expiration = 6 hours;\r\n\r\n    mapping(bytes32 => Rate) public rates;\r\n\r\n    string private iurl;\r\n\r\n    struct Rate {\r\n        uint8 decimals;\r\n        uint40 timestamp; \r\n        uint208 value;\r\n    }\r\n\r\n    modifier delegateOrOwner() {\r\n        require(msg.sender == delegate || msg.sender == owner, \"Not authorized\");\r\n        _;\r\n    }\r\n\r\n    function url() public view returns (string memory) {\r\n        return iurl;\r\n    }\r\n\r\n    function setExpirationTime(uint256 _time) external onlyOwner {\r\n        expiration = _time;\r\n        emit SetExpirationTime(_time);\r\n    }\r\n\r\n    function setUrl(string calldata _url) external onlyOwner {\r\n        iurl = _url;\r\n        emit SetUrl(_url);\r\n    }\r\n\r\n    function setFallback(Oracle _fallback) external onlyOwner {\r\n        fallback = _fallback;\r\n        emit SetFallback(address(_fallback));\r\n    }\r\n\r\n    function setDelegate(address _delegate) external onlyOwner {\r\n        delegate = _delegate;\r\n        emit SetDelegate(_delegate);\r\n    }\r\n    \r\n    function updateRate(\r\n        bytes32 _currency,\r\n        uint256 _value,\r\n        uint256 _timestamp,\r\n        uint256 _decimals\r\n    ) external delegateOrOwner {\r\n        require(_timestamp <= block.timestamp, \"Future rate\");\r\n        require(_timestamp + expiration > block.timestamp, \"Rate expired\");\r\n\r\n        rates[_currency] = Rate(\r\n            _decimals.toUint8(),\r\n            _timestamp.toUint40(),\r\n            _value.toUint208()\r\n        );\r\n\r\n        emit UpdatedRate(\r\n            msg.sender,\r\n            _currency,\r\n            _timestamp,\r\n            _value,\r\n            _decimals\r\n        );\r\n    }\r\n\r\n    function isExpired(uint256 timestamp) internal view returns (bool) {\r\n        return timestamp <= now - expiration;\r\n    }\r\n\r\n    function getRate(bytes32 _currency, bytes calldata _data) external returns (uint256, uint256) {\r\n        if (address(fallback) != address(0)) {\r\n            emit DelegatedCall(msg.sender, address(fallback));\r\n            return fallback.getRate(_currency, _data);\r\n        }\r\n\r\n        Rate memory rate = rates[_currency];\r\n        require(rate.timestamp + expiration > block.timestamp);\r\n        emit DeliveredRate(msg.sender, _currency, rate.timestamp, rate.value, rate.decimals);\r\n        return (rate.value, rate.decimals);\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_currency\",\"type\":\"bytes32\"},{\"name\":\"_value\",\"type\":\"uint256\"},{\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"name\":\"_decimals\",\"type\":\"uint256\"}],\"name\":\"updateRate\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"setOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_url\",\"type\":\"string\"}],\"name\":\"setUrl\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_fallback\",\"type\":\"address\"}],\"name\":\"setFallback\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_currency\",\"type\":\"bytes32\"},{\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"getRate\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"expiration\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"fallback\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"url\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"setExpirationTime\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"delegate\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_delegate\",\"type\":\"address\"}],\"name\":\"setDelegate\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"rates\",\"outputs\":[{\"name\":\"decimals\",\"type\":\"uint8\"},{\"name\":\"timestamp\",\"type\":\"uint40\"},{\"name\":\"value\",\"type\":\"uint208\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"requester\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"to\",\"type\":\"address\"}],\"name\":\"DelegatedCall\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"requester\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"currency\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"deliverTimestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"rate\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"decimals\",\"type\":\"uint256\"}],\"name\":\"DeliveredRate\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"delegate\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"currency\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"rate\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"decimals\",\"type\":\"uint256\"}],\"name\":\"UpdatedRate\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_time\",\"type\":\"uint256\"}],\"name\":\"SetExpirationTime\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_url\",\"type\":\"string\"}],\"name\":\"SetUrl\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_fallback\",\"type\":\"address\"}],\"name\":\"SetFallback\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_delegate\",\"type\":\"address\"}],\"name\":\"SetDelegate\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"SetOwner\",\"type\":\"event\"}]","ContractName":"SimpleOracle","CompilerVersion":"v0.5.7+commit.6da8b019","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://68bb17809ec910747bc0cafe910ea24e4658cb018a4a6e70e025d1b08ee8cc5e"}]}