{"status":"1","message":"OK","result":[{"SourceCode":"/**\r\n * Source Code first verified at https://etherscan.io on Wednesday, May 8, 2019\r\n (UTC) */\r\n\r\npragma solidity ^0.5.6; \r\n//rev modifica construttore Tag \r\n//certo v19041100c056 noima (c) all right reserved 2017-2019 \r\ncontract BaseCertoChainContract {\r\n    address payable creator; \r\n    address payable owner; \r\n    \r\n    bool public isSealed;\r\n      \r\n    constructor() public    {   creator = msg.sender;   owner=msg.sender; }\r\n    \r\n    modifier onlyBy(address _account)\r\n    {\r\n        require(msg.sender != _account);\r\n        _;\r\n    }\r\n    \r\n    \r\n     modifier onlyIfNotSealed() //semantic when sealed is not possible to change sensible data\r\n    {\r\n        if (isSealed)\r\n            revert();\r\n        _;\r\n    }\r\n    \r\n    function   kill() public onlyBy(owner)\r\n    {               selfdestruct(owner);     }\r\n     \r\n     function setCreator(address payable _creator)  public onlyBy(creator)\r\n    {           creator = _creator;     \r\n                     emit EventReady(address(this),\"setCreator\");\r\n    }\r\n\r\n     function setOwner(address payable _owner)  public onlyBy(owner)\r\n    {           owner = _owner;    \r\n                     emit EventReady(address(this),\"SetOwner\");\r\n     }\r\n    \r\n    \r\nfunction setSealed() public  onlyBy(owner)  { isSealed = true;  emit EventSealed(address(this));   } //seal down contract not reversible\r\n\r\n event  EventSealed(address self); //invoked when contract is sealed\r\n event  EventSetCreator(address self); //invoked when we change creator\r\n event  EventSetOwner(address self); //invoked when we change owner\r\n event EventReady(address self,string method); //invoked when we have done the method action\r\n\r\n}\r\n\r\n\r\ncontract TagCertoChainContract   is BaseCertoChainContract    \r\n{  \r\n    bool public isActive;\r\n   \r\n \r\n\r\n    function constructorx(address payable _owner) public\r\n    {\r\n          owner=(_owner);\r\n          emit EventReady(address(this),\"constructor\");\r\n    } \r\n\r\n\r\n\r\n    constructor(address payable _owner,bytes32   signaturehash,bytes32 signaturemaskR ,bytes32 signaturemaskS, uint8 signaturemaskV ) public \r\n    {\r\n          owner=(_owner);\r\n          SignatureMaskR=signaturemaskR;\r\n          SignatureMaskS=signaturemaskS;\r\n          SignatureMaskV=signaturemaskV;          \r\n          SignatureHash=signaturehash;\r\n          emit EventReady(address(this),\"constructor\");\r\n    }\r\n\r\n    function ActivateTag(address Target) public onlyBy(owner)\r\n    {\r\n          TargetDocument=Target;\r\n          emit EventReady(address(this),\"ActivateTag\");\r\n    }\r\n\r\n    function SignTag(bytes32   signaturehash,bytes32 signaturemaskR ,bytes32 signaturemaskS, uint8 signaturemaskV ) public onlyBy(owner)\r\n    {\r\n          SignatureMaskR=signaturemaskR;\r\n          SignatureMaskS=signaturemaskS;\r\n          SignatureMaskV=signaturemaskV;          \r\n          SignatureHash=signaturehash;\r\n          emit EventReady(address(this),\"SignTag\");\r\n    }\r\n\r\n    function VerifyTag(bytes8 signaturepinS )  public view  returns (string memory)    {\r\n            bytes32 signatureR;\r\n            bytes32 signatureS;\r\n            bytes32 signatureSpad;\r\n            signatureSpad=signaturepinS;\r\n            signatureR=SignatureMaskR;\r\n            signatureS=SignatureMaskS|(signatureSpad);            \r\n            //emit EventReady(address(this),\"VerifyTag\");\r\n           if  (ecrecover(SignatureHash, SignatureMaskV,signatureR , signatureS) ==creator) {\r\n                 return \"OK IS TAG VALID\";\r\n           } else\r\n           {    return \"NOT A VALID TAG\";  }\r\n\r\n          // return signatureS;\r\n    }\r\n\r\n\r\n     function RecoverSigner(bytes32 msgHash,  bytes32 signaturepinR, bytes32 signaturepinS)  public  view returns (address) {\r\n          bytes32 signatureR;\r\n            bytes32 signatureS;\r\n             signatureR=SignatureMaskR|signaturepinR;\r\n              signatureS=SignatureMaskS|signaturepinS;\r\n             \r\n        return ecrecover(msgHash,SignatureMaskV,signatureR , signatureS) ;\r\n    }\r\n    \r\n     \r\n\r\n    address public  TargetDocument; \r\n    bytes32 public  SignatureMaskR;\r\n    bytes32 public  SignatureMaskS;\r\n    uint8   public   SignatureMaskV;\r\n    \r\n    \r\n    bytes32 public  SignatureHash;\r\n    \r\n}\r\n\r\ncontract DocumentCertoChainContract   is BaseCertoChainContract    \r\n{  \r\n  \r\n    string  public  Name;         //Product\r\n    string  public  Description ; //Description\r\n    string  public  FileName;     //FileName\r\n    string  public  FileHash;     //SecuritySeal HASH\r\n    string  public  FileData;     //SecuritySeal DATA\r\n    address public  Revision; \r\n    address public  NextOwner; \r\n    address public  PrevOwner; \r\n    \r\n    \r\n    constructor(string memory  _Description, string memory  _FileName,string memory _FileHash,string memory _FileData) public\r\n    {\r\n          Revision=address(this);\r\n          NextOwner=address(this);\r\n          Description=_Description;\r\n          FileName=_FileName;\r\n          FileHash=_FileHash;\r\n          FileData=_FileData;\r\n\r\n\r\n         emit EventReady(address(this),\"constructor\");\r\n       \r\n    }\r\n    \r\n    function setRevision(address _Revision)  public onlyBy(creator) onlyIfNotSealed()\r\n    {\r\n          Revision = _Revision;\r\n          emit EventNewRevision(address(this));\r\n        \r\n    }\r\n     \r\n     \r\n     function setNextOwner(address _NextOwner)  public onlyBy(creator) onlyIfNotSealed()\r\n    {\r\n          NextOwner = _NextOwner;\r\n          emit EventNewOwner(address(this));\r\n    }\r\n    \r\n     function setPrevOwner(address _PrevOwner)  public onlyBy(creator) onlyIfNotSealed()\r\n    {\r\n          PrevOwner = _PrevOwner;\r\n          emit EventNewPrevOwner(address(this));\r\n    }\r\n     event EventNewOwner(address self);\r\n     event EventNewPrevOwner(address self);\r\n     event EventNewRevision(address self); \r\n     \r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"setOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_NextOwner\",\"type\":\"address\"}],\"name\":\"setNextOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_creator\",\"type\":\"address\"}],\"name\":\"setCreator\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"NextOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"setSealed\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_Revision\",\"type\":\"address\"}],\"name\":\"setRevision\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FileHash\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FileData\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isSealed\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Name\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Description\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_PrevOwner\",\"type\":\"address\"}],\"name\":\"setPrevOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"FileName\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Revision\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"PrevOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_Description\",\"type\":\"string\"},{\"name\":\"_FileName\",\"type\":\"string\"},{\"name\":\"_FileHash\",\"type\":\"string\"},{\"name\":\"_FileData\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventNewOwner\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventNewPrevOwner\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventNewRevision\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventSealed\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventSetCreator\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"}],\"name\":\"EventSetOwner\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"self\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"method\",\"type\":\"string\"}],\"name\":\"EventReady\",\"type\":\"event\"}]","ContractName":"DocumentCertoChainContract","CompilerVersion":"v0.5.6+commit.b259423e","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000001c00000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000001164d6f6c746520706f73736962696c6974c3a020646920636f6d706f73697a696f6e653a2073656469612c20706f6c74726f6e63696e612c20706f6c74726f6e612c20706f6c74726f6e612072656c61782c20646976616e6f2c2073676162656c6c6f20626173736f2c2073676162656c6c6f20616c746f2c2070616e63612c206563632e20436f6d6f646974c3a0206261736174612073756c6c6120666c6573736962696c6974c3a02064656920636f6d706f6e656e746920696e206163636961696f2e204d616767696f726520616572617a696f6e6520726973706574746f20616c6c65207365647574652074726164697a696f6e616c693b207069c3b920696769656e652065207069c3b920636f6d666f72742e00000000000000000000000000000000000000000000000000000000000000000000000000000000001a72656769737472617a2e646174612031396d616731392e70646600000000000000000000000000000000000000000000000000000000000000000000000000477368613235363a62353564646434323731623332343134343266323764326462633130363239656133333139663761393662353336626137366464633539333861323561383831000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036323031392d30352d31392031333a32373a33302e30343132333237202b303230302043455354206d3d2b31332e36363333323631303100000000000000000000","Library":"","SwarmSource":"bzzr://b624dd4f9ff5a7861f3e9607225bd013e07fd67d5930a7e6e5c258a16347f615"}]}