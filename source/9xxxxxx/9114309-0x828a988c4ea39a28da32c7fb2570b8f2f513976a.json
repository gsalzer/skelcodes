{"status":"1","message":"OK","result":[{"SourceCode":"/**\r\n *Submitted for verification at Etherscan.io on 2019-09-09\r\n * BEB dapp for www.betbeb.com\r\n*/\r\npragma solidity^0.4.24;  \r\ninterface tokenTransfer {\r\n    function transfer(address receiver, uint amount);\r\n    function transferFrom(address _from, address _to, uint256 _value);\r\n    function balanceOf(address receiver) returns(uint256);\r\n}\r\n\r\ncontract Ownable {\r\n  address public owner;\r\n \r\n    function Ownable () public {\r\n        owner = msg.sender;\r\n    }\r\n \r\n    modifier onlyOwner {\r\n        require (msg.sender == owner);\r\n        _;\r\n    }\r\n \r\n    /**\r\n     * @param  newOwner address\r\n     */\r\n    function transferOwnership(address newOwner) onlyOwner public {\r\n        if (newOwner != address(0)) {\r\n        owner = newOwner;\r\n      }\r\n    }\r\n}\r\n\r\ncontract BebExchang is Ownable{\r\n    uint256 BEBMIN;//买卖最小数量\r\n    uint256 BEBMAX;//买卖最大数量\r\n    uint256 BEBjiage;//最新价格\r\n    uint256 sellAmount;//卖出总量\r\n    uint256 buyAmount;//买入总量\r\n    uint256 sumAmount;//历史成交总金额\r\n    struct userSell{\r\n        uint256 amount;//总金额\r\n        uint256 value;//数量\r\n        uint256 exbl;//汇率比例\r\n        bool vote;//状态\r\n    }\r\n    struct userBuy{\r\n        uint256 amount;//总金额\r\n        uint256 exbl;//beb-ETH\r\n        uint256 value;//数量\r\n        bool vote;//状态\r\n    }\r\n    mapping(address=>userSell)public userSells;\r\n    mapping(address=>userBuy)public userBuys;\r\n    tokenTransfer public bebTokenTransfer; //代币\r\n    function BebExchang(address _tokenAddress){\r\n         bebTokenTransfer = tokenTransfer(_tokenAddress);\r\n     }\r\n     //卖出订单的参数价格_amount、_value需要乘方后传给合约\r\n     function sellGD(uint256 _amount,uint256 _value)public{\r\n         require(tx.origin == msg.sender);\r\n         userSell storage _user=userSells[msg.sender];\r\n         require(!_user.vote,\"Please cancel the order first.\");\r\n         require(_amount>0 & _value,\"No 0\");\r\n         require( _value>=BEBMIN,\"Not less than the lower limit of sale！\");\r\n         require( _value<=BEBMAX,\"No higher than the sale ceiling！\");\r\n         uint256 _exbl=1000000000000000000/_amount;//计算汇率\r\n         uint256 _eth=_value/_exbl;\r\n         bebTokenTransfer.transferFrom(msg.sender,address(this),_value);//转入BEB\r\n         _user.amount=_eth;\r\n         _user.value=_value;\r\n         _user.exbl=_exbl;\r\n         _user.vote=true;\r\n     }\r\n     //买入订单的参数价格_amount需要乘方后传给合约\r\n     function BuyGD(uint256 _amount)payable public{\r\n         require(tx.origin == msg.sender);\r\n         userBuy storage _users=userBuys[msg.sender];\r\n         require(!_users.vote,\"Please cancel the order first.\");\r\n         require(_amount>0,\"No 0\");\r\n         require( msg.value>0,\"Sorry, your credit is running low\");\r\n         uint256 _amounts=msg.value;\r\n         uint256 _exbls=1000000000000000000/_amount;//计算汇率\r\n         uint256 bebamount=_amounts*_exbls;\r\n         require( bebamount>=BEBMIN,\"Not less than the lower limit of sale！\");\r\n         require( bebamount<=BEBMAX,\"No higher than the sale ceiling！\");\r\n         _users.amount=_amounts;\r\n         _users.exbl=_exbls;\r\n         _users.value=bebamount;\r\n         _users.vote=true;\r\n     }\r\n     //实时卖出BEB，_value需要乘方后传给合约\r\n     function bebToSell(address addr,uint256 _value)public{\r\n         require(tx.origin == msg.sender);\r\n        require(addr != address(0),\"Address cannot be empty\");\r\n        userBuy storage _user=userBuys[addr];\r\n        require(_user.vote,\"The opposite party can't trade without a receipt\");\r\n        require(_user.value >= _value,\"No more than sellers\");\r\n        uint256 _sender=_value/_user.exbl;\r\n        bebTokenTransfer.transferFrom(msg.sender,addr,_value);//转BEB给收购方\r\n        msg.sender.transfer(_sender);\r\n        BEBjiage=_user.exbl;\r\n        _user.amount-=_sender;//递减卖家金额\r\n        _user.value-=_value;//递减卖家BEB数量\r\n        sellAmount+=_value;\r\n        sumAmount+=_sender;\r\n        if(_user.value==0){\r\n            _user.amount=0;\r\n            _user.exbl=0;\r\n            _user.vote=false;\r\n        }\r\n     }\r\n     //实时买入BEB\r\n     function buyToBeb(address addr)payable public{\r\n         require(tx.origin == msg.sender);\r\n        require(addr != address(0),\"Address cannot be empty\");\r\n        require( msg.value>0,\"Sorry, your credit is running low\");\r\n        userSell storage _user=userSells[addr];\r\n        require(_user.vote,\"The opposite party can't trade without a receipt\");\r\n        uint256 amounts=msg.value;\r\n        uint256 buyamount=_user.exbl*amounts;\r\n        require(_user.value >= buyamount,\"No more than sellers\");\r\n        bebTokenTransfer.transfer(msg.sender,buyamount);//转账给购买方\r\n        BEBjiage=_user.exbl;\r\n        addr.transfer(amounts);//转账ETH给出售方\r\n        _user.amount-=amounts;//递减卖家金额\r\n        _user.value-=buyamount;//递减卖家BEB数量\r\n        buyAmount+=buyamount;\r\n        sumAmount+=amounts;\r\n        if(_user.value==0){\r\n            _user.amount=0;\r\n            _user.exbl=0;\r\n            _user.vote=false;\r\n        }\r\n     }\r\n     //撤卖单\r\n     function BebSellCheDan()public{\r\n         require(tx.origin == msg.sender);\r\n        userSell storage _user=userSells[msg.sender];\r\n        require(_user.vote,\"You don't have a ticket！\");\r\n        bebTokenTransfer.transfer(msg.sender,_user.value);//退回BEB\r\n        _user.value=0;\r\n        _user.amount=0;\r\n        _user.exbl=0;\r\n        _user.vote=false;\r\n     }\r\n     //撤买单\r\n     function BebBuyCheDan()public{\r\n         require(tx.origin == msg.sender);\r\n        userBuy storage _userS=userBuys[msg.sender];\r\n        require(_userS.vote,\"You don't have a ticket！\");\r\n        msg.sender.transfer(_userS.amount);//退回eth\r\n        _userS.value=0;\r\n        _userS.amount=0;\r\n        _userS.exbl=0;\r\n        _userS.vote=false; \r\n     }\r\n     //修改买单价格，价格需要乘方后传入\r\n     function BuyPriceRevision(uint256 _amount)public{\r\n         require(tx.origin == msg.sender);\r\n        userBuy storage _userS=userBuys[msg.sender];\r\n        require(_userS.vote,\"You don't have a ticket！\");\r\n        uint256 _exbls=1000000000000000000/_amount;//计算汇率\r\n        uint256 _eth=_userS.value/_exbls;\r\n        _userS.amount=_eth;\r\n        _userS.exbl=_exbls;\r\n     }\r\n     //修改买单价格，价格需要乘方后传入\r\n     function SellPriceRevision(uint256 _amount)public{\r\n         require(tx.origin == msg.sender);\r\n        userSell storage _userS=userSells[msg.sender];\r\n        require(_userS.vote,\"You don't have a ticket！\");\r\n        uint256 _exbls=1000000000000000000/_amount;//计算汇率\r\n        uint256 _eth=_userS.value/_exbls;\r\n        _userS.amount=_eth;\r\n        _userS.exbl=_exbls;\r\n     }\r\n     //管理员更改交易数量的上限和下限\r\n     function setExchangMINorMAX(uint256 _MIN,uint256 _MAX)onlyOwner{\r\n        BEBMIN=_MIN*10**18;\r\n        BEBMAX=_MAX*10**18;\r\n     }\r\n     //我的卖出挂单查询\r\n     function MySell(address _addr)public view returns(uint256,uint256,uint256,bool){\r\n         userSell storage _user=userSells[_addr];\r\n        return (_user.amount,_user.value,_user.exbl,_user.vote);\r\n    }\r\n    //我的买入挂单查询\r\n    function MyBuy(address _addr)public view returns(uint256,uint256,uint256,bool){\r\n         userBuy storage _user=userBuys[_addr];\r\n         \r\n        return (_user.amount,_user.value,_user.exbl,_user.vote);\r\n    }\r\n    function BEBwithdrawAmount(uint256 amount) onlyOwner {\r\n        uint256 _amount=amount* 10 ** 18;\r\n        bebTokenTransfer.transfer(owner,_amount);//原路退回BEB\r\n    }\r\n    function withdrawEther(uint256 amount) onlyOwner{\r\n\t\t//if(msg.sender != owner)throw;\r\n\t\towner.transfer(amount);\r\n\t}\r\n    //交易所交易数量的下限、上限、最新成交价格、卖出总量、买入总量、历史成交金额\r\n    function ExchangMINorMAX()public view returns(uint256,uint256,uint256,uint256,uint256,uint256){\r\n        return (BEBMIN,BEBMAX,BEBjiage,sellAmount,buyAmount,sumAmount);\r\n    }\r\n    function ()payable{\r\n        \r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"bebTokenTransfer\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"userSells\",\"outputs\":[{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"value\",\"type\":\"uint256\"},{\"name\":\"exbl\",\"type\":\"uint256\"},{\"name\":\"vote\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"BEBwithdrawAmount\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"bebToSell\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdrawEther\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ExchangMINorMAX\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"userBuys\",\"outputs\":[{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"exbl\",\"type\":\"uint256\"},{\"name\":\"value\",\"type\":\"uint256\"},{\"name\":\"vote\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"},{\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"sellGD\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"SellPriceRevision\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"BebBuyCheDan\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"BuyGD\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"BebSellCheDan\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"BuyPriceRevision\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"buyToBeb\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"MySell\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"MyBuy\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_MIN\",\"type\":\"uint256\"},{\"name\":\"_MAX\",\"type\":\"uint256\"}],\"name\":\"setExchangMINorMAX\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"}]","ContractName":"BebExchang","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"0000000000000000000000006798cc8ad079a7e663536f83ee26d63aabe03da9","Library":"","LicenseType":"None","SwarmSource":"bzzr://8c34a2beeb5c29de4abbe9aad5da0ac8e61b9124598249341991ce5694510cff"}]}