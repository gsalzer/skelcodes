{"status":"1","message":"OK","result":[{"SourceCode":"// Solidity Interface\r\n\r\npragma solidity ^0.5.11;\r\n\r\ncontract UniswapFactoryInterface {\r\n    // Public Variables\r\n    address public exchangeTemplate;\r\n    uint256 public tokenCount;\r\n    // Create Exchange\r\n    function createExchange(address token) external returns (address exchange);\r\n    // Get Exchange and Token Info\r\n    function getExchange(address token) external view returns (address exchange);\r\n    function getToken(address exchange) external view returns (address token);\r\n    function getTokenWithId(uint256 tokenId) external view returns (address token);\r\n    // Never use\r\n    function initializeFactory(address template) external;\r\n}// Solidity Interface\r\n\r\n\r\ncontract UniswapExchangeInterface {\r\n    // Address of ERC20 token sold on this exchange\r\n    function tokenAddress() external view returns (address token);\r\n    // Address of Uniswap Factory\r\n    function factoryAddress() external view returns (address factory);\r\n    // Provide Liquidity\r\n    function addLiquidity(uint256 min_liquidity, uint256 max_tokens, uint256 deadline) external payable returns (uint256);\r\n    function removeLiquidity(uint256 amount, uint256 min_eth, uint256 min_tokens, uint256 deadline) external returns (uint256, uint256);\r\n    // Get Prices\r\n    function getEthToTokenInputPrice(uint256 eth_sold) external view returns (uint256 tokens_bought);\r\n    function getEthToTokenOutputPrice(uint256 tokens_bought) external view returns (uint256 eth_sold);\r\n    function getTokenToEthInputPrice(uint256 tokens_sold) external view returns (uint256 eth_bought);\r\n    function getTokenToEthOutputPrice(uint256 eth_bought) external view returns (uint256 tokens_sold);\r\n    // Trade ETH to ERC20\r\n    function ethToTokenSwapInput(uint256 min_tokens, uint256 deadline) external payable returns (uint256  tokens_bought);\r\n    function ethToTokenTransferInput(uint256 min_tokens, uint256 deadline, address recipient) external payable returns (uint256  tokens_bought);\r\n    function ethToTokenSwapOutput(uint256 tokens_bought, uint256 deadline) external payable returns (uint256  eth_sold);\r\n    function ethToTokenTransferOutput(uint256 tokens_bought, uint256 deadline, address recipient) external payable returns (uint256  eth_sold);\r\n    // Trade ERC20 to ETH\r\n    function tokenToEthSwapInput(uint256 tokens_sold, uint256 min_eth, uint256 deadline) external returns (uint256  eth_bought);\r\n    function tokenToEthTransferInput(uint256 tokens_sold, uint256 min_eth, uint256 deadline, address recipient) external returns (uint256  eth_bought);\r\n    function tokenToEthSwapOutput(uint256 eth_bought, uint256 max_tokens, uint256 deadline) external returns (uint256  tokens_sold);\r\n    function tokenToEthTransferOutput(uint256 eth_bought, uint256 max_tokens, uint256 deadline, address recipient) external returns (uint256  tokens_sold);\r\n    // Trade ERC20 to ERC20\r\n    function tokenToTokenSwapInput(uint256 tokens_sold, uint256 min_tokens_bought, uint256 min_eth_bought, uint256 deadline, address token_addr) external returns (uint256  tokens_bought);\r\n    function tokenToTokenTransferInput(uint256 tokens_sold, uint256 min_tokens_bought, uint256 min_eth_bought, uint256 deadline, address recipient, address token_addr) external returns (uint256  tokens_bought);\r\n    function tokenToTokenSwapOutput(uint256 tokens_bought, uint256 max_tokens_sold, uint256 max_eth_sold, uint256 deadline, address token_addr) external returns (uint256  tokens_sold);\r\n    function tokenToTokenTransferOutput(uint256 tokens_bought, uint256 max_tokens_sold, uint256 max_eth_sold, uint256 deadline, address recipient, address token_addr) external returns (uint256  tokens_sold);\r\n    // Trade ERC20 to Custom Pool\r\n    function tokenToExchangeSwapInput(uint256 tokens_sold, uint256 min_tokens_bought, uint256 min_eth_bought, uint256 deadline, address exchange_addr) external returns (uint256  tokens_bought);\r\n    function tokenToExchangeTransferInput(uint256 tokens_sold, uint256 min_tokens_bought, uint256 min_eth_bought, uint256 deadline, address recipient, address exchange_addr) external returns (uint256  tokens_bought);\r\n    function tokenToExchangeSwapOutput(uint256 tokens_bought, uint256 max_tokens_sold, uint256 max_eth_sold, uint256 deadline, address exchange_addr) external returns (uint256  tokens_sold);\r\n    function tokenToExchangeTransferOutput(uint256 tokens_bought, uint256 max_tokens_sold, uint256 max_eth_sold, uint256 deadline, address recipient, address exchange_addr) external returns (uint256  tokens_sold);\r\n    // ERC20 comaptibility for liquidity tokens\r\n    bytes32 public name;\r\n    bytes32 public symbol;\r\n    uint256 public decimals;\r\n    function transfer(address _to, uint256 _value) external returns (bool);\r\n    function transferFrom(address _from, address _to, uint256 value) external returns (bool);\r\n    function approve(address _spender, uint256 _value) external returns (bool);\r\n    function allowance(address _owner, address _spender) external view returns (uint256);\r\n    function balanceOf(address _owner) external view returns (uint256);\r\n    function totalSupply() external view returns (uint256);\r\n    // Never use\r\n    function setup(address token_addr) external;\r\n}/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n\r\n\r\n/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n\r\n\r\n/// @title ITokenSeller\r\n/// @dev Use this contract to sell tokenS for as many tokenB.\r\n/// @author Daniel Wang  - <daniel@loopring.org>\r\ncontract ITokenSeller\r\n{\r\n    /// @dev Sells all tokenS for tokenB\r\n    /// @param tokenS The token or Ether (0x0) to sell.\r\n    /// @param tokenB The token to buy.\r\n    /// @return success True if success, false otherwise.\r\n    function sellToken(\r\n        address tokenS,\r\n        address tokenB\r\n        )\r\n        external\r\n        payable\r\n        returns (bool success);\r\n}\r\n\r\n/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n\r\n\r\n\r\n/// @title ERC20 Token Interface\r\n/// @dev see https://github.com/ethereum/EIPs/issues/20\r\n/// @author Daniel Wang - <daniel@loopring.org>\r\ncontract ERC20\r\n{\r\n    function totalSupply()\r\n        public\r\n        view\r\n        returns (uint);\r\n\r\n    function balanceOf(\r\n        address who\r\n        )\r\n        public\r\n        view\r\n        returns (uint);\r\n\r\n    function allowance(\r\n        address owner,\r\n        address spender\r\n        )\r\n        public\r\n        view\r\n        returns (uint);\r\n\r\n    function transfer(\r\n        address to,\r\n        uint value\r\n        )\r\n        public\r\n        returns (bool);\r\n\r\n    function transferFrom(\r\n        address from,\r\n        address to,\r\n        uint    value\r\n        )\r\n        public\r\n        returns (bool);\r\n\r\n    function approve(\r\n        address spender,\r\n        uint    value\r\n        )\r\n        public\r\n        returns (bool);\r\n}\r\n\r\n/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n\r\n\r\n\r\n/// @title Utility Functions for uint\r\n/// @author Daniel Wang - <daniel@loopring.org>\r\nlibrary MathUint\r\n{\r\n    function mul(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint c)\r\n    {\r\n        c = a * b;\r\n        require(a == 0 || c / a == b, \"MUL_OVERFLOW\");\r\n    }\r\n\r\n    function sub(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint)\r\n    {\r\n        require(b <= a, \"SUB_UNDERFLOW\");\r\n        return a - b;\r\n    }\r\n\r\n    function add(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint c)\r\n    {\r\n        c = a + b;\r\n        require(c >= a, \"ADD_OVERFLOW\");\r\n    }\r\n\r\n    function decodeFloat(\r\n        uint f\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint value)\r\n    {\r\n        uint numBitsMantissa = 23;\r\n        uint exponent = f >> numBitsMantissa;\r\n        uint mantissa = f & ((1 << numBitsMantissa) - 1);\r\n        value = mantissa * (10 ** exponent);\r\n    }\r\n}\r\n\r\n/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\n\r\n\r\n\r\n/// @title ReentrancyGuard\r\n/// @author Brecht Devos - <brecht@loopring.org>\r\n/// @dev Exposes a modifier that guards a function against reentrancy\r\n///      Changing the value of the same storage value multiple times in a transaction\r\n///      is cheap (starting from Istanbul) so there is no need to minimize\r\n///      the number of times the value is changed\r\ncontract ReentrancyGuard\r\n{\r\n    //The default value must be 0 in order to work behind a proxy.\r\n    uint private _guardValue;\r\n\r\n    // Use this modifier on a function to prevent reentrancy\r\n    modifier nonReentrant()\r\n    {\r\n        // Check if the guard value has its original value\r\n        require(_guardValue == 0, \"REENTRANCY\");\r\n\r\n        // Set the value to something else\r\n        _guardValue = 1;\r\n\r\n        // Function body\r\n        _;\r\n\r\n        // Set the value back\r\n        _guardValue = 0;\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n/// @title An ITokenSeller that sells token on Uniswap.\r\n/// @dev This contract will sell all tokens or Ether received to other tokens or Ether\r\n//       using the Uniswap contracts.\r\n/// @author Daniel Wang  - <daniel@loopring.org>\r\ncontract UniswapTokenSeller is ReentrancyGuard, ITokenSeller {\r\n\r\n    using MathUint for uint;\r\n\r\n    uint256 constant MAX_UINT = ~uint(0);\r\n    uint    public constant MAX_SLIPPAGE_BIPS = 100; // 1 percent\r\n    address public uniswapFactoryAddress; // 0xc0a47dFe034B400B47bDaD5FecDa2621de6c4d95 on live\r\n    address public recipient;\r\n\r\n    event TokenSold (\r\n        address indexed seller,\r\n        address indexed recipient,\r\n        address         tokenS,\r\n        address         tokenB,\r\n        uint            amountS,\r\n        uint            amountB,\r\n        uint8           slippage,\r\n        uint64          time\r\n    );\r\n\r\n    constructor(\r\n        address _uniswapFactoryAddress,\r\n        address _recipient\r\n        )\r\n        public\r\n    {\r\n        require(_uniswapFactoryAddress != address(0), \"ZERO_ADDRESS\");\r\n        uniswapFactoryAddress = _uniswapFactoryAddress;\r\n        recipient = _recipient;\r\n    }\r\n\r\n    function() external payable { }\r\n\r\n    function sellToken(\r\n        address tokenS,\r\n        address tokenB\r\n        )\r\n        external\r\n        payable\r\n        nonReentrant\r\n        returns (bool success)\r\n    {\r\n        require(tokenS != tokenB, \"SAME_TOKEN\");\r\n\r\n        // If `recipient` is set to non-zero, we send all purchased Ether/token to it.\r\n        address _recipient = recipient == address(0) ? msg.sender : recipient;\r\n        uint  amountS; // amount to sell\r\n        uint  amountB; // amount bought\r\n        uint8 slippage;\r\n        UniswapExchangeInterface exchange;\r\n\r\n        if (tokenS == address(0)) {\r\n            // Sell ETH to ERC20\r\n            amountS = address(this).balance;\r\n            require(amountS > 0, \"ZERO_AMOUNT\");\r\n            exchange = getUniswapExchange(tokenB);\r\n\r\n            slippage = getSlippage(\r\n                exchange.getEthToTokenInputPrice(amountS),\r\n                exchange.getEthToTokenInputPrice(amountS.mul(2))\r\n            );\r\n\r\n            amountB = exchange.ethToTokenTransferInput.value(amountS)(\r\n                1,  // min_tokens_bought\r\n                MAX_UINT,\r\n                _recipient\r\n            );\r\n        } else {\r\n            // Selling ERC20 to ETH or other ERC20\r\n            amountS = ERC20(tokenS).balanceOf(address(this));\r\n            require(amountS > 0, \"ZERO_AMOUNT\");\r\n            exchange = getUniswapExchange(tokenS);\r\n\r\n            approveUniswapExchange(exchange, tokenS, amountS);\r\n\r\n            if (tokenB == address(0)) {\r\n                // Sell ERC20 to ETH\r\n                slippage = getSlippage(\r\n                    exchange.getTokenToEthInputPrice(amountS),\r\n                    exchange.getTokenToEthInputPrice(amountS.mul(2))\r\n                );\r\n\r\n                amountB = exchange.tokenToEthTransferInput(\r\n                    amountS,\r\n                    1,  // min_eth_bought\r\n                    MAX_UINT,\r\n                    _recipient\r\n                );\r\n            } else {\r\n                // Sell ERC20 to ERC20\r\n                UniswapExchangeInterface exchangeB = getUniswapExchange(tokenB);\r\n                slippage = getSlippage(\r\n                    exchangeB.getEthToTokenInputPrice(exchange.getTokenToEthInputPrice(amountS)),\r\n                    exchangeB.getEthToTokenInputPrice(exchange.getTokenToEthInputPrice(amountS.mul(2)))\r\n                );\r\n\r\n                amountB = exchange.tokenToTokenTransferInput(\r\n                    amountS,\r\n                    1, //  min_tokens_bought\r\n                    1, //  min_eth_bought\r\n                    MAX_UINT,\r\n                    _recipient,\r\n                    tokenB\r\n                );\r\n            }\r\n        }\r\n\r\n        emit TokenSold(\r\n            msg.sender,\r\n            _recipient,\r\n            tokenS,\r\n            tokenB,\r\n            amountS,\r\n            amountB,\r\n            slippage,\r\n            uint64(now)\r\n        );\r\n\r\n        return true;\r\n    }\r\n\r\n    function getUniswapExchange(address token)\r\n        private\r\n        view\r\n        returns (UniswapExchangeInterface)\r\n    {\r\n        UniswapFactoryInterface factory = UniswapFactoryInterface(uniswapFactoryAddress);\r\n        return UniswapExchangeInterface(factory.getExchange(token));\r\n    }\r\n\r\n    function approveUniswapExchange(\r\n        UniswapExchangeInterface exchange,\r\n        address tokenS,\r\n        uint    amountS\r\n        )\r\n        private\r\n    {\r\n        ERC20 token = ERC20(tokenS);\r\n        uint allowance = token.allowance(address(this), address(exchange));\r\n        if (allowance < amountS) {\r\n            require(\r\n                token.approve(address(exchange), MAX_UINT),\r\n                \"APPROVAL_FAILURE\"\r\n            );\r\n        }\r\n    }\r\n\r\n    function getSlippage(\r\n        uint amountB,\r\n        uint amountB2\r\n        )\r\n        private\r\n        pure\r\n        returns (uint8)\r\n    {\r\n        require(amountB > 0 && amountB2 > 0, \"INVALID_PRICE\");\r\n        uint slippageBips = amountB.mul(2).sub(amountB2).mul(10000) / amountB;\r\n        require(slippageBips <= MAX_SLIPPAGE_BIPS, \"SLIPPAGE_TOO_LARGE\");\r\n        return uint8(slippageBips);\r\n    }\r\n}","ABI":"[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_uniswapFactoryAddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_recipient\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"seller\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"recipient\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"tokenS\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"tokenB\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amountS\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"amountB\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint8\",\"name\":\"slippage\",\"type\":\"uint8\"},{\"indexed\":false,\"internalType\":\"uint64\",\"name\":\"time\",\"type\":\"uint64\"}],\"name\":\"TokenSold\",\"type\":\"event\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"constant\":true,\"inputs\":[],\"name\":\"MAX_SLIPPAGE_BIPS\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"recipient\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"tokenS\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"tokenB\",\"type\":\"address\"}],\"name\":\"sellToken\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"success\",\"type\":\"bool\"}],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"uniswapFactoryAddress\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"UniswapTokenSeller","CompilerVersion":"v0.5.16+commit.9c3226ce","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"000000000000000000000000c0a47dfe034b400b47bdad5fecda2621de6c4d950000000000000000000000000000000000000000000000000000000000000000","Library":"","LicenseType":"None","SwarmSource":"bzzr://e80387ffc4c2fca8499dcf896e92d54820f794d690d2539502874af3b6056460"}]}