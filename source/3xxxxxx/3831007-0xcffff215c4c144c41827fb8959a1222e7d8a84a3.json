{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.11;\r\n\r\ncontract CreditIDENTITY{\r\n    \r\n    address public creditDao;\r\n    \r\n    uint public nextFieldIndex;\r\n    mapping (uint => string) avaliableFields;\r\n    mapping (string => bool) fieldActivated;\r\n    mapping (string => uint) fieldTypes;\r\n    \r\n    mapping (address => string) addressDescriptions;\r\n    \r\n    uint public nextIdentityAccount;\r\n    mapping (uint => mapping (bytes => bytes)) identityAccounts;\r\n    mapping (address => uint) public addressToAccountMap;\r\n    \r\n    mapping (address => mapping(address => uint)) mappingProposal;\r\n    \r\n    event MappingProposalIssued(address _addressThatMapped, address _addressToMap, uint identityId);\r\n    event MappingDone(address _addressToMap, uint identityId);\r\n    event AddressDescriptionAdded(address _source, string _description);\r\n    \r\n    function CreditIDENTITY(address _creditDao) {\r\n        nextFieldIndex = 1;\r\n        nextIdentityAccount = 1;\r\n        creditDao = _creditDao;\r\n    }\r\n    \r\n    function addAddressDescription(string _addressDescription){\r\n        addressDescriptions[msg.sender] = _addressDescription;\r\n        AddressDescriptionAdded(msg.sender, _addressDescription);\r\n    }\r\n    \r\n    function getFieldData(uint _index) constant returns (uint, bytes, bool, uint){\r\n        string tempField = avaliableFields[_index];\r\n        bytes memory tempByteField = bytes(tempField);\r\n        return (_index, tempByteField, fieldActivated[tempField], fieldTypes[tempField]);\r\n    }\r\n    \r\n    function addAccountData(string _field, bytes _data){\r\n        if (fieldActivated[_field] != true) throw;\r\n        bytes memory fieldBytes = bytes(_field);\r\n        if (addressToAccountMap[msg.sender] == 0){\r\n            identityAccounts[nextIdentityAccount][fieldBytes] = _data;\r\n            addressToAccountMap[msg.sender] = nextIdentityAccount;\r\n            nextIdentityAccount += 1;\r\n        }else{\r\n            uint accountId = addressToAccountMap[msg.sender];\r\n            identityAccounts[accountId][fieldBytes] = _data;\r\n        }\r\n    }\r\n    \r\n    function addAddressMappingProposal(address _addressToMap){\r\n        if (addressToAccountMap[msg.sender] == 0) throw;\r\n        \r\n        mappingProposal[msg.sender][_addressToMap] = addressToAccountMap[msg.sender];\r\n        MappingProposalIssued(msg.sender, _addressToMap, addressToAccountMap[msg.sender]);\r\n    }\r\n    \r\n    function approveMappingProposal(address _addressThatMapped) {\r\n        if (mappingProposal[_addressThatMapped][msg.sender] == 0) throw;\r\n        \r\n        uint tempId = mappingProposal[_addressThatMapped][msg.sender];\r\n        addressToAccountMap[msg.sender] = tempId;\r\n        mappingProposal[_addressThatMapped][msg.sender] = 0;\r\n        MappingDone(msg.sender, tempId);\r\n    }\r\n    \r\n    function getAccountData(address _accountAddress, string _field) constant returns (bytes){\r\n        return identityAccounts[addressToAccountMap[_accountAddress]][bytes(_field)];\r\n    }\r\n    \r\n    function getAddressDescription(address _queryAddress) constant returns (string){\r\n        return addressDescriptions[_queryAddress];\r\n    }\r\n    \r\n    //\r\n    // Admin features\r\n    //\r\n    function addField(string _fieldName, uint _fieldType){\r\n        if (msg.sender != creditDao) throw;\r\n        if (_fieldType == 0) throw;\r\n        if (fieldTypes[_fieldName] != 0) throw;\r\n        \r\n        avaliableFields[nextFieldIndex] = _fieldName;\r\n        fieldActivated[_fieldName] = true;\r\n        fieldTypes[_fieldName] = _fieldType;\r\n        \r\n        nextFieldIndex += 1;\r\n    }\r\n    \r\n    function toggleFieldActivation(string _fieldName){\r\n        if (msg.sender != creditDao) throw;\r\n        if (fieldTypes[_fieldName] == 0) throw;\r\n        \r\n        fieldActivated[_fieldName] = !fieldActivated[_fieldName];\r\n    }\r\n    \r\n    function editAddressDescription(address _targetAddress, string _addressDescription){\r\n        if (msg.sender != creditDao) throw;\r\n        \r\n        addressDescriptions[_targetAddress] = _addressDescription;\r\n    }\r\n    \r\n    function editAccountData(address _targetAddress, string _field, bytes _data){\r\n        if (msg.sender != creditDao) throw;\r\n        \r\n        identityAccounts[addressToAccountMap[_targetAddress]][bytes(_field)] = _data;\r\n    }\r\n    \r\n    function setCreditDao(address _newCreditDao){\r\n        if (msg.sender != creditDao) throw;\r\n        creditDao = _newCreditDao;\r\n    }\r\n    \r\n    function killContract() {\r\n        if (msg.sender != creditDao) throw;\r\n        selfdestruct(creditDao);\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[],\"name\":\"killContract\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_addressThatMapped\",\"type\":\"address\"}],\"name\":\"approveMappingProposal\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"creditDao\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_field\",\"type\":\"string\"},{\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"addAccountData\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"addressToAccountMap\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_targetAddress\",\"type\":\"address\"},{\"name\":\"_addressDescription\",\"type\":\"string\"}],\"name\":\"editAddressDescription\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_targetAddress\",\"type\":\"address\"},{\"name\":\"_field\",\"type\":\"string\"},{\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"editAccountData\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_accountAddress\",\"type\":\"address\"},{\"name\":\"_field\",\"type\":\"string\"}],\"name\":\"getAccountData\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"nextFieldIndex\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_addressToMap\",\"type\":\"address\"}],\"name\":\"addAddressMappingProposal\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_fieldName\",\"type\":\"string\"},{\"name\":\"_fieldType\",\"type\":\"uint256\"}],\"name\":\"addField\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_index\",\"type\":\"uint256\"}],\"name\":\"getFieldData\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"bytes\"},{\"name\":\"\",\"type\":\"bool\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_addressDescription\",\"type\":\"string\"}],\"name\":\"addAddressDescription\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_queryAddress\",\"type\":\"address\"}],\"name\":\"getAddressDescription\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newCreditDao\",\"type\":\"address\"}],\"name\":\"setCreditDao\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_fieldName\",\"type\":\"string\"}],\"name\":\"toggleFieldActivation\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"nextIdentityAccount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"inputs\":[{\"name\":\"_creditDao\",\"type\":\"address\"}],\"payable\":false,\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_addressThatMapped\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_addressToMap\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"identityId\",\"type\":\"uint256\"}],\"name\":\"MappingProposalIssued\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_addressToMap\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"identityId\",\"type\":\"uint256\"}],\"name\":\"MappingDone\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_source\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_description\",\"type\":\"string\"}],\"name\":\"AddressDescriptionAdded\",\"type\":\"event\"}]","ContractName":"CreditIDENTITY","CompilerVersion":"v0.4.11+commit.68ef5810","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"000000000000000000000000bc0c17e44eca10b7a58f7e66e6c471ef96de4e36","Library":"","SwarmSource":"bzzr://59602f3cca5f6b0dc629afa75541776e35074a4e497f997b8b4d03262cdffae2"}]}