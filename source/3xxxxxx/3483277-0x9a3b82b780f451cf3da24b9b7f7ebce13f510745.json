{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.10;\r\n/**\r\n * Smart Meter Gatway Aministration for StromDAO Stromkonto\r\n * ====================================================================\r\n * Slot-Link f체r intelligente Messsysteme zur Freigabe einer Orakel-gesteuerten\r\n * Z채hlrestandsgang-Messung. Wird verwendet zur Emulierung eines autarken \r\n * Lieferanten/Abnehmer Managements in einem HSM oder P2P Markt ohne zentrale\r\n * Kontrollstelle.\r\n * \r\n * Kontakt V0.1: \r\n * Thorsten Zoerner <thorsten.zoerner(at)stromdao.de)\r\n * https://stromdao.de/\r\n */\r\n\r\n\r\ncontract owned {\r\n     address public owner;\r\n\r\n    function owned() {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    modifier onlyOwner {\r\n        if (msg.sender != owner) throw;\r\n        _;\r\n    }\r\n\r\n    function transferOwnership(address newOwner) onlyOwner {\r\n        owner = newOwner;\r\n    }\r\n}\r\n\r\ncontract GWALink is owned {\r\n    uint80 constant None = uint80(0); \r\n    \r\n    // Freigaben f체r einzelne Nodes\r\n    struct ClearanceLimits {\r\n        uint256 min_time;\r\n        uint256 min_power;\r\n        uint256 max_time;\r\n        uint256 max_power;\r\n        address definedBy;\r\n        bool valid;\r\n    }\r\n    \r\n    // Representation eines Z채hlerstandes\r\n    struct ZS {\r\n        uint256 time;\r\n        uint256 power;\r\n        address oracle;\r\n    }\r\n    \r\n    event recleared(address link);\r\n    \r\n    ClearanceLimits public defaultLimits = ClearanceLimits(1,1,86400,1000,owner,true);\r\n    mapping(address=>ClearanceLimits) public clearances;\r\n    mapping(address=>ZS) public  zss;\r\n    \r\n    function changeDefaults(uint256 _min_time,uint256 _min_power,uint256 _max_time, uint256 _max_power,bool _clearance) onlyOwner {\r\n        defaultLimits = ClearanceLimits(_min_time,_min_power,_max_time,_max_power,msg.sender,_clearance);\r\n    }\r\n    \r\n    function  _retrieveClearance(address link) private returns (ClearanceLimits) {\r\n        ClearanceLimits  limits = defaultLimits;\r\n        if(clearances[msg.sender].definedBy==owner) { limits=clearances[msg.sender];}\r\n        if(clearances[link].definedBy==owner) { limits=clearances[link];}\r\n        return limits;\r\n    }\r\n    \r\n    function getClearance(address link) returns (uint256, uint256,uint256,uint256,address,bool) {\r\n        ClearanceLimits memory limits = _retrieveClearance(link);\r\n        return (limits.min_time,limits.min_power,limits.max_time,limits.max_power,limits.definedBy,limits.valid);\r\n    }\r\n    \r\n    function changeMPO(address link) onlyOwner {\r\n         ZS zs = zss[link];\r\n         zs.oracle=msg.sender;\r\n         zs.time=now;\r\n         zss[link]=zs;\r\n    }\r\n    \r\n    function changeZS(address link,uint256 _power) onlyOwner {\r\n         ZS zs = zss[link];\r\n         zs.oracle=msg.sender;\r\n         zs.time=now;\r\n         zs.power=_power;\r\n         zss[link]=zs;\r\n        \r\n    }\r\n    function reclear(address stromkonto_or_oracle,uint256 _min_time,uint256 _min_power,uint256 _max_time, uint256 _max_power,bool clearance) onlyOwner {\r\n           clearances[stromkonto_or_oracle]=ClearanceLimits(_min_time,_min_power,_max_time,_max_power,msg.sender,clearance);\r\n           recleared(stromkonto_or_oracle);\r\n    }\r\n    \r\n    function ping(address link,uint256 delta_time,uint256 delta_power) {\r\n        ClearanceLimits memory limits = _retrieveClearance(link);\r\n        if(!limits.valid) {  throw; }\r\n        if(limits.min_power>delta_power) throw;\r\n        if(limits.max_power<delta_power) throw;\r\n        if(limits.min_time>delta_time) throw;\r\n        if(limits.max_time<delta_time) throw;\r\n        \r\n        ZS zs = zss[link];\r\n        \r\n        if(zs.time==0) {\r\n            zs.oracle=msg.sender;\r\n            zs.time=now;\r\n        }\r\n        \r\n        zs.time+=delta_time;\r\n        zs.power+=delta_power;\r\n        zss[link]=zs;\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"stromkonto_or_oracle\",\"type\":\"address\"},{\"name\":\"_min_time\",\"type\":\"uint256\"},{\"name\":\"_min_power\",\"type\":\"uint256\"},{\"name\":\"_max_time\",\"type\":\"uint256\"},{\"name\":\"_max_power\",\"type\":\"uint256\"},{\"name\":\"clearance\",\"type\":\"bool\"}],\"name\":\"reclear\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"clearances\",\"outputs\":[{\"name\":\"min_time\",\"type\":\"uint256\"},{\"name\":\"min_power\",\"type\":\"uint256\"},{\"name\":\"max_time\",\"type\":\"uint256\"},{\"name\":\"max_power\",\"type\":\"uint256\"},{\"name\":\"definedBy\",\"type\":\"address\"},{\"name\":\"valid\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"link\",\"type\":\"address\"},{\"name\":\"delta_time\",\"type\":\"uint256\"},{\"name\":\"delta_power\",\"type\":\"uint256\"}],\"name\":\"ping\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"link\",\"type\":\"address\"}],\"name\":\"getClearance\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_min_time\",\"type\":\"uint256\"},{\"name\":\"_min_power\",\"type\":\"uint256\"},{\"name\":\"_max_time\",\"type\":\"uint256\"},{\"name\":\"_max_power\",\"type\":\"uint256\"},{\"name\":\"_clearance\",\"type\":\"bool\"}],\"name\":\"changeDefaults\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"defaultLimits\",\"outputs\":[{\"name\":\"min_time\",\"type\":\"uint256\"},{\"name\":\"min_power\",\"type\":\"uint256\"},{\"name\":\"max_time\",\"type\":\"uint256\"},{\"name\":\"max_power\",\"type\":\"uint256\"},{\"name\":\"definedBy\",\"type\":\"address\"},{\"name\":\"valid\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"link\",\"type\":\"address\"}],\"name\":\"changeMPO\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"zss\",\"outputs\":[{\"name\":\"time\",\"type\":\"uint256\"},{\"name\":\"power\",\"type\":\"uint256\"},{\"name\":\"oracle\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"link\",\"type\":\"address\"},{\"name\":\"_power\",\"type\":\"uint256\"}],\"name\":\"changeZS\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"link\",\"type\":\"address\"}],\"name\":\"recleared\",\"type\":\"event\"}]","ContractName":"GWALink","CompilerVersion":"v0.4.10+commit.f0d539ae","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://26c16849eec1c6d851f2ddbea0affc37f491455bd65fa11aec665e967cf47742"}]}