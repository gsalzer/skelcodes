{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.4;\r\n/**\r\n * @title Contract for object that have an owner\r\n */\r\ncontract Owned {\r\n    /**\r\n     * Contract owner address\r\n     */\r\n    address public owner;\r\n\r\n    /**\r\n     * @dev Store owner on creation\r\n     */\r\n    function Owned() { owner = msg.sender; }\r\n\r\n    /**\r\n     * @dev Delegate contract to another person\r\n     * @param _owner is another person address\r\n     */\r\n    function delegate(address _owner) onlyOwner\r\n    { owner = _owner; }\r\n\r\n    /**\r\n     * @dev Owner check modifier\r\n     */\r\n    modifier onlyOwner { if (msg.sender != owner) throw; _; }\r\n}\r\n\r\n\r\n/**\r\n * @title Contract for objects that can be morder\r\n */\r\ncontract Mortal is Owned {\r\n    /**\r\n     * @dev Destroy contract and scrub a data\r\n     * @notice Only owner can kill me\r\n     */\r\n    function kill() onlyOwner\r\n    { suicide(owner); }\r\n}\r\n\r\n\r\ncontract Comission is Mortal {\r\n    address public ledger;\r\n    bytes32 public taxman;\r\n    uint    public taxPerc;\r\n\r\n    /**\r\n     * @dev Comission contract constructor\r\n     * @param _ledger Processing ledger contract\r\n     * @param _taxman Tax receiver account\r\n     * @param _taxPerc Processing tax in percent\r\n     */\r\n    function Comission(address _ledger, bytes32 _taxman, uint _taxPerc) {\r\n        ledger  = _ledger;\r\n        taxman  = _taxman;\r\n        taxPerc = _taxPerc;\r\n    }\r\n\r\n    /**\r\n     * @dev Refill ledger with comission\r\n     * @param _destination Destination account\r\n     */\r\n    function process(bytes32 _destination) payable returns (bool) {\r\n        // Handle value below 100 isn't possible\r\n        if (msg.value < 100) throw;\r\n\r\n        var tax = msg.value * taxPerc / 100; \r\n        var refill = bytes4(sha3(\"refill(bytes32)\")); \r\n        if ( !ledger.call.value(tax)(refill, taxman)\r\n          || !ledger.call.value(msg.value - tax)(refill, _destination)\r\n           ) throw;\r\n        return true;\r\n    }\r\n}\r\n\r\n\r\nlibrary CreatorComission {\r\n    function create(address _ledger, bytes32 _taxman, uint256 _taxPerc) returns (Comission)\r\n    { return new Comission(_ledger, _taxman, _taxPerc); }\r\n\r\n    function version() constant returns (string)\r\n    { return \"v0.5.0 (a9ea4c6c)\"; }\r\n\r\n    function abi() constant returns (string)\r\n    { return '[{\"constant\":false,\"inputs\":[{\"name\":\"_destination\",\"type\":\"bytes32\"}],\"name\":\"process\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":true,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"taxman\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ledger\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"delegate\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"taxPerc\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"inputs\":[{\"name\":\"_ledger\",\"type\":\"address\"},{\"name\":\"_taxman\",\"type\":\"bytes32\"},{\"name\":\"_taxPerc\",\"type\":\"uint256\"}],\"type\":\"constructor\"}]'; }\r\n}\r\n\r\n\r\n/**\r\n * @title Builder based contract\r\n */\r\ncontract Builder is Mortal {\r\n    /**\r\n     * @dev this event emitted for every builded contract\r\n     */\r\n    event Builded(address indexed client, address indexed instance);\r\n \r\n    /* Addresses builded contracts at sender */\r\n    mapping(address => address[]) public getContractsOf;\r\n \r\n    /**\r\n     * @dev Get last address\r\n     * @return last address contract\r\n     */\r\n    function getLastContract() constant returns (address) {\r\n        var sender_contracts = getContractsOf[msg.sender];\r\n        return sender_contracts[sender_contracts.length - 1];\r\n    }\r\n\r\n    /* Building beneficiary */\r\n    address public beneficiary;\r\n\r\n    /**\r\n     * @dev Set beneficiary\r\n     * @param _beneficiary is address of beneficiary\r\n     */\r\n    function setBeneficiary(address _beneficiary) onlyOwner\r\n    { beneficiary = _beneficiary; }\r\n\r\n    /* Building cost  */\r\n    uint public buildingCostWei;\r\n\r\n    /**\r\n     * @dev Set building cost\r\n     * @param _buildingCostWei is cost\r\n     */\r\n    function setCost(uint _buildingCostWei) onlyOwner\r\n    { buildingCostWei = _buildingCostWei; }\r\n\r\n    /* Security check report */\r\n    string public securityCheckURI;\r\n\r\n    /**\r\n     * @dev Set security check report URI\r\n     * @param _uri is an URI to report\r\n     */\r\n    function setSecurityCheck(string _uri) onlyOwner\r\n    { securityCheckURI = _uri; }\r\n}\r\n\r\n//\r\n// AIRA Builder for Comission contract\r\n//\r\n\r\n/**\r\n * @title BuilderComission contract\r\n */\r\ncontract BuilderComission is Builder {\r\n    /**\r\n     * @dev Run script creation contract\r\n     * @return address new contract\r\n     */\r\n    function create(address _ledger, bytes32 _taxman, uint _taxPerc,\r\n                    address _client) payable returns (address) {\r\n        if (buildingCostWei > 0 && beneficiary != 0) {\r\n            // Too low value\r\n            if (msg.value < buildingCostWei) throw;\r\n            // Beneficiary send\r\n            if (!beneficiary.send(buildingCostWei)) throw;\r\n            // Refund\r\n            if (msg.value > buildingCostWei) {\r\n                if (!msg.sender.send(msg.value - buildingCostWei)) throw;\r\n            }\r\n        } else {\r\n            // Refund all\r\n            if (msg.value > 0) {\r\n                if (!msg.sender.send(msg.value)) throw;\r\n            }\r\n        }\r\n\r\n        if (_client == 0)\r\n            _client = msg.sender;\r\n \r\n        var inst = CreatorComission.create(_ledger, _taxman, _taxPerc);\r\n        inst.delegate(_client);\r\n        Builded(_client, inst);\r\n        getContractsOf[_client].push(inst);\r\n        return inst;\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_uri\",\"type\":\"string\"}],\"name\":\"setSecurityCheck\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_beneficiary\",\"type\":\"address\"}],\"name\":\"setBeneficiary\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"beneficiary\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"kill\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_buildingCostWei\",\"type\":\"uint256\"}],\"name\":\"setCost\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"delegate\",\"outputs\":[],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"buildingCostWei\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_ledger\",\"type\":\"address\"},{\"name\":\"_taxman\",\"type\":\"bytes32\"},{\"name\":\"_taxPerc\",\"type\":\"uint256\"},{\"name\":\"_client\",\"type\":\"address\"}],\"name\":\"create\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":true,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getLastContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"getContractsOf\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"securityCheckURI\",\"outputs\":[{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"client\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"instance\",\"type\":\"address\"}],\"name\":\"Builded\",\"type\":\"event\"}]","ContractName":"BuilderComission","CompilerVersion":"v0.4.4+commit.4633f3de","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"CreatorComission:9053d234a1ff2290f087a1ca9460e3263121e580","SwarmSource":""}]}