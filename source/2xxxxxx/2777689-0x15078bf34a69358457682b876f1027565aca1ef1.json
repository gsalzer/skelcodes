{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.4.4;\r\n\r\ncontract Owned {\r\n    address public contractOwner;\r\n    address public pendingContractOwner;\r\n\r\n    function Owned() {\r\n        contractOwner = msg.sender;\r\n    }\r\n\r\n    modifier onlyContractOwner() {\r\n        if (contractOwner == msg.sender) {\r\n            _;\r\n        }\r\n    }\r\n\r\n    function changeContractOwnership(address _to) onlyContractOwner() returns(bool) {\r\n        pendingContractOwner = _to;\r\n        return true;\r\n    }\r\n\r\n    function claimContractOwnership() returns(bool) {\r\n        if (pendingContractOwner != msg.sender) {\r\n            return false;\r\n        }\r\n        contractOwner = pendingContractOwner;\r\n        delete pendingContractOwner;\r\n        return true;\r\n    }\r\n}\r\n\r\ncontract PropyPrototype is Owned {\r\n    struct IdentityProvider {\r\n        string metadata;\r\n    }\r\n\r\n    struct Owner {\r\n        uint identityVerificationId;\r\n        address identityVerificationProvider;\r\n        bool status; // unverified/verified\r\n        string metadata;\r\n    }\r\n\r\n    struct Title {\r\n        string legalAddress;\r\n        bytes32 ownerId;\r\n        bytes32 lastDeedId;\r\n        bool status; // executed/pending\r\n        string metadata;\r\n    }\r\n\r\n    struct Deed {\r\n        bytes32 titleId;\r\n        bytes32 buyerId;\r\n        bytes32 sellerId;\r\n        uint status; // in progress/notarized/cancelled\r\n        string metadata;\r\n    }\r\n\r\n    mapping(address => IdentityProvider) identityProviders;\r\n    mapping(bytes32 => Owner) owners;\r\n    mapping(bytes32 => Title) titles;\r\n    bytes32[] public titleIds;\r\n    mapping(bytes32 => Deed) deeds;\r\n    bytes32[] public deedIds;\r\n\r\n    function putIdentityProvider(address _address, string _metadata) onlyContractOwner() returns(bool success) {\r\n        identityProviders[_address].metadata = _metadata;\r\n        return true;\r\n    }\r\n\r\n    function getIdentityProvider(address _address) constant returns(string metadata) {\r\n        return identityProviders[_address].metadata;\r\n    }\r\n\r\n    function putOwner(bytes32 _id, uint _identityVerificationId, address _identityVerificationProvider, bool _status, string _metadata) onlyContractOwner() returns(bool success) {\r\n        owners[_id] = Owner(_identityVerificationId, _identityVerificationProvider, _status, _metadata);\r\n        return true;\r\n    }\r\n\r\n    function getOwner(bytes32 _id) constant returns(uint identityVerificationId, string identityProvider, string status, string metadata) {\r\n        var owner = owners[_id];\r\n        return (\r\n            owner.identityVerificationId,\r\n            getIdentityProvider(owner.identityVerificationProvider),\r\n            owner.status ? \"Verified\" : \"Unverified\",\r\n            owner.metadata\r\n        );\r\n    }\r\n\r\n    function putTitle(bytes32 _id, string _legalAddress, bytes32 _ownerId, bytes32 _lastDeedId, bool _status, string _metadata) onlyContractOwner() returns(bool success) {\r\n        if (bytes(_legalAddress).length == 0) {\r\n            return false;\r\n        }\r\n        if (owners[_ownerId].identityVerificationProvider == 0x0) {\r\n            return false;\r\n        }\r\n        if (bytes(titles[_id].legalAddress).length == 0) {\r\n            titleIds.push(_id);\r\n        }\r\n        titles[_id] = Title(_legalAddress, _ownerId, _lastDeedId, _status, _metadata);\r\n        return true;\r\n    }\r\n\r\n    function getTitle(bytes32 _id) constant returns(string legalAddress, bytes32 ownerId, string owner, bytes32 lastDeedId, string lastDeed, string status, string metadata) {\r\n        var title = titles[_id];\r\n        return (\r\n            title.legalAddress,\r\n            title.ownerId,\r\n            owners[title.ownerId].metadata,\r\n            title.lastDeedId,\r\n            deeds[title.lastDeedId].metadata,\r\n            title.status ? \"Executed\" : \"Pending\",\r\n            title.metadata\r\n        );\r\n    }\r\n\r\n    function getDeedId(bytes32 _titleId, uint _index) constant returns(bytes32) {\r\n        return sha3(_titleId, _index);\r\n    }\r\n\r\n    function putDeed(bytes32 _titleId, uint _index, bytes32 _buyerId, bytes32 _sellerId, uint _status, string _metadata) onlyContractOwner() returns(bool success) {\r\n        if (bytes(titles[_titleId].legalAddress).length == 0) {\r\n            return false;\r\n        }\r\n        if (owners[_buyerId].identityVerificationProvider == 0x0) {\r\n            return false;\r\n        }\r\n        if (owners[_sellerId].identityVerificationProvider == 0x0) {\r\n            return false;\r\n        }\r\n        if (_status > 2) {\r\n            return false;\r\n        }\r\n        bytes32 id = getDeedId(_titleId, _index);\r\n        if (uint(deeds[id].titleId) == 0) {\r\n            deedIds.push(id);\r\n        }\r\n        deeds[id] = Deed(_titleId, _buyerId, _sellerId, _status, _metadata);\r\n        return true;\r\n    }\r\n\r\n    function getDeed(bytes32 _id) constant returns(bytes32 titleId, string title, bytes32 buyerId, string buyer, bytes32 sellerId, string seller, string status, string metadata) {\r\n        var deed = deeds[_id];\r\n        return (\r\n            deed.titleId,\r\n            titles[deed.titleId].metadata,\r\n            deed.buyerId,\r\n            owners[deed.buyerId].metadata,\r\n            deed.sellerId,\r\n            owners[deed.sellerId].metadata,\r\n            deed.status == 0 ? \"In Progress\" :\r\n                deed.status == 1 ? \"Notarized\" : \"Cancelled\",\r\n            deed.metadata\r\n        );\r\n    }\r\n\r\n    // Should not be used in non constant functions!\r\n    function getTitleDeeds(bytes32 _titleId) constant returns(bytes32[]) {\r\n        uint deedsCount = 0;\r\n        while(uint(deeds[getDeedId(_titleId, deedsCount)].titleId) != 0) {\r\n            deedsCount++;\r\n        }\r\n        bytes32[] memory result = new bytes32[](deedsCount);\r\n        for (uint i = 0; i < deedsCount; i++) {\r\n            result[i] = getDeedId(_titleId, i);\r\n        }\r\n        return result;\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"_titleId\",\"type\":\"bytes32\"}],\"name\":\"getTitleDeeds\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32[]\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"getIdentityProvider\",\"outputs\":[{\"name\":\"metadata\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_id\",\"type\":\"bytes32\"},{\"name\":\"_identityVerificationId\",\"type\":\"uint256\"},{\"name\":\"_identityVerificationProvider\",\"type\":\"address\"},{\"name\":\"_status\",\"type\":\"bool\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"putOwner\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getTitle\",\"outputs\":[{\"name\":\"legalAddress\",\"type\":\"string\"},{\"name\":\"ownerId\",\"type\":\"bytes32\"},{\"name\":\"owner\",\"type\":\"string\"},{\"name\":\"lastDeedId\",\"type\":\"bytes32\"},{\"name\":\"lastDeed\",\"type\":\"string\"},{\"name\":\"status\",\"type\":\"string\"},{\"name\":\"metadata\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_titleId\",\"type\":\"bytes32\"},{\"name\":\"_index\",\"type\":\"uint256\"}],\"name\":\"getDeedId\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"claimContractOwnership\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"changeContractOwnership\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pendingContractOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_id\",\"type\":\"bytes32\"},{\"name\":\"_legalAddress\",\"type\":\"string\"},{\"name\":\"_ownerId\",\"type\":\"bytes32\"},{\"name\":\"_lastDeedId\",\"type\":\"bytes32\"},{\"name\":\"_status\",\"type\":\"bool\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"putTitle\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_titleId\",\"type\":\"bytes32\"},{\"name\":\"_index\",\"type\":\"uint256\"},{\"name\":\"_buyerId\",\"type\":\"bytes32\"},{\"name\":\"_sellerId\",\"type\":\"bytes32\"},{\"name\":\"_status\",\"type\":\"uint256\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"putDeed\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_address\",\"type\":\"address\"},{\"name\":\"_metadata\",\"type\":\"string\"}],\"name\":\"putIdentityProvider\",\"outputs\":[{\"name\":\"success\",\"type\":\"bool\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"titleIds\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"deedIds\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"contractOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"identityVerificationId\",\"type\":\"uint256\"},{\"name\":\"identityProvider\",\"type\":\"string\"},{\"name\":\"status\",\"type\":\"string\"},{\"name\":\"metadata\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_id\",\"type\":\"bytes32\"}],\"name\":\"getDeed\",\"outputs\":[{\"name\":\"titleId\",\"type\":\"bytes32\"},{\"name\":\"title\",\"type\":\"string\"},{\"name\":\"buyerId\",\"type\":\"bytes32\"},{\"name\":\"buyer\",\"type\":\"string\"},{\"name\":\"sellerId\",\"type\":\"bytes32\"},{\"name\":\"seller\",\"type\":\"string\"},{\"name\":\"status\",\"type\":\"string\"},{\"name\":\"metadata\",\"type\":\"string\"}],\"payable\":false,\"type\":\"function\"}]","ContractName":"PropyPrototype","CompilerVersion":"v0.4.4+commit.4633f3de","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":""}]}