{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.2;\r\n\r\ncontract EC {\r\n\r\n    uint256 constant gx = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798;\r\n    uint256 constant gy = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8;\r\n    uint256 constant n = 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F;\r\n    uint256 constant a = 0;\r\n    uint256 constant b = 7;\r\n\r\n    function EC()\r\n    {\r\n    }\r\n\r\n    function _jAdd( uint256 x1,uint256 z1,\r\n                    uint256 x2,uint256 z2) constant\r\n        returns(uint256 x3,uint256 z3)\r\n    {\r\n        (x3, z3) = (  addmod( mulmod(z2, x1 , n) ,\r\n                              mulmod(x2, z1 , n),\r\n                              n),\r\n                      mulmod(z1, z2 , n)\r\n                    );\r\n    }\r\n\r\n    function _jSub( uint256 x1,uint256 z1,\r\n                    uint256 x2,uint256 z2) constant\r\n        returns(uint256 x3,uint256 z3)\r\n    {\r\n        (x3, z3) = (  addmod( mulmod(z2, x1, n),\r\n                              mulmod(n - x2, z1, n),\r\n                              n),\r\n                      mulmod(z1, z2 , n)\r\n                    );\r\n    }\r\n\r\n    function _jMul( uint256 x1,uint256 z1,\r\n                    uint256 x2,uint256 z2) constant\r\n        returns(uint256 x3,uint256 z3)\r\n    {\r\n        (x3, z3) = (  mulmod(x1, x2 , n), mulmod(z1, z2 , n));\r\n    }\r\n\r\n    function _jDiv( uint256 x1,uint256 z1,\r\n                    uint256 x2,uint256 z2) constant\r\n        returns(uint256 x3,uint256 z3)\r\n    {\r\n        (x3, z3) = (  mulmod(x1, z2 , n), mulmod(z1 , x2 , n));\r\n    }\r\n\r\n    function _inverse( uint256 a) constant\r\n        returns(uint256 invA)\r\n    {\r\n        uint256 t=0;\r\n        uint256 newT=1;\r\n        uint256 r=n;\r\n        uint256 newR=a;\r\n        uint256 q;\r\n        while (newR != 0) {\r\n            q = r / newR;\r\n\r\n            (t, newT) = (newT, addmod(t , (n - mulmod(q, newT,n)) , n));\r\n            (r, newR) = (newR, r - q * newR );\r\n        }\r\n\r\n        return t;\r\n    }\r\n\r\n\r\n    function _ecAdd( uint256 x1,uint256 y1,uint256 z1,\r\n                    uint256 x2,uint256 y2,uint256 z2) constant\r\n        returns(uint256 x3,uint256 y3,uint256 z3)\r\n    {\r\n        uint256 l;\r\n        uint256 lz;\r\n        uint256 da;\r\n        uint256 db;\r\n\r\n        if ((x1==0)&&(y1==0)) {\r\n            return (x2,y2,z2);\r\n        }\r\n\r\n        if ((x2==0)&&(y2==0)) {\r\n            return (x1,y1,z1);\r\n        }\r\n\r\n        if ((x1==x2)&&(y1==y2)) {\r\n            (l,lz) = _jMul(x1, z1, x1, z1);\r\n            (l,lz) = _jMul(l, lz, 3, 1);\r\n            (l,lz) = _jAdd(l, lz, a, 1);\r\n\r\n            (da,db) = _jMul(y1, z1, 2, 1);\r\n        } else {\r\n            (l,lz) = _jSub(y2, z2, y1, z1);\r\n            (da,db)  = _jSub(x2, z2, x1, z1);\r\n        }\r\n\r\n        (l, lz) = _jDiv(l, lz, da, db);\r\n\r\n\r\n        (x3, da) = _jMul(l, lz, l, lz);\r\n        (x3, da) = _jSub(x3, da, x1, z1);\r\n        (x3, da) = _jSub(x3, da, x2, z2);\r\n\r\n        (y3, db) = _jSub(x1, z1, x3, da);\r\n        (y3, db) = _jMul(y3, db, l, lz );\r\n        (y3, db) = _jSub(y3, db, y1, z1 );\r\n\r\n\r\n        if (da != db) {\r\n            x3 = mulmod(x3, db, n);\r\n            y3 = mulmod(y3, da, n);\r\n            z3 = mulmod(da, db, n);\r\n        } else {\r\n            z3 = da;\r\n        }\r\n\r\n    }\r\n\r\n    function _ecDouble(uint256 x1,uint256 y1,uint256 z1) constant\r\n        returns(uint256 x3,uint256 y3,uint256 z3)\r\n    {\r\n        (x3,y3,z3) = _ecAdd(x1,y1,z1,x1,y1,z1);\r\n    }\r\n\r\n\r\n\r\n    function _ecMul(uint256 d, uint256 x1,uint256 y1,uint256 z1) constant\r\n        returns(uint256 x3,uint256 y3,uint256 z3)\r\n    {\r\n        uint256 remaining = d;\r\n        uint256 px = x1;\r\n        uint256 py = y1;\r\n        uint256 pz = z1;\r\n        uint256 acx = 0;\r\n        uint256 acy = 0;\r\n        uint256 acz = 1;\r\n\r\n        if (d==0) {\r\n            return (0,0,1);\r\n        }\r\n\r\n        while (remaining != 0) {\r\n            if ((remaining & 1) != 0) {\r\n                (acx,acy,acz) = _ecAdd(acx,acy,acz, px,py,pz);\r\n            }\r\n            remaining = remaining / 2;\r\n            (px,py,pz) = _ecDouble(px,py,pz);\r\n        }\r\n\r\n        (x3,y3,z3) = (acx,acy,acz);\r\n    }\r\n\r\n    function publicKey(uint256 privKey) constant\r\n        returns(uint256 qx, uint256 qy)\r\n    {\r\n        uint256 x;\r\n        uint256 y;\r\n        uint256 z;\r\n        (x,y,z) = _ecMul(privKey, gx, gy, 1);\r\n        z = _inverse(z);\r\n        qx = mulmod(x , z ,n);\r\n        qy = mulmod(y , z ,n);\r\n    }\r\n\r\n    function deriveKey(uint256 privKey, uint256 pubX, uint256 pubY) constant\r\n        returns(uint256 qx, uint256 qy)\r\n    {\r\n        uint256 x;\r\n        uint256 y;\r\n        uint256 z;\r\n        (x,y,z) = _ecMul(privKey, pubX, pubY, 1);\r\n        z = _inverse(z);\r\n        qx = mulmod(x , z ,n);\r\n        qy = mulmod(y , z ,n);\r\n    }\r\n\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"},{\"name\":\"x2\",\"type\":\"uint256\"},{\"name\":\"z2\",\"type\":\"uint256\"}],\"name\":\"_jAdd\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"},{\"name\":\"x2\",\"type\":\"uint256\"},{\"name\":\"z2\",\"type\":\"uint256\"}],\"name\":\"_jSub\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"},{\"name\":\"x2\",\"type\":\"uint256\"},{\"name\":\"z2\",\"type\":\"uint256\"}],\"name\":\"_jMul\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"},{\"name\":\"x2\",\"type\":\"uint256\"},{\"name\":\"z2\",\"type\":\"uint256\"}],\"name\":\"_jDiv\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"privKey\",\"type\":\"uint256\"}],\"name\":\"publicKey\",\"outputs\":[{\"name\":\"qx\",\"type\":\"uint256\"},{\"name\":\"qy\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"a\",\"type\":\"uint256\"}],\"name\":\"_inverse\",\"outputs\":[{\"name\":\"invA\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"d\",\"type\":\"uint256\"},{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"y1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"}],\"name\":\"_ecMul\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"y3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"y1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"},{\"name\":\"x2\",\"type\":\"uint256\"},{\"name\":\"y2\",\"type\":\"uint256\"},{\"name\":\"z2\",\"type\":\"uint256\"}],\"name\":\"_ecAdd\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"y3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"privKey\",\"type\":\"uint256\"},{\"name\":\"pubX\",\"type\":\"uint256\"},{\"name\":\"pubY\",\"type\":\"uint256\"}],\"name\":\"deriveKey\",\"outputs\":[{\"name\":\"qx\",\"type\":\"uint256\"},{\"name\":\"qy\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"x1\",\"type\":\"uint256\"},{\"name\":\"y1\",\"type\":\"uint256\"},{\"name\":\"z1\",\"type\":\"uint256\"}],\"name\":\"_ecDouble\",\"outputs\":[{\"name\":\"x3\",\"type\":\"uint256\"},{\"name\":\"y3\",\"type\":\"uint256\"},{\"name\":\"z3\",\"type\":\"uint256\"}],\"payable\":false,\"type\":\"function\"},{\"inputs\":[],\"type\":\"constructor\"}]","ContractName":"EC","CompilerVersion":"v0.4.2+commit.af6afb04","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":""}]}