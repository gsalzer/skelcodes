{"status":"1","message":"OK","result":[{"SourceCode":"// SPDX-License-Identifier: MIT\r\npragma solidity ^0.8.0;\r\n\r\ninterface IERC20 {\r\n    function balanceOf(address _owner) external returns (uint256);\r\n    function transfer(address _to, uint256 _amount) external;\r\n    function transferFrom(address _from, address _to, uint256 _amount) external;\r\n    function mint(address _to, uint256 _amount) external;\r\n    function burn(uint256 _amount) external;\r\n}\r\n\r\ncontract BridgeOperatable {\r\n    address public owner;\r\n    address public operator1;\r\n    address public operator2;\r\n\r\n    event OwnershipTransferred(address indexed _from, address indexed _to);\r\n    event Operator1Transferred(address indexed _from, address indexed _to);\r\n    event Operator2Transferred(address indexed _from, address indexed _to);\r\n\r\n    constructor() {\r\n        owner = msg.sender;\r\n        operator1 = msg.sender;\r\n        operator2 = msg.sender;\r\n    }\r\n\r\n    modifier onlyOwner {\r\n        require(msg.sender == owner, 'onlyOwner: insufficient privilege');\r\n        _;\r\n    }\r\n\r\n    modifier onlyOperator1 {\r\n        require(msg.sender == operator1, 'onlyOperator1: insufficient privilege');\r\n        _;\r\n    }\r\n\r\n    modifier onlyOperator2 {\r\n        require(msg.sender == operator2, 'onlyOperator2: insufficient privilege');\r\n        _;\r\n    }\r\n\r\n    function transferOwner(address _owner) public onlyOwner {\r\n        emit Operator1Transferred(owner, _owner);\r\n        owner = _owner;\r\n    }\r\n\r\n    function transferOperator1(address _operator1) public onlyOwner {\r\n        emit Operator1Transferred(operator1, _operator1);\r\n        operator1 = _operator1;\r\n    }\r\n\r\n    function transferOperator2(address _operator2) public onlyOwner {\r\n        emit Operator2Transferred(operator2, _operator2);\r\n        operator2 = _operator2;\r\n    }\r\n}\r\n\r\ncontract NodokaBridge is BridgeOperatable {\r\n    mapping(address => Token) public tokens;\r\n    mapping(address => Token) public pairs;\r\n    mapping(address => address payable) public treasury; \r\n\r\n    struct Token {\r\n        bool active;\r\n        address tokenAddress;\r\n        bool isERC20;  // false: native, true: ERC20\r\n        bool mintable; // false: unlock, true: mint\r\n        bool burnable; // false: lock,   true: burn\r\n        uint256 minAmount;\r\n        uint256 maxAmount;\r\n    }\r\n    \r\n    event Bridge(address indexed _from, address indexed _token1, address indexed _token2, address _to, uint256 _amount);\r\n    event Trigger(address indexed _from, address indexed _token, address _to, uint256 _amount);\r\n\r\n    constructor() {}\r\n    \r\n    function setPair(address _token1, bool _mintable, bool _burnable, address _token2) external onlyOwner returns (bool) {\r\n        Token memory token1 = Token(true, _token1, _token1 == address(0) ? false: true, _mintable, _burnable, 1, 2**256-1);\r\n        Token memory token2 = Token(true, _token2, _token2 == address(0) ? false: true, false, false, 1, 2**256-1);\r\n        \r\n        tokens[_token1] = token1;\r\n        pairs[_token1] = token2;\r\n        return true;\r\n    }\r\n    \r\n    function removePair(address _token1) external onlyOwner returns (bool) {\r\n        pairs[_token1] = Token(true, address(0), false, false, false, 0, 0);\r\n        return true;\r\n    }\r\n\r\n    function setMinMax(address _token, uint256 _minAmount, uint256 _maxAmount) external onlyOwner returns (bool) {\r\n        tokens[_token].minAmount = _minAmount;\r\n        tokens[_token].maxAmount = _maxAmount;\r\n        return true;\r\n    }\r\n\r\n    function setTreasury(address _token, address payable _treasury) external onlyOwner returns (bool) {\r\n        treasury[_token] = _treasury;\r\n        return true;\r\n    }\r\n    \r\n    receive() external payable {\r\n        // Do nothing\r\n    }\r\n    \r\n    function deposit(address _token, address _to, uint256 _amount) external payable returns (bool) {\r\n        Token memory token1 = tokens[_token];\r\n        Token memory token2 = pairs[_token];\r\n        require(token2.active, \"the token is not acceptable\");\r\n        require(_amount >= token1.minAmount, 'amount is less than min');\r\n        require(_amount <= token1.maxAmount || token1.maxAmount == 0, 'amount ecxeeds max');\r\n\r\n        if (token1.isERC20) {\r\n            IERC20 token = IERC20(_token);\r\n            token.transferFrom(msg.sender, address(this), _amount);\r\n\r\n            if (token1.burnable) {\r\n                token.burn(_amount);\r\n            }\r\n\r\n            emit Bridge(msg.sender, token1.tokenAddress, token2.tokenAddress, _to, _amount);\r\n        } else {\r\n            token1 = tokens[address(0)];\r\n            token2 = pairs[address(0)];\r\n            require(msg.value > 0, \"msg.value is zero\");\r\n            require(token2.active, \"the native token is not acceptable\");\r\n\r\n            emit Bridge(msg.sender, token1.tokenAddress, token2.tokenAddress, msg.sender, msg.value);\r\n        }\r\n        \r\n        return true;\r\n    }\r\n\r\n    function withdraw(address _token, uint256 _amount) external onlyOperator1 returns (bool) {\r\n        if(_token == address(0)) {\r\n            // Native token\r\n            require(address(this).balance >= _amount, 'insufficient balance');\r\n            treasury[_token].transfer(_amount);\r\n        } else {\r\n            // ERC20 token\r\n            IERC20 token = IERC20(_token);\r\n            require(token.balanceOf(address(this)) >= _amount, 'insufficient balance');\r\n            token.transfer(treasury[_token], _amount);\r\n        }\r\n        return true;\r\n    }\r\n    \r\n    function trigger(address _token, address payable _to, uint256 _amount) external onlyOperator2 returns (bool) {\r\n        Token memory token = tokens[_token];\r\n        require(token.active, \"the token is inactive\");\r\n\r\n        if (!token.isERC20) {\r\n            // Native token\r\n            _to.transfer(_amount);\r\n        } else if (token.mintable) {\r\n            // Mintable ERC20\r\n            IERC20(token.tokenAddress).mint(_to, _amount);\r\n        } else {\r\n            // Non-mintable ERC20 \r\n            IERC20(token.tokenAddress).transfer(_to, _amount);\r\n        }\r\n        return true;\r\n    }\r\n}","ABI":"[{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_token1\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_token2\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Bridge\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"Operator1Transferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"Operator2Transferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"Trigger\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"deposit\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"operator1\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"operator2\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"pairs\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"active\",\"type\":\"bool\"},{\"internalType\":\"address\",\"name\":\"tokenAddress\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"isERC20\",\"type\":\"bool\"},{\"internalType\":\"bool\",\"name\":\"mintable\",\"type\":\"bool\"},{\"internalType\":\"bool\",\"name\":\"burnable\",\"type\":\"bool\"},{\"internalType\":\"uint256\",\"name\":\"minAmount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"maxAmount\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token1\",\"type\":\"address\"}],\"name\":\"removePair\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_minAmount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_maxAmount\",\"type\":\"uint256\"}],\"name\":\"setMinMax\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token1\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"_mintable\",\"type\":\"bool\"},{\"internalType\":\"bool\",\"name\":\"_burnable\",\"type\":\"bool\"},{\"internalType\":\"address\",\"name\":\"_token2\",\"type\":\"address\"}],\"name\":\"setPair\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"address payable\",\"name\":\"_treasury\",\"type\":\"address\"}],\"name\":\"setTreasury\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"tokens\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"active\",\"type\":\"bool\"},{\"internalType\":\"address\",\"name\":\"tokenAddress\",\"type\":\"address\"},{\"internalType\":\"bool\",\"name\":\"isERC20\",\"type\":\"bool\"},{\"internalType\":\"bool\",\"name\":\"mintable\",\"type\":\"bool\"},{\"internalType\":\"bool\",\"name\":\"burnable\",\"type\":\"bool\"},{\"internalType\":\"uint256\",\"name\":\"minAmount\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"maxAmount\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_operator1\",\"type\":\"address\"}],\"name\":\"transferOperator1\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_operator2\",\"type\":\"address\"}],\"name\":\"transferOperator2\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"transferOwner\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"treasury\",\"outputs\":[{\"internalType\":\"address payable\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"address payable\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"trigger\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_token\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdraw\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}]","ContractName":"NodokaBridge","CompilerVersion":"v0.8.7+commit.e28d00a7","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"MIT","Proxy":"0","Implementation":"","SwarmSource":"ipfs://011deabd495a73178f8dff8bc4aa3315adc8e79af8aded45d90e084891d88863"}]}