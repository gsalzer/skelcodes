{"status":"1","message":"OK","result":[{"SourceCode":"// Copyright (C) 2021  Argent Labs Ltd. <https://argent.xyz>\r\n\r\n// This program is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n\r\n// This program is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n\r\n// You should have received a copy of the GNU General Public License\r\n// along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n// SPDX-License-Identifier: GPL-3.0-only\r\npragma solidity ^0.8.3;\r\n\r\ninterface IFilter {\r\n    function isValid(address _wallet, address _spender, address _to, bytes calldata _data) external view returns (bool valid);\r\n}\r\n\r\nabstract contract BaseFilter is IFilter {\r\n    function getMethod(bytes memory _data) internal pure returns (bytes4 method) {\r\n        // solhint-disable-next-line no-inline-assembly\r\n        assembly {\r\n            method := mload(add(_data, 0x20))\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * @title ZkSyncFilter\r\n * @notice Filter used to claim your zkSync account.\r\n * @author Axel Delamarre - <axel@argent.xyz>\r\n */\r\ncontract ZkSyncFilter is BaseFilter {\r\n\r\n  bytes4 private constant SET_AUTH_PUBKEY_HASH = bytes4(keccak256(\"setAuthPubkeyHash(bytes,uint32)\"));\r\n\r\n  function isValid(address /*_wallet*/, address _spender, address _to, bytes calldata _data) external pure override returns (bool valid) {\r\n    // disable ETH transfer\r\n    if (_data.length < 4) {\r\n        return false;\r\n    }\r\n\r\n    bytes4 methodId = getMethod(_data);\r\n    return _spender == _to && methodId == SET_AUTH_PUBKEY_HASH;\r\n  }\r\n}","ABI":"[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_spender\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"internalType\":\"bytes\",\"name\":\"_data\",\"type\":\"bytes\"}],\"name\":\"isValid\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"valid\",\"type\":\"bool\"}],\"stateMutability\":\"pure\",\"type\":\"function\"}]","ContractName":"ZkSyncFilter","CompilerVersion":"v0.8.3+commit.8d00100c","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","EVMVersion":"Default","Library":"","LicenseType":"GNU GPLv3","Proxy":"0","Implementation":"","SwarmSource":"ipfs://b7b502911c7755b206c7dfd5d977570a62b0a74f72757b16370155c2f9caa1f6"}]}