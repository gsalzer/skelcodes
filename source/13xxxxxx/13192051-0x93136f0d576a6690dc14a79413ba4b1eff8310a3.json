{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.8.7;\r\n\r\ninterface KeeperCompatibleInterface {\r\n    function checkUpkeep(bytes calldata checkData) external returns (bool upkeepNeeded, bytes memory performData);\r\n    function performUpkeep(bytes calldata performData) external;\r\n}\r\n\r\ninterface Vault {\r\n    function allocate() external;\r\n    function rebase() external;\r\n}\r\n\r\ncontract OusdKeeper is KeeperCompatibleInterface {\r\n    struct Config {\r\n        uint8 rebaseDays;\r\n        uint8 allocateDays;\r\n        uint24 windowStart;\r\n        uint24 windowEnd;\r\n    }\r\n    Vault constant vault = Vault(0xE75D77B1865Ae93c7eaa3040B038D7aA7BC02F70);\r\n    uint8 immutable rebaseDays; // day of week bits\r\n    uint8 immutable allocateDays; // day of week bits\r\n    uint24 immutable windowStart; // seconds after start of day\r\n    uint24 immutable windowEnd; // seconds after start of day\r\n    uint256 lastRunDay = 0;\r\n\r\n    constructor(\r\n        uint8 _rebaseDays,\r\n        uint8 _allocateDays,\r\n        uint24 _windowStart,\r\n        uint24 _windowEnd\r\n    ) {\r\n        rebaseDays = _rebaseDays;\r\n        allocateDays = _allocateDays;\r\n        windowStart = _windowStart;\r\n        windowEnd = _windowEnd;\r\n    }\r\n\r\n    function checkUpkeep(bytes calldata checkData)\r\n        external\r\n        view\r\n        override\r\n        returns (bool upkeepNeeded, bytes memory performData)\r\n    {\r\n        // If either can run, let's go!\r\n        (bool runRebase, bool runAllocate) = _shouldRun();\r\n        upkeepNeeded = (runRebase || runAllocate);\r\n    }\r\n\r\n    function performUpkeep(bytes calldata performData) external override {\r\n        (bool runRebase, bool runAllocate) = _shouldRun();\r\n        if (runRebase || runAllocate) {\r\n            // write today, so that we only run once per day\r\n            lastRunDay = (block.timestamp / 86400);\r\n        }\r\n        // allocate before rebase, so the rebase picks up the harvested rewards\r\n        if (runAllocate) {\r\n            vault.allocate();\r\n        }\r\n        if (runRebase) {\r\n            vault.rebase();\r\n        }\r\n    }\r\n\r\n    function _shouldRun()\r\n        internal\r\n        view\r\n        returns (bool runRebase, bool runAllocate)\r\n    {\r\n        // // Have we run today?\r\n        uint256 day = block.timestamp / 86400;\r\n        if (lastRunDay >= day) {\r\n            return (false, false);\r\n        }\r\n\r\n        // // Are we in the window?\r\n        uint256 daySeconds = block.timestamp % 86400;\r\n        if (daySeconds < windowStart || daySeconds > windowEnd) {\r\n            return (false, false);\r\n        }\r\n\r\n        // Weekday\r\n        uint8 weekday = uint8((day + 4) % 7);\r\n        // Need a rebase?\r\n        if (((rebaseDays >> weekday) & 1) != 0) {\r\n            runRebase = true;\r\n        }\r\n        // Need an allocate?\r\n        if (((allocateDays >> weekday) & 1) != 0) {\r\n            runAllocate = true;\r\n        }\r\n    }\r\n}","ABI":"[{\"inputs\":[{\"internalType\":\"uint8\",\"name\":\"_rebaseDays\",\"type\":\"uint8\"},{\"internalType\":\"uint8\",\"name\":\"_allocateDays\",\"type\":\"uint8\"},{\"internalType\":\"uint24\",\"name\":\"_windowStart\",\"type\":\"uint24\"},{\"internalType\":\"uint24\",\"name\":\"_windowEnd\",\"type\":\"uint24\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"bytes\",\"name\":\"checkData\",\"type\":\"bytes\"}],\"name\":\"checkUpkeep\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"upkeepNeeded\",\"type\":\"bool\"},{\"internalType\":\"bytes\",\"name\":\"performData\",\"type\":\"bytes\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"bytes\",\"name\":\"performData\",\"type\":\"bytes\"}],\"name\":\"performUpkeep\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]","ContractName":"OusdKeeper","CompilerVersion":"v0.8.7+commit.e28d00a7","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"00000000000000000000000000000000000000000000000000000000000000ff0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000624d00000000000000000000000000000000000000000000000000000000000065d1","EVMVersion":"Default","Library":"","LicenseType":"None","Proxy":"0","Implementation":"","SwarmSource":"ipfs://a176a19a1dca4473e6a18b443e4f370802d57405079602c2d37adf8463e091c9"}]}