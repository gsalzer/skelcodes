{"status":"1","message":"OK","result":[{"SourceCode":"/**\r\n\r\n  Source code of Opium Protocol On-chain SubIds OracleId\r\n  Web https://opium.network\r\n  Telegram https://t.me/opium_network\r\n  Twitter https://twitter.com/opium_network\r\n\r\n */\r\n\r\n// File: LICENSE\r\n\r\n/**\r\n\r\nThe software and documentation available in this repository (the \"Software\") is protected by copyright law and accessible pursuant to the license set forth below. Copyright © 2020 Blockeys BV. All rights reserved.\r\n\r\nPermission is hereby granted, free of charge, to any person or organization obtaining the Software (the “Licensee”) to privately study, review, and analyze the Software. Licensee shall not use the Software for any other purpose. Licensee shall not modify, transfer, assign, share, or sub-license the Software or any derivative works of the Software.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n*/\r\n\r\n// File: opium-contracts/contracts/Interface/IOracleId.sol\r\n\r\npragma solidity 0.5.16;\r\n\r\n/// @title Opium.Interface.IOracleId contract is an interface that every oracleId should implement\r\ninterface IOracleId {\r\n    /// @notice Requests data from `oracleId` one time\r\n    /// @param timestamp uint256 Timestamp at which data are needed\r\n    function fetchData(uint256 timestamp) external payable;\r\n\r\n    /// @notice Requests data from `oracleId` multiple times\r\n    /// @param timestamp uint256 Timestamp at which data are needed for the first time\r\n    /// @param period uint256 Period in seconds between multiple timestamps\r\n    /// @param times uint256 How many timestamps are requested\r\n    function recursivelyFetchData(uint256 timestamp, uint256 period, uint256 times) external payable;\r\n\r\n    /// @notice Requests and returns price in ETH for one request. This function could be called as `view` function. Oraclize API for price calculations restricts making this function as view.\r\n    /// @return fetchPrice uint256 Price of one data request in ETH\r\n    function calculateFetchPrice() external returns (uint256 fetchPrice);\r\n\r\n    // Event with oracleId metadata JSON string (for DIB.ONE derivative explorer)\r\n    event MetadataSet(string metadata);\r\n}\r\n\r\n// File: contracts/oracles/onchainSubIds/OnchainSubIdsOracleId.sol\r\n\r\npragma solidity 0.5.16;\r\n\r\n\r\ninterface IOracleAggregator {\r\n  function __callback(uint256 timestamp, uint256 data) external;\r\n  function hasData(address oracleId, uint256 timestamp) external view returns(bool result);\r\n}\r\n\r\ninterface IOracleSubId {\r\n  function getResult() external view returns (uint256);\r\n}\r\n\r\ncontract OnchainSubIdsOracleId is IOracleId {\r\n  event Provided(uint256 indexed timestamp, uint256 result);\r\n\r\n  // Resolvers\r\n  // Mapping timestamp => oracleSubId\r\n  mapping (uint256 => address) public resolvers;\r\n\r\n  // Opium\r\n  IOracleAggregator public oracleAggregator;\r\n\r\n  // Governance\r\n  address private _owner;\r\n  uint256 public EMERGENCY_PERIOD;\r\n\r\n  modifier onlyOwner() {\r\n    require(_owner == msg.sender, \"N.O\"); // N.O = not an owner\r\n    _;\r\n  }\r\n\r\n  constructor(IOracleAggregator _oracleAggregator, uint256 _emergencyPeriod) public {\r\n    // Opium\r\n    oracleAggregator = _oracleAggregator;\r\n\r\n    // Governance\r\n    _owner = msg.sender;\r\n    EMERGENCY_PERIOD = _emergencyPeriod;\r\n    /*\r\n    {\r\n      \"author\": \"Opium.Team\",\r\n      \"description\": \"On-chain Universal Oracle\",\r\n      \"asset\": \"Universal\",\r\n      \"type\": \"onchain\",\r\n      \"source\": \"subIds\",\r\n      \"logic\": \"none\",\r\n      \"path\": \"getResult()\"\r\n    }\r\n    */\r\n    emit MetadataSet(\"{\\\"author\\\":\\\"Opium.Team\\\",\\\"description\\\":\\\"On-chain Universal Oracle\\\",\\\"asset\\\":\\\"Universal\\\",\\\"type\\\":\\\"onchain\\\",\\\"source\\\":\\\"subIds\\\",\\\"logic\\\":\\\"none\\\",\\\"path\\\":\\\"getResult()\\\"}\");\r\n  }\r\n\r\n  /** OPIUM INTERFACE */\r\n  function fetchData(uint256 _timestamp) external payable {\r\n    _timestamp;\r\n    revert(\"N.S\"); // N.S = not supported\r\n  }\r\n\r\n  function recursivelyFetchData(uint256 _timestamp, uint256 _period, uint256 _times) external payable {\r\n    _timestamp;\r\n    _period;\r\n    _times;\r\n    revert(\"N.S\"); // N.S = not supported\r\n  }\r\n\r\n  function calculateFetchPrice() external returns (uint256) {\r\n    return 0;\r\n  }\r\n  \r\n  /** RESOLVER */\r\n  function _callback(uint256 _timestamp) public {\r\n    require(\r\n      !oracleAggregator.hasData(address(this), _timestamp) &&\r\n      _timestamp < now,\r\n      \"N.A\" // N.A = Only when no data and after timestamp allowed\r\n    );\r\n\r\n    uint256 result = IOracleSubId(resolvers[_timestamp]).getResult();\r\n    oracleAggregator.__callback(_timestamp, result);\r\n\r\n    emit Provided(_timestamp, result);\r\n  }\r\n\r\n  function registerResolver(uint256 _timestamp, address _resolver) public {\r\n    require(resolvers[_timestamp] == address(0), \"O.R\"); // O.R = already registered\r\n    resolvers[_timestamp] = _resolver;\r\n  }\r\n\r\n  /** GOVERNANCE */\r\n  /** \r\n    Emergency callback allows to push data manually in case EMERGENCY_PERIOD elapsed and no data were provided\r\n   */\r\n  function emergencyCallback(uint256 _timestamp, uint256 _result) public onlyOwner {\r\n    require(\r\n      !oracleAggregator.hasData(address(this), _timestamp) &&\r\n      _timestamp + EMERGENCY_PERIOD  < now,\r\n      \"N.E\" // N.E = Only when no data and after emergency period allowed\r\n    );\r\n\r\n    oracleAggregator.__callback(_timestamp, _result);\r\n\r\n    emit Provided(_timestamp, _result);\r\n  }\r\n}","ABI":"[{\"inputs\":[{\"internalType\":\"contract IOracleAggregator\",\"name\":\"_oracleAggregator\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"_emergencyPeriod\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"string\",\"name\":\"metadata\",\"type\":\"string\"}],\"name\":\"MetadataSet\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"uint256\",\"name\":\"timestamp\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"result\",\"type\":\"uint256\"}],\"name\":\"Provided\",\"type\":\"event\"},{\"constant\":true,\"inputs\":[],\"name\":\"EMERGENCY_PERIOD\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_timestamp\",\"type\":\"uint256\"}],\"name\":\"_callback\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"calculateFetchPrice\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_result\",\"type\":\"uint256\"}],\"name\":\"emergencyCallback\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_timestamp\",\"type\":\"uint256\"}],\"name\":\"fetchData\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"oracleAggregator\",\"outputs\":[{\"internalType\":\"contract IOracleAggregator\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_period\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_times\",\"type\":\"uint256\"}],\"name\":\"recursivelyFetchData\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_timestamp\",\"type\":\"uint256\"},{\"internalType\":\"address\",\"name\":\"_resolver\",\"type\":\"address\"}],\"name\":\"registerResolver\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"resolvers\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"OnchainSubIdsOracleId","CompilerVersion":"v0.5.16+commit.9c3226ce","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"000000000000000000000000b69890912e40a7849fca058bb118cfe7d70932c4000000000000000000000000000000000000000000000000000000000000a8c0","EVMVersion":"petersburg","Library":"","LicenseType":"None","Proxy":"0","Implementation":"","SwarmSource":"bzzr://f1b27e791a7d87b0a4455dee62464ae833ec95b08bf38d25c0b00507bb0a7d41"}]}