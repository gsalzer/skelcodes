{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity^0.4.20;  \r\n//实例化代币\r\ninterface tokenTransfer {\r\n    function transfer(address receiver, uint amount);\r\n    function transferFrom(address _from, address _to, uint256 _value);\r\n    function balanceOf(address receiver) returns(uint256);\r\n}\r\n\r\ncontract Ownable {\r\n  address public owner;\r\n  bool lock = false;\r\n \r\n \r\n    /**\r\n     * 初台化构造函数\r\n     */\r\n    function Ownable () public {\r\n        owner = msg.sender;\r\n    }\r\n \r\n    /**\r\n     * 判断当前合约调用者是否是合约的所有者\r\n     */\r\n    modifier onlyOwner {\r\n        require (msg.sender == owner);\r\n        _;\r\n    }\r\n \r\n    /**\r\n     * 合约的所有者指派一个新的管理员\r\n     * @param  newOwner address 新的管理员帐户地址\r\n     */\r\n    function transferOwnership(address newOwner) onlyOwner public {\r\n        if (newOwner != address(0)) {\r\n        owner = newOwner;\r\n      }\r\n    }\r\n}\r\n\r\ncontract BebPos is Ownable{\r\n\r\n    //会员数据结构\r\n   struct BebUser {\r\n        address customerAddr;//会员address\r\n        uint256 amount; //存款金额 \r\n        uint256 bebtime;//存款时间\r\n        //uint256 interest;//利息\r\n    }\r\n    uint256 Bebamount;//BEB未发行数量\r\n    uint256 bebTotalAmount;//BEB总量\r\n    uint256 sumAmount = 0;//会员的总量 \r\n    uint256 OneMinuteBEB;//初始化1分钟产生BEB数量\r\n    tokenTransfer public bebTokenTransfer; //代币 \r\n    uint8 decimals = 18;\r\n    uint256 OneMinute=1 minutes; //1分钟\r\n    //会员 结构 \r\n    mapping(address=>BebUser)public BebUsers;\r\n    address[] BebUserArray;//存款的地址数组\r\n    //事件\r\n    event messageBetsGame(address sender,bool isScuccess,string message);\r\n    //BEB的合约地址 \r\n    function BebPos(address _tokenAddress,uint256 _Bebamount,uint256 _bebTotalAmount,uint256 _OneMinuteBEB){\r\n         bebTokenTransfer = tokenTransfer(_tokenAddress);\r\n         Bebamount=_Bebamount*10**18;//初始设定为发行数量\r\n         bebTotalAmount=_bebTotalAmount*10**18;//初始设定BEB总量\r\n         OneMinuteBEB=_OneMinuteBEB*10**18;//初始化1分钟产生BEB数量 \r\n         BebUserArray.push(_tokenAddress);\r\n     }\r\n         //存入 BEB\r\n    function freeze(uint256 _value,address _addr) public{\r\n        //判断会员存款金额是否等于0\r\n       if(BebUsers[msg.sender].amount == 0){\r\n           //判断未发行数量是否大于20个BEB\r\n           if(Bebamount > OneMinuteBEB){\r\n           bebTokenTransfer.transferFrom(_addr,address(address(this)),_value);//存入BEB\r\n           BebUsers[_addr].customerAddr=_addr;\r\n           BebUsers[_addr].amount=_value;\r\n           BebUsers[_addr].bebtime=now;\r\n           sumAmount+=_value;//总存款增加\r\n           //加入存款数组地址\r\n           //addToAddress(msg.sender);//加入存款数组地址\r\n           messageBetsGame(msg.sender, true,\"转入成功\");\r\n            return;   \r\n           }\r\n           else{\r\n            messageBetsGame(msg.sender, true,\"转入失败,BEB总量已经全部发行完毕\");\r\n            return;   \r\n           }\r\n       }else{\r\n            messageBetsGame(msg.sender, true,\"转入失败,请先取出合约中的余额\");\r\n            return;\r\n       }\r\n    }\r\n\r\n    //取款\r\n    function unfreeze(address referral) public {\r\n        address _address = msg.sender;\r\n        BebUser storage user = BebUsers[_address];\r\n        require(user.amount > 0);\r\n        //\r\n        uint256 _time=user.bebtime;//存款时间\r\n        uint256 _amuont=user.amount;//个人存款金额\r\n           uint256 AA=(now-_time)/OneMinute*OneMinuteBEB;//现在时间-存款时间/60秒*每分钟生产20BEB\r\n           uint256 BB=bebTotalAmount-Bebamount;//计算出已流通数量\r\n           uint256 CC=_amuont*AA/BB;//存款*AA/已流通数量\r\n           //判断未发行数量是否大于20BEB\r\n           if(Bebamount > OneMinuteBEB){\r\n              Bebamount-=CC; \r\n             //user.interest+=CC;//向账户增加利息\r\n             user.bebtime=now;//重置存款时间为现在\r\n           }\r\n        //判断未发行数量是否大于20个BEB\r\n        if(Bebamount > OneMinuteBEB){\r\n            Bebamount-=CC;//从发行总量当中减少\r\n            sumAmount-=_amuont;\r\n            bebTokenTransfer.transfer(msg.sender,CC+user.amount);//转账给会员 + 会员本金+当前利息 \r\n           //更新数据 \r\n            BebUsers[_address].amount=0;//会员存款0\r\n            BebUsers[_address].bebtime=0;//会员存款时间0\r\n            //BebUsers[_address].interest=0;//利息归0\r\n            messageBetsGame(_address, true,\"本金和利息成功取款\");\r\n            return;\r\n        }\r\n        else{\r\n            Bebamount-=CC;//从发行总量当中减少\r\n            sumAmount-=_amuont;\r\n            bebTokenTransfer.transfer(msg.sender,_amuont);//转账给会员 + 会员本金 \r\n           //更新数据 \r\n            BebUsers[_address].amount=0;//会员存款0\r\n            BebUsers[_address].bebtime=0;//会员存款时间0\r\n            //BebUsers[_address].interest=0;//利息归0\r\n            messageBetsGame(_address, true,\"BEB总量已经发行完毕，取回本金\");\r\n            return;  \r\n        }\r\n    }\r\n    function getTokenBalance() public view returns(uint256){\r\n         return bebTokenTransfer.balanceOf(address(this));\r\n    }\r\n    function getSumAmount() public view returns(uint256){\r\n        return sumAmount;\r\n    }\r\n    function getBebAmount() public view returns(uint256){\r\n        return Bebamount;\r\n    }\r\n    function getBebAmountzl() public view returns(uint256){\r\n        uint256 _sumAmount=bebTotalAmount-Bebamount;\r\n        return _sumAmount;\r\n    }\r\n\r\n    function getLength() public view returns(uint256){\r\n        return (BebUserArray.length);\r\n    }\r\n     function getUserProfit(address _form) public view returns(address,uint256,uint256,uint256){\r\n       address _address = _form;\r\n       BebUser storage user = BebUsers[_address];\r\n       assert(user.amount > 0);\r\n       uint256 A=(now-user.bebtime)/OneMinute*OneMinuteBEB;\r\n       uint256 B=bebTotalAmount-Bebamount;\r\n       uint256 C=user.amount*A/B;\r\n        return (_address,user.bebtime,user.amount,C);\r\n    }\r\n    function()payable{\r\n        \r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"uint256\"},{\"name\":\"_addr\",\"type\":\"address\"}],\"name\":\"freeze\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getBebAmountzl\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"bebTokenTransfer\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"referral\",\"type\":\"address\"}],\"name\":\"unfreeze\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_form\",\"type\":\"address\"}],\"name\":\"getUserProfit\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"BebUsers\",\"outputs\":[{\"name\":\"customerAddr\",\"type\":\"address\"},{\"name\":\"amount\",\"type\":\"uint256\"},{\"name\":\"bebtime\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getTokenBalance\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getLength\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getSumAmount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getBebAmount\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_tokenAddress\",\"type\":\"address\"},{\"name\":\"_Bebamount\",\"type\":\"uint256\"},{\"name\":\"_bebTotalAmount\",\"type\":\"uint256\"},{\"name\":\"_OneMinuteBEB\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"sender\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"isScuccess\",\"type\":\"bool\"},{\"indexed\":false,\"name\":\"message\",\"type\":\"string\"}],\"name\":\"messageBetsGame\",\"type\":\"event\"}]","ContractName":"BebPos","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"00000000000000000000000060fc8444349fee867fd9c0638a2f9a02b352aca700000000000000000000000000000000000000000000000000000000008954400000000000000000000000000000000000000000000000000000000035a4e9000000000000000000000000000000000000000000000000000000000000000014","Library":"","LicenseType":"MIT","SwarmSource":"bzzr://0306e79b4eeab5ab68762adc11bf99ce23a01c85c493808e5827fe80ec7344db"}]}