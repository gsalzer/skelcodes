{"status":"1","message":"OK","result":[{"SourceCode":"/*\r\n\r\n  Copyright 2019 ZeroEx Intl.\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n    http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n\r\n*/\r\n\r\npragma solidity ^0.5;\r\npragma experimental ABIEncoderV2;\r\n\r\ninterface IERC20BridgeSampler {\r\n\r\n    /// @dev Sample sell orders on multiple DEXes at once.\r\n    /// @param sources Address of each DEX. Passing in an unknown DEX will throw.\r\n    /// @param takerToken The taker token.\r\n    /// @param makerToken The maker token.\r\n    /// @param takerTokenAmounts Taker sell amount for each sample.\r\n    /// @return makerTokenAmountsBySource Maker amounts bought for each source at\r\n    ///         each taker token amount.\r\n    function sampleSells(\r\n        address[] calldata sources,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] calldata takerTokenAmounts\r\n    )\r\n        external\r\n        view\r\n        returns (uint256[][] memory makerTokenAmountsBySource);\r\n\r\n    /// @dev Sample buy orders on multiple DEXes at once.\r\n    /// @param sources Address of each DEX. Passing in an unknown DEX will throw.\r\n    /// @param takerToken The taker token.\r\n    /// @param makerToken The maker token.\r\n    /// @param makerTokenAmounts Maker sell amount for each sample.\r\n    /// @return takerTokenAmountsBySource Taker amounts sold for each source at\r\n    ///         each maker token amount.\r\n    function sampleBuys(\r\n        address[] calldata sources,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] calldata makerTokenAmounts\r\n    )\r\n        external\r\n        view\r\n        returns (uint256[][] memory takerTokenAmountsBySource);\r\n}\r\n\r\ncontract IEth2Dai {\r\n    function getBuyAmount(\r\n        address buyToken,\r\n        address payToken,\r\n        uint256 payAmount\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 buyAmount);\r\n\r\n    function getPayAmount(\r\n        address payToken,\r\n        address buyToken,\r\n        uint256 buyAmount\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 payAmount);\r\n}\r\n\r\ncontract IKyberNetwork {\r\n    function getExpectedRate(\r\n        address fromToken,\r\n        address toToken,\r\n        uint256 fromAmount\r\n    )\r\n        public\r\n        view\r\n        returns (uint256 expectedRate, uint256 slippageRate);\r\n}\r\n\r\ncontract IERC20Token {\r\n\r\n    // solhint-disable no-simple-event-func-name\r\n    event Transfer(\r\n        address indexed _from,\r\n        address indexed _to,\r\n        uint256 _value\r\n    );\r\n\r\n    event Approval(\r\n        address indexed _owner,\r\n        address indexed _spender,\r\n        uint256 _value\r\n    );\r\n\r\n    /// @dev send `value` token to `to` from `msg.sender`\r\n    /// @param _to The address of the recipient\r\n    /// @param _value The amount of token to be transferred\r\n    /// @return True if transfer was successful\r\n    function transfer(address _to, uint256 _value)\r\n        external\r\n        returns (bool);\r\n\r\n    /// @dev send `value` token to `to` from `from` on the condition it is approved by `from`\r\n    /// @param _from The address of the sender\r\n    /// @param _to The address of the recipient\r\n    /// @param _value The amount of token to be transferred\r\n    /// @return True if transfer was successful\r\n    function transferFrom(\r\n        address _from,\r\n        address _to,\r\n        uint256 _value\r\n    )\r\n        external\r\n        returns (bool);\r\n\r\n    /// @dev `msg.sender` approves `_spender` to spend `_value` tokens\r\n    /// @param _spender The address of the account able to transfer the tokens\r\n    /// @param _value The amount of wei to be approved for transfer\r\n    /// @return Always true if the call has enough gas to complete execution\r\n    function approve(address _spender, uint256 _value)\r\n        external\r\n        returns (bool);\r\n\r\n    /// @dev Query total supply of token\r\n    /// @return Total supply of token\r\n    function totalSupply()\r\n        external\r\n        view\r\n        returns (uint256);\r\n\r\n    /// @param _owner The address from which the balance will be retrieved\r\n    /// @return Balance of owner\r\n    function balanceOf(address _owner)\r\n        external\r\n        view\r\n        returns (uint256);\r\n\r\n    /// @param _owner The address of the account owning tokens\r\n    /// @param _spender The address of the account able to transfer the tokens\r\n    /// @return Amount of remaining tokens allowed to spent\r\n    function allowance(address _owner, address _spender)\r\n        external\r\n        view\r\n        returns (uint256);\r\n\r\n    function decimals()\r\n        external\r\n        view\r\n        returns (uint8);\r\n}\r\n\r\ncontract IUniswapExchange {\r\n    function getEthToTokenInputPrice(\r\n        uint256 ethSold\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 tokensBought);\r\n\r\n    function getEthToTokenOutputPrice(\r\n        uint256 tokensBought\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 ethSold);\r\n\r\n    function getTokenToEthInputPrice(\r\n        uint256 tokensSold\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 ethBought);\r\n\r\n    function getTokenToEthOutputPrice(\r\n        uint256 ethBought\r\n    )\r\n        external\r\n        view\r\n        returns (uint256 tokensSold);\r\n}\r\n\r\ninterface IUniswapExchangeFactory {\r\n\r\n    /// @dev Get the exchange for a token.\r\n    /// @param tokenAddress The address of the token contract.\r\n    function getExchange(address tokenAddress)\r\n        external\r\n        view\r\n        returns (IUniswapExchange);\r\n}\r\n\r\ncontract ERC20BridgeSampler is\r\n    IERC20BridgeSampler\r\n{\r\n    address constant public ETH2DAI_ADDRESS = 0x39755357759cE0d7f32dC8dC45414CCa409AE24e;\r\n    address constant public UNISWAP_EXCHANGE_FACTORY_ADDRESS = 0xc0a47dFe034B400B47bDaD5FecDa2621de6c4d95;\r\n    address constant public KYBER_NETWORK_PROXY_ADDRESS = 0x818E6FECD516Ecc3849DAf6845e3EC868087B755;\r\n    address constant public WETH_ADDRESS = 0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2;\r\n    address constant public KYBER_ETH_ADDRESS = 0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE;\r\n\r\n    function sampleSells(\r\n        address[] memory sources,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory takerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[][] memory makerTokenAmountsBySource)\r\n    {\r\n        uint256 numSources = sources.length;\r\n        makerTokenAmountsBySource = new uint256[][](numSources);\r\n        for (uint256 i = 0; i < numSources; i++) {\r\n            makerTokenAmountsBySource[i] = _sampleSellSource(\r\n                sources[i],\r\n                takerToken,\r\n                makerToken,\r\n                takerTokenAmounts\r\n            );\r\n        }\r\n    }\r\n\r\n    function sampleBuys(\r\n        address[] memory sources,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory makerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[][] memory takerTokenAmountsBySource)\r\n    {\r\n        uint256 numSources = sources.length;\r\n        takerTokenAmountsBySource = new uint256[][](numSources);\r\n        for (uint256 i = 0; i < numSources; i++) {\r\n            takerTokenAmountsBySource[i] = _sampleBuySource(\r\n                sources[i],\r\n                takerToken,\r\n                makerToken,\r\n                makerTokenAmounts\r\n            );\r\n        }\r\n    }\r\n\r\n    function sampleSellFromKyberNetwork(\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory takerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[] memory makerTokenAmounts)\r\n    {\r\n        address _takerToken = takerToken == WETH_ADDRESS ? KYBER_ETH_ADDRESS : takerToken;\r\n        address _makerToken = makerToken == WETH_ADDRESS ? KYBER_ETH_ADDRESS : makerToken;\r\n        uint256 takerTokenDecimals = IERC20Token(takerToken).decimals();\r\n        uint256 makerTokenDecimals = IERC20Token(makerToken).decimals();\r\n        uint256 numSamples = takerTokenAmounts.length;\r\n        makerTokenAmounts = new uint256[](numSamples);\r\n        for (uint256 i = 0; i < numSamples; i++) {\r\n            (uint256 rate,) = IKyberNetwork(KYBER_NETWORK_PROXY_ADDRESS).getExpectedRate(\r\n                _takerToken,\r\n                _makerToken,\r\n                takerTokenAmounts[i]\r\n            );\r\n            makerTokenAmounts[i] =\r\n                rate *\r\n                takerTokenAmounts[i] *\r\n                makerTokenDecimals /\r\n                (10 ** 18 * takerTokenDecimals);\r\n        }\r\n    }\r\n\r\n    function sampleSellFromEth2Dai(\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory takerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[] memory makerTokenAmounts)\r\n    {\r\n        uint256 numSamples = takerTokenAmounts.length;\r\n        makerTokenAmounts = new uint256[](numSamples);\r\n        for (uint256 i = 0; i < numSamples; i++) {\r\n            makerTokenAmounts[i] = IEth2Dai(ETH2DAI_ADDRESS).getBuyAmount(\r\n                makerToken,\r\n                takerToken,\r\n                takerTokenAmounts[i]\r\n            );\r\n        }\r\n    }\r\n\r\n    function sampleBuyFromEth2Dai(\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory makerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[] memory takerTokenAmounts)\r\n    {\r\n        uint256 numSamples = makerTokenAmounts.length;\r\n        takerTokenAmounts = new uint256[](numSamples);\r\n        for (uint256 i = 0; i < numSamples; i++) {\r\n            takerTokenAmounts[i] = IEth2Dai(ETH2DAI_ADDRESS).getPayAmount(\r\n                takerToken,\r\n                makerToken,\r\n                makerTokenAmounts[i]\r\n            );\r\n        }\r\n    }\r\n\r\n    function sampleSellFromUniswap(\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory takerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[] memory makerTokenAmounts)\r\n    {\r\n        uint256 numSamples = takerTokenAmounts.length;\r\n        makerTokenAmounts = new uint256[](numSamples);\r\n        IUniswapExchange takerTokenExchange = takerToken == WETH_ADDRESS ?\r\n            IUniswapExchange(0) :\r\n            IUniswapExchangeFactory(UNISWAP_EXCHANGE_FACTORY_ADDRESS).getExchange(takerToken);\r\n        IUniswapExchange makerTokenExchange = makerToken == WETH_ADDRESS ?\r\n            IUniswapExchange(0) :\r\n            IUniswapExchangeFactory(UNISWAP_EXCHANGE_FACTORY_ADDRESS).getExchange(makerToken);\r\n        for (uint256 i = 0; i < numSamples; i++) {\r\n            if (makerToken == WETH_ADDRESS) {\r\n                makerTokenAmounts[i] = takerTokenExchange.getTokenToEthInputPrice(\r\n                    takerTokenAmounts[i]\r\n                );\r\n            } else if (takerToken == WETH_ADDRESS) {\r\n                makerTokenAmounts[i] = makerTokenExchange.getEthToTokenInputPrice(\r\n                    takerTokenAmounts[i]\r\n                );\r\n            } else {\r\n                uint256 ethBought = takerTokenExchange.getTokenToEthInputPrice(\r\n                    takerTokenAmounts[i]\r\n                );\r\n                makerTokenAmounts[i] = makerTokenExchange.getEthToTokenInputPrice(\r\n                    ethBought\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    function sampleBuyFromUniswap(\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory makerTokenAmounts\r\n    )\r\n        public\r\n        view\r\n        returns (uint256[] memory takerTokenAmounts)\r\n    {\r\n        uint256 numSamples = makerTokenAmounts.length;\r\n        takerTokenAmounts = new uint256[](numSamples);\r\n        IUniswapExchange takerTokenExchange = takerToken == WETH_ADDRESS ?\r\n            IUniswapExchange(0) :\r\n            IUniswapExchangeFactory(UNISWAP_EXCHANGE_FACTORY_ADDRESS).getExchange(takerToken);\r\n        IUniswapExchange makerTokenExchange = makerToken == WETH_ADDRESS ?\r\n            IUniswapExchange(0) :\r\n            IUniswapExchangeFactory(UNISWAP_EXCHANGE_FACTORY_ADDRESS).getExchange(makerToken);\r\n        for (uint256 i = 0; i < numSamples; i++) {\r\n            if (makerToken == WETH_ADDRESS) {\r\n                takerTokenAmounts[i] = takerTokenExchange.getTokenToEthOutputPrice(\r\n                    makerTokenAmounts[i]\r\n                );\r\n            } else if (takerToken == WETH_ADDRESS) {\r\n                takerTokenAmounts[i] = makerTokenExchange.getEthToTokenOutputPrice(\r\n                    makerTokenAmounts[i]\r\n                );\r\n            } else {\r\n                uint256 ethSold = makerTokenExchange.getEthToTokenOutputPrice(\r\n                    makerTokenAmounts[i]\r\n                );\r\n                takerTokenAmounts[i] = takerTokenExchange.getTokenToEthOutputPrice(\r\n                    ethSold\r\n                );\r\n            }\r\n        }\r\n    }\r\n\r\n    function _sampleSellSource(\r\n        address source,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory takerTokenAmounts\r\n    )\r\n        private\r\n        view\r\n        returns (uint256[] memory makerTokenAmounts)\r\n    {\r\n        if (source == ETH2DAI_ADDRESS) {\r\n            return sampleSellFromEth2Dai(takerToken, makerToken, takerTokenAmounts);\r\n        }\r\n        if (source == UNISWAP_EXCHANGE_FACTORY_ADDRESS) {\r\n            return sampleSellFromUniswap(takerToken, makerToken, takerTokenAmounts);\r\n        }\r\n        if (source == KYBER_NETWORK_PROXY_ADDRESS) {\r\n            return sampleSellFromKyberNetwork(takerToken, makerToken, takerTokenAmounts);\r\n        }\r\n        revert(\"UNSUPPORTED_SOURCE\");\r\n    }\r\n\r\n    function _sampleBuySource(\r\n        address source,\r\n        address takerToken,\r\n        address makerToken,\r\n        uint256[] memory makerTokenAmounts\r\n    )\r\n        private\r\n        view\r\n        returns (uint256[] memory takerTokenAmounts)\r\n    {\r\n        if (source == ETH2DAI_ADDRESS) {\r\n            return sampleBuyFromEth2Dai(takerToken, makerToken, makerTokenAmounts);\r\n        }\r\n        if (source == UNISWAP_EXCHANGE_FACTORY_ADDRESS) {\r\n            return sampleBuyFromUniswap(takerToken, makerToken, takerTokenAmounts);\r\n        }\r\n        revert(\"UNSUPPORTED_SOURCE\");\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"WETH_ADDRESS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleSellFromKyberNetwork\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"KYBER_ETH_ADDRESS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleSellFromUniswap\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address[]\",\"name\":\"sources\",\"type\":\"address[]\"},{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleBuys\",\"outputs\":[{\"internalType\":\"uint256[][]\",\"name\":\"takerTokenAmountsBySource\",\"type\":\"uint256[][]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"UNISWAP_EXCHANGE_FACTORY_ADDRESS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleBuyFromUniswap\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"ETH2DAI_ADDRESS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleSellFromEth2Dai\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"KYBER_NETWORK_PROXY_ADDRESS\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"makerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleBuyFromEth2Dai\",\"outputs\":[{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"address[]\",\"name\":\"sources\",\"type\":\"address[]\"},{\"internalType\":\"address\",\"name\":\"takerToken\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"makerToken\",\"type\":\"address\"},{\"internalType\":\"uint256[]\",\"name\":\"takerTokenAmounts\",\"type\":\"uint256[]\"}],\"name\":\"sampleSells\",\"outputs\":[{\"internalType\":\"uint256[][]\",\"name\":\"makerTokenAmountsBySource\",\"type\":\"uint256[][]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"}]","ContractName":"ERC20BridgeSampler","CompilerVersion":"v0.5.11+commit.c082d0b4","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"None","SwarmSource":"bzzr://75c327db9077fad5de970c4bb655d25069ebef90dba7de1dcf9b70a637efeb98"}]}