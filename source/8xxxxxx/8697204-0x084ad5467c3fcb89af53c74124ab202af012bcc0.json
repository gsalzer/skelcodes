{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity 0.5.11;\r\n\r\n\r\ninterface DharmaKeyRingImplementationV0Interface {\r\n  enum AdminActionType {\r\n    AddStandardKey,\r\n    RemoveStandardKey,\r\n    SetStandardThreshold,\r\n    AddAdminKey,\r\n    RemoveAdminKey,\r\n    SetAdminThreshold,\r\n    AddDualKey,\r\n    RemoveDualKey,\r\n    SetDualThreshold\r\n  }\r\n\r\n  function takeAdminAction(\r\n    AdminActionType adminActionType, uint160 argument, bytes calldata signatures\r\n  ) external;\r\n}\r\n\r\n\r\n/**\r\n * @title DharmaLocksmithV0\r\n * @author 0age\r\n * @notice This contract provides a helper function for setting new keys on a V0\r\n * Dharma Key Ring.\r\n */\r\ncontract DharmaLocksmithV0 {\r\n  /**\r\n   * @notice Set a new signing key on a keyring using an existing signature on\r\n   * the key ring.\r\n   * @param keyRing address The key ring to set the new user signing key on.\r\n   * @param newUserSigningKey address The new user signing key.\r\n   * @param signature bytes The signature, validated from an existing key and\r\n   * signed using a valid message hash.\r\n   */\r\n  function setAdditionalKey(\r\n    address keyRing, address newUserSigningKey, bytes calldata signature\r\n  ) external {\r\n    // Ensure that a key ring has been provided.\r\n    require(keyRing != address(0), \"No key ring supplied.\");\r\n\r\n    // Add the new key by providing it as an argument to the key ring.\r\n    DharmaKeyRingImplementationV0Interface(keyRing).takeAdminAction(\r\n      DharmaKeyRingImplementationV0Interface.AdminActionType.AddDualKey,\r\n      uint160(newUserSigningKey),\r\n      signature\r\n    );\r\n  }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"keyRing\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"newUserSigningKey\",\"type\":\"address\"},{\"internalType\":\"bytes\",\"name\":\"signature\",\"type\":\"bytes\"}],\"name\":\"setAdditionalKey\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"}]","ContractName":"DharmaLocksmithV0","CompilerVersion":"v0.5.11+commit.c082d0b4","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"MIT","SwarmSource":"bzzr://a02d930454e8613769ea3a0388f0cff2f58ce27c854c61bc8c3cdd96db34602c"}]}