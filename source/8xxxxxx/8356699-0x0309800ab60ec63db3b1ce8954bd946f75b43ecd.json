{"status":"1","message":"OK","result":[{"SourceCode":"/*\r\n\r\n  Copyright 2017 Loopring Project Ltd (Loopring Foundation).\r\n\r\n  Licensed under the Apache License, Version 2.0 (the \"License\");\r\n  you may not use this file except in compliance with the License.\r\n  You may obtain a copy of the License at\r\n\r\n  http://www.apache.org/licenses/LICENSE-2.0\r\n\r\n  Unless required by applicable law or agreed to in writing, software\r\n  distributed under the License is distributed on an \"AS IS\" BASIS,\r\n  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n  See the License for the specific language governing permissions and\r\n  limitations under the License.\r\n*/\r\npragma solidity ^0.5.11;\r\n\r\n/// @title Ownable\r\n/// @author Brecht Devos - <brecht@loopring.org>\r\n/// @dev The Ownable contract has an owner address, and provides basic\r\n///      authorization control functions, this simplifies the implementation of\r\n///      \"user permissions\".\r\ncontract Ownable\r\n{\r\n    address public owner;\r\n\r\n    event OwnershipTransferred(\r\n        address indexed previousOwner,\r\n        address indexed newOwner\r\n    );\r\n\r\n    /// @dev The Ownable constructor sets the original `owner` of the contract\r\n    ///      to the sender.\r\n    constructor()\r\n        public\r\n    {\r\n        owner = msg.sender;\r\n    }\r\n\r\n    /// @dev Throws if called by any account other than the owner.\r\n    modifier onlyOwner()\r\n    {\r\n        require(msg.sender == owner, \"UNAUTHORIZED\");\r\n        _;\r\n    }\r\n\r\n    /// @dev Allows the current owner to transfer control of the contract to a\r\n    ///      new owner.\r\n    /// @param newOwner The address to transfer ownership to.\r\n    function transferOwnership(\r\n        address newOwner\r\n        )\r\n        public\r\n        onlyOwner\r\n    {\r\n        require(newOwner != address(0), \"ZERO_ADDRESS\");\r\n        emit OwnershipTransferred(owner, newOwner);\r\n        owner = newOwner;\r\n    }\r\n\r\n    function renounceOwnership()\r\n        public\r\n        onlyOwner\r\n    {\r\n        emit OwnershipTransferred(owner, address(0));\r\n        owner = address(0);\r\n    }\r\n}\r\n\r\n/// @title Claimable\r\n/// @author Brecht Devos - <brecht@loopring.org>\r\n/// @dev Extension for the Ownable contract, where the ownership needs\r\n///      to be claimed. This allows the new owner to accept the transfer.\r\ncontract Claimable is Ownable\r\n{\r\n    address public pendingOwner;\r\n\r\n    /// @dev Modifier throws if called by any account other than the pendingOwner.\r\n    modifier onlyPendingOwner() {\r\n        require(msg.sender == pendingOwner, \"UNAUTHORIZED\");\r\n        _;\r\n    }\r\n\r\n    /// @dev Allows the current owner to set the pendingOwner address.\r\n    /// @param newOwner The address to transfer ownership to.\r\n    function transferOwnership(\r\n        address newOwner\r\n        )\r\n        public\r\n        onlyOwner\r\n    {\r\n        require(newOwner != address(0) && newOwner != owner, \"INVALID_ADDRESS\");\r\n        pendingOwner = newOwner;\r\n    }\r\n\r\n    /// @dev Allows the pendingOwner address to finalize the transfer.\r\n    function claimOwnership()\r\n        public\r\n        onlyPendingOwner\r\n    {\r\n        emit OwnershipTransferred(owner, pendingOwner);\r\n        owner = pendingOwner;\r\n        pendingOwner = address(0);\r\n    }\r\n}\r\n\r\n/// @title Utility Functions for uint\r\n/// @author Daniel Wang - <daniel@loopring.org>\r\nlibrary MathUint\r\n{\r\n    function mul(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint c)\r\n    {\r\n        c = a * b;\r\n        require(a == 0 || c / a == b, \"MUL_OVERFLOW\");\r\n    }\r\n\r\n    function sub(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint)\r\n    {\r\n        require(b <= a, \"SUB_UNDERFLOW\");\r\n        return a - b;\r\n    }\r\n\r\n    function add(\r\n        uint a,\r\n        uint b\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint c)\r\n    {\r\n        c = a + b;\r\n        require(c >= a, \"ADD_OVERFLOW\");\r\n    }\r\n\r\n    function decodeFloat(\r\n        uint f\r\n        )\r\n        internal\r\n        pure\r\n        returns (uint value)\r\n    {\r\n        uint numBitsMantissa = 23;\r\n        uint exponent = f >> numBitsMantissa;\r\n        uint mantissa = f & ((1 << numBitsMantissa) - 1);\r\n        value = mantissa * (10 ** exponent);\r\n    }\r\n}\r\n\r\n/// @title IDowntimeCostCalculator\r\n/// @author Daniel Wang - <daniel@loopring.org>\r\ncontract IDowntimeCostCalculator\r\n{\r\n    /// @dev Returns the amount LRC required to purchase the given downtime.\r\n    /// @param totalTimeInMaintenanceSeconds The total time a DEX has been in maintain mode.\r\n    /// @param totalDEXLifeTimeSeconds The DEX's total life time since genesis.\r\n    /// @param numDowntimeMinutes The current downtime balance in minutes before purchase.\r\n    /// @param exchangeStakedLRC The number of LRC staked by the DEX's owner.\r\n    /// @param durationToPurchaseMinutes The downtime in minute to purchase.\r\n    /// @return cost The cost in LRC for purchasing the downtime.\r\n    function getDowntimeCostLRC(\r\n        uint  totalTimeInMaintenanceSeconds,\r\n        uint  totalDEXLifeTimeSeconds,\r\n        uint  numDowntimeMinutes,\r\n        uint  exchangeStakedLRC,\r\n        uint  durationToPurchaseMinutes\r\n        )\r\n        external\r\n        view\r\n        returns (uint cost);\r\n}\r\n\r\n/// @title The default IDowntimeCostCalculator implementation.\r\n/// @author Daniel Wang  - <daniel@loopring.org>\r\ncontract DowntimeCostCalculator is Claimable, IDowntimeCostCalculator\r\n{\r\n    using MathUint for uint;\r\n\r\n    uint public basePricePerMinute;\r\n    uint public maxPenalty;\r\n    uint public gracePeriodsMinutes;\r\n    uint public gracePeriodPricePerMinute;\r\n    uint public maxAwailableDowntimeMinutes;\r\n\r\n    event SettingsUpdated(\r\n        uint oldBasePricePerMinute,\r\n        uint oldMaxPenalty,\r\n        uint oldGracePeriodMinutes,\r\n        uint oldGracePeriodPricePerMinute,\r\n        uint oldMaxAwailableDowntimeMinutes\r\n    );\r\n\r\n    constructor() Claimable() public {}\r\n\r\n    function getDowntimeCostLRC(\r\n        uint  totalTimeInMaintenanceSeconds,\r\n        uint  totalDEXLifeTimeSeconds,\r\n        uint  numDowntimeMinutes,\r\n        uint  /* exchangeStakedLRC */,\r\n        uint  durationToPurchaseMinutes\r\n        )\r\n        external\r\n        view\r\n        returns (uint)\r\n    {\r\n        uint newCost = getTotalCost(\r\n            totalTimeInMaintenanceSeconds,\r\n            totalDEXLifeTimeSeconds,\r\n            numDowntimeMinutes.add(durationToPurchaseMinutes)\r\n        );\r\n\r\n        uint oldCost = getTotalCost(\r\n            totalTimeInMaintenanceSeconds,\r\n            totalDEXLifeTimeSeconds,\r\n            numDowntimeMinutes\r\n        );\r\n\r\n        return newCost > oldCost ? newCost - oldCost : 0;\r\n    }\r\n\r\n    function updateSettings(\r\n        uint _basePricePerMinute,\r\n        uint _maxPenalty,\r\n        uint _gracePeriodsMinutes,\r\n        uint _gracePeriodPricePerMinute,\r\n        uint _maxAwailableDowntimeMinutes\r\n        )\r\n        external\r\n        onlyOwner\r\n    {\r\n        require(\r\n            _basePricePerMinute > 0 && _maxPenalty > 0 &&\r\n            _gracePeriodPricePerMinute > 0 && _maxAwailableDowntimeMinutes > 0,\r\n            \"ZERO_VALUE\"\r\n        );\r\n        require(_gracePeriodPricePerMinute <= _basePricePerMinute, \"INVALID_PRICE\");\r\n\r\n        emit SettingsUpdated(\r\n            basePricePerMinute,\r\n            maxPenalty,\r\n            gracePeriodsMinutes,\r\n            gracePeriodPricePerMinute,\r\n            maxAwailableDowntimeMinutes\r\n        );\r\n\r\n        basePricePerMinute = _basePricePerMinute;\r\n        maxPenalty = _maxPenalty;\r\n        gracePeriodsMinutes = _gracePeriodsMinutes;\r\n        gracePeriodPricePerMinute = _gracePeriodPricePerMinute;\r\n        maxAwailableDowntimeMinutes = _maxAwailableDowntimeMinutes;\r\n    }\r\n\r\n    function getTotalCost(\r\n        uint totalTimeInMaintenanceSeconds,\r\n        uint totalDEXLifeTimeSeconds,\r\n        uint downtimeMinutes\r\n        )\r\n        private\r\n        view\r\n        returns (uint)\r\n    {\r\n        require(downtimeMinutes <= maxAwailableDowntimeMinutes, \"PURCHASE_PROHIBITED\");\r\n        uint totalMinutes = downtimeMinutes.add(totalTimeInMaintenanceSeconds / 60);\r\n\r\n        if (totalMinutes <= gracePeriodsMinutes) {\r\n            return totalMinutes.mul(gracePeriodPricePerMinute);\r\n        }\r\n\r\n        uint timeBeyondGracePeriodMinutes = totalMinutes - gracePeriodsMinutes;\r\n        uint penalty = timeBeyondGracePeriodMinutes.mul(600000) / totalDEXLifeTimeSeconds + 100;\r\n        uint _maxPenalty = maxPenalty.mul(100);\r\n\r\n        if (penalty > _maxPenalty) {\r\n            penalty = _maxPenalty;\r\n        }\r\n\r\n        return gracePeriodsMinutes.mul(gracePeriodPricePerMinute).add(\r\n            timeBeyondGracePeriodMinutes.mul(basePricePerMinute).mul(penalty) / 100\r\n        );\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"maxAwailableDowntimeMinutes\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"_basePricePerMinute\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_maxPenalty\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_gracePeriodsMinutes\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_gracePeriodPricePerMinute\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"_maxAwailableDowntimeMinutes\",\"type\":\"uint256\"}],\"name\":\"updateSettings\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"gracePeriodsMinutes\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"totalTimeInMaintenanceSeconds\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"totalDEXLifeTimeSeconds\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"numDowntimeMinutes\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"},{\"internalType\":\"uint256\",\"name\":\"durationToPurchaseMinutes\",\"type\":\"uint256\"}],\"name\":\"getDowntimeCostLRC\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"claimOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"maxPenalty\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"renounceOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"gracePeriodPricePerMinute\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"basePricePerMinute\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"pendingOwner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"oldBasePricePerMinute\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"oldMaxPenalty\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"oldGracePeriodMinutes\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"oldGracePeriodPricePerMinute\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"oldMaxAwailableDowntimeMinutes\",\"type\":\"uint256\"}],\"name\":\"SettingsUpdated\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"}]","ContractName":"DowntimeCostCalculator","CompilerVersion":"v0.5.11+commit.c082d0b4","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://2f513fb2c411705ee2bb7d4e84f238f43defbe557f3556158342bb6cbaf35d05"}]}