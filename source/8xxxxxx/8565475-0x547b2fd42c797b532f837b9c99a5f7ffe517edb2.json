{"status":"1","message":"OK","result":[{"SourceCode":"/**\r\n *Submitted for verification at Etherscan.io on 2019-09-16\r\n*/\r\n\r\n/**\r\n *Submitted for verification at Etherscan.io on 2019-06-21\r\n*/\r\n\r\npragma solidity ^0.5.7;\r\n\r\n// Skt Public Sale\r\n\r\n/**\r\n * @title SafeMath for uint256\r\n * @dev Unsigned math operations with safety checks that revert on error.\r\n */\r\nlibrary SafeMath256 {\r\n    /**\r\n     * @dev Adds two unsigned integers, reverts on overflow.\r\n     */\r\n    function add(uint256 a, uint256 b) internal pure returns (uint256 c) {\r\n        c = a + b;\r\n        assert(c >= a);\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @dev Subtracts two unsigned integers, reverts on overflow (i.e. if subtrahend is greater than minuend).\r\n     */\r\n    function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        assert(b <= a);\r\n        return a - b;\r\n    }\r\n\r\n    /**\r\n     * @dev Multiplies two unsigned integers, reverts on overflow.\r\n     */\r\n    function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {\r\n        if (a == 0) {\r\n            return 0;\r\n        }\r\n        c = a * b;\r\n        assert(c / a == b);\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @dev Integer division of two unsigned integers truncating the quotient,\r\n     * reverts on division by zero.\r\n     */\r\n    function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        assert(b > 0);\r\n        uint256 c = a / b;\r\n        assert(a == b * c + a % b);\r\n        return a / b;\r\n    }\r\n\r\n    /**\r\n     * @dev Divides two unsigned integers and returns the remainder (unsigned integer modulo),\r\n     * reverts when dividing by zero.\r\n     */\r\n    function mod(uint256 a, uint256 b) internal pure returns (uint256) {\r\n        require(b != 0);\r\n        return a % b;\r\n    }\r\n}\r\n\r\n/**\r\n * @title SafeMath for uint16\r\n * @dev Unsigned math operations with safety checks that revert on error.\r\n */\r\nlibrary SafeMath16 {\r\n    /**\r\n     * @dev Adds two unsigned integers, reverts on overflow.\r\n     */\r\n    function add(uint16 a, uint16 b) internal pure returns (uint16 c) {\r\n        c = a + b;\r\n        assert(c >= a);\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @dev Subtracts two unsigned integers, reverts on overflow (i.e. if subtrahend is greater than minuend).\r\n     */\r\n    function sub(uint16 a, uint16 b) internal pure returns (uint16) {\r\n        assert(b <= a);\r\n        return a - b;\r\n    }\r\n\r\n    /**\r\n     * @dev Multiplies two unsigned integers, reverts on overflow.\r\n     */\r\n    function mul(uint16 a, uint16 b) internal pure returns (uint16 c) {\r\n        if (a == 0) {\r\n            return 0;\r\n        }\r\n        c = a * b;\r\n        assert(c / a == b);\r\n        return c;\r\n    }\r\n\r\n    /**\r\n     * @dev Integer division of two unsigned integers truncating the quotient,\r\n     * reverts on division by zero.\r\n     */\r\n    function div(uint16 a, uint16 b) internal pure returns (uint16) {\r\n        assert(b > 0);\r\n        uint256 c = a / b;\r\n        assert(a == b * c + a % b);\r\n        return a / b;\r\n    }\r\n\r\n    /**\r\n     * @dev Divides two unsigned integers and returns the remainder (unsigned integer modulo),\r\n     * reverts when dividing by zero.\r\n     */\r\n    function mod(uint16 a, uint16 b) internal pure returns (uint16) {\r\n        require(b != 0);\r\n        return a % b;\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @title Ownable\r\n */\r\ncontract Ownable {\r\n    address private _owner;\r\n    address payable internal _receiver;\r\n\r\n    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\r\n    event ReceiverChanged(address indexed previousReceiver, address indexed newReceiver);\r\n\r\n    /**\r\n     * @dev The Ownable constructor sets the original `owner` of the contract\r\n     * to the sender account.\r\n     */\r\n    constructor () internal {\r\n        _owner = msg.sender;\r\n        _receiver = msg.sender;\r\n    }\r\n\r\n    /**\r\n     * @return The address of the owner.\r\n     */\r\n    function owner() public view returns (address) {\r\n        return _owner;\r\n    }\r\n\r\n    /**\r\n     * @dev Throws if called by any account other than the owner.\r\n     */\r\n    modifier onlyOwner() {\r\n        require(msg.sender == _owner);\r\n        _;\r\n    }\r\n\r\n    /**\r\n     * @dev Allows the current owner to transfer control of the contract to a newOwner.\r\n     * @param newOwner The address to transfer ownership to.\r\n     */\r\n    function transferOwnership(address newOwner) external onlyOwner {\r\n        require(newOwner != _owner);\r\n        address __previousOwner = _owner;\r\n        _owner = newOwner;\r\n        emit OwnershipTransferred(__previousOwner, newOwner);\r\n    }\r\n\r\n   \r\n}\r\n\r\n\r\n/**\r\n * @title Pausable\r\n * @dev Base contract which allows children to implement an emergency stop mechanism.\r\n */\r\ncontract Pausable is Ownable {\r\n    bool private _paused;\r\n\r\n    event Paused(address account);\r\n    event Unpaused(address account);\r\n\r\n    constructor () internal {\r\n        _paused = false;\r\n    }\r\n\r\n    /**\r\n     * @return Returns true if the contract is paused, false otherwise.\r\n     */\r\n    function paused() public view returns (bool) {\r\n        return _paused;\r\n    }\r\n\r\n    /**\r\n     * @dev Modifier to make a function callable only when the contract is not paused.\r\n     */\r\n    modifier whenNotPaused() {\r\n        require(!_paused, \"Paused.\");\r\n        _;\r\n    }\r\n\r\n    /**\r\n     * @dev Called by a pauser to pause, triggers stopped state.\r\n     */\r\n    function setPaused(bool state) external onlyOwner {\r\n        if (_paused && !state) {\r\n            _paused = false;\r\n            emit Unpaused(msg.sender);\r\n        } else if (!_paused && state) {\r\n            _paused = true;\r\n            emit Paused(msg.sender);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * @title ERC20 interface\r\n * @dev see https://eips.ethereum.org/EIPS/eip-20\r\n */\r\ninterface IERC20 {\r\n    function balanceOf(address owner) external view returns (uint256);\r\n    function transfer(address to, uint256 value) external returns (bool);\r\n}\r\n\r\n\r\n/**\r\n * @title Skt interface\r\n */\r\ninterface ISkt {\r\n    function balanceOf(address owner) external view returns (uint256);\r\n    function transfer(address to, uint256 value) external returns (bool);\r\n    function inWhitelist(address account) external view returns (bool);\r\n    function referrer(address account) external view returns (address);\r\n    function refCount(address account) external view returns (uint256);\r\n}\r\n\r\n\r\n/**\r\n * @title Skt Public Sale\r\n */\r\ncontract SktPublicSale is Ownable, Pausable{\r\n    using SafeMath16 for uint16;\r\n    using SafeMath256 for uint256;\r\n\r\n    // Skt\r\n    ISkt public SKT = ISkt(0x2fB74C37Fb2C8DC76beA1910737aa9E3e2b53535);\r\n\r\n    // Start timestamp\r\n    uint32 _startTimestamp;\r\n\r\n    // Audit ether price\r\n    uint256 private _etherPrice;    \r\n\r\n    // Referral rewards, 35% for 15 levels\r\n    uint16 private WHITELIST_REF_REWARDS_PCT_SUM = 35; \r\n\t\r\n    uint16[3] private WHITELIST_REF_REWARDS_PCT = [\r\n        15,  // 15% for Level.1\r\n        12,  // 12% for Level.2\r\n        8   // 8% for Level.3\r\n    ];\r\n\t\r\n\t\r\n    // Wei & Gas\r\n    uint72 private WEI_MIN = 0.1 ether;     \r\n    uint72 private WEI_MAX = 100 ether;     \r\n    uint72 private WEI_BONUS = 10 ether;    \r\n    uint24 private GAS_MIN = 3000000;       \r\n    uint24 private GAS_EX  = 1500000;        \r\n\r\n    // Price\r\n    uint256 private SKT_USD_PRICE_START = 100000;       \r\n    uint256 private SKT_USD_PRICE_STEP = 10000;         \r\n   \r\n    uint256 private STAGE_USD_CAP_START = 9000000000000;    \r\n    uint256 private STAGE_USD_CAP_STEP = 900000000000;       \r\n    uint256 private STAGE_USD_CAP_MAX = 90000000000000;   \r\n    \r\n    uint256 private STAGE_SKT_CAP_START = 900000000000;    \r\n    uint256 private STAGE_SKT_CAP_STEP  = 900000000000;       \r\n    uint256 private STAGE_SKT_CAP_MAX   = 90000000000000;    \r\n    \r\n    uint256 private _SKTUsdPrice = SKT_USD_PRICE_START; \r\n    \r\n    uint16 private STAGE_MAX = 100;  \r\n    \r\n\r\n    uint16 private _stage;\r\n   \r\n\r\n    // Sum\r\n    uint256 private _txs; \r\n    uint256 private _SKTTxs;\r\n    uint256 private _SKTBonusTxs;\r\n    uint256 private _SKTWhitelistTxs;\r\n    uint256 private _SKTIssued;\r\n    uint256 private _SKTBonus;\r\n    uint256 private _SKTWhitelist;\r\n    uint256 private _usdSold;\r\n    uint256 private _weiSold;  \r\n    uint256 private _weiRefRewarded;  \r\n    uint256 private _weiTeam; \r\n    \r\n\r\n\r\n    // During tx\r\n    bool private _inWhitelist_;\r\n   \r\n    uint16[] private _rewards_;\r\n    address[] private _referrers_;\r\n\r\n    \r\n\r\n    // Stage\r\n    mapping (uint16 => uint256) private _stageUsdSold; \r\n    mapping (uint16 => uint256) private _stageSKTIssued; \r\n   \r\n\r\n   \r\n\r\n    // Account\r\n    mapping (address => uint256) private _accountSKTIssued;\r\n    mapping (address => uint256) private _accountSKTBonus;\r\n    mapping (address => uint256) private _accountSKTWhitelisted;\r\n    mapping (address => uint256) private _accountWeiPurchased; \r\n    mapping (address => uint256) private _accountWeiRefRewarded; \r\n\r\n  \r\n   \r\n\r\n    // Events\r\n    event AuditEtherPriceChanged(uint256 value, address indexed account);\r\n    event AuditEtherPriceAuditorChanged(address indexed account, bool state);\r\n\r\n    event SKTBonusTransfered(address indexed to, uint256 amount);\r\n    event SKTWhitelistTransfered(address indexed to, uint256 amount);\r\n    event SKTIssuedTransfered(uint16 stageIndex, address indexed to, uint256 SKTAmount, uint256 auditEtherPrice, uint256 weiUsed);\r\n\r\n    event StageClosed(uint256 _stageNumber, address indexed account);\r\n   \r\n    event TeamWeiTransfered(address indexed to, uint256 amount);\r\n    event PendingWeiTransfered(address indexed to, uint256 amount);\r\n\r\n\r\n    /**\r\n     * @dev Start timestamp.\r\n     */\r\n    function startTimestamp() public view returns (uint32) {\r\n        return _startTimestamp;\r\n    }\r\n\r\n    /**\r\n     * @dev Set start timestamp.\r\n     */\r\n    function setStartTimestamp(uint32 timestamp) external onlyOwner {\r\n        _startTimestamp = timestamp;\r\n    }\r\n\r\n  \r\n\r\n    /**\r\n     * @dev Set audit ether price.\r\n     */\r\n    function setEtherPrice(uint256 value) external onlyOwner {\r\n        _etherPrice = value;\r\n        emit AuditEtherPriceChanged(value, msg.sender);\r\n    }\r\n\r\n \r\n\r\n   \r\n\r\n    /**\r\n     * @dev Stage SKT price in USD, by stage index.\r\n     */\r\n\t//返回 当前 阶段 USD的 值\r\n\tfunction stageSKTUsdPrice(uint16 stageIndex) private view returns (uint256) {\r\n\t\t\r\n        return SKT_USD_PRICE_START.add(SKT_USD_PRICE_STEP.mul(stageIndex));\r\n    }\r\n\r\n    /**\r\n     * @dev wei => USD\r\n     */\r\n    function wei2usd(uint256 amount) private view returns (uint256) {\r\n        return amount.mul(_etherPrice).div(1 ether);\r\n    }\r\n\r\n    /**\r\n     * @dev USD => wei\r\n     */\r\n    function usd2wei(uint256 amount) private view returns (uint256) {\r\n        return amount.mul(1 ether).div(_etherPrice);\r\n    }\r\n\r\n    /**\r\n     * @dev USD => SKT\r\n     */\r\n    function usd2SKT(uint256 usdAmount) private view returns (uint256) {\r\n      \r\n\t\treturn usdAmount.mul(1000000).div(_SKTUsdPrice);\r\n    }\r\n    \r\n     /**\r\n     * @dev SKT => USD\r\n     */\r\n    function SKT2usd(uint256 usdAmount) private view returns (uint256) {\r\n      \r\n\t\treturn usdAmount.mul(_SKTUsdPrice).div(1000000);\r\n    }\r\n\r\n    /**\r\n     * @dev USD => SKT\r\n     */\r\n    function usd2SKTByStage(uint256 usdAmount, uint16 stageIndex) public view returns (uint256) {\r\n\r\n        if(stageIndex<1){\r\n            stageIndex = 0;\r\n        }\r\n        return usdAmount.mul(1000000).div(stageSKTUsdPrice(stageIndex));\r\n    }\r\n\r\n\r\n    /**\r\n     * @dev Status.\r\n     */\r\n    function status() public view returns (uint256 auditEtherPrice,\r\n                                           uint16 stage,\r\n                                           uint256 SKTUsdPrice,\r\n                                           uint256 txs,\r\n                                           uint256 SKTTxs,\r\n                                           uint256 SKTBonusTxs,\r\n                                           uint256 SKTWhitelistTxs,\r\n                                           uint256 SKTIssued,\r\n                                           uint256 SKTBonus,\r\n                                           uint256 useSold,\r\n                                           uint256 weiSold,\r\n                                           uint256 weiReferralRewarded,\r\n                                           uint256 weiTeam) {\r\n        auditEtherPrice = _etherPrice;\r\n\r\n        if (_stage > STAGE_MAX) {\r\n            stage = STAGE_MAX;\r\n            \r\n        } else {\r\n            stage = _stage + 1;\r\n            \r\n        }\r\n\r\n        SKTUsdPrice = _SKTUsdPrice;\r\n        txs = _txs;\r\n        SKTTxs = _SKTTxs;\r\n        SKTBonusTxs = _SKTBonusTxs;\r\n        SKTWhitelistTxs = _SKTWhitelistTxs;\r\n        SKTIssued = _SKTIssued;\r\n        SKTBonus = _SKTBonus;\r\n        useSold = _usdSold;\r\n        weiSold = _weiSold;\r\n        weiReferralRewarded = _weiRefRewarded;\r\n        weiTeam = _weiTeam;\r\n    }\r\n\r\n   \r\n\r\n    /**\r\n     * @dev Throws if gas is not enough.\r\n     */\r\n    modifier enoughGas() {\r\n        require(gasleft() > GAS_MIN);\r\n        _;\r\n    }\r\n\r\n    /**\r\n     * @dev Throws if not started.\r\n     */\r\n    modifier onlyOnSale() {\r\n        require(_startTimestamp > 0 && now > _startTimestamp, \"SKT Public-Sale has not started yet.\");\r\n        require(_etherPrice > 0, \"Audit ETH price must be greater than zero.\");\r\n        require(!paused(), \"SKT Public-Sale is paused.\");\r\n        require(_stage <= STAGE_MAX, \"SKT Public-Sale Closed.\");\r\n        _;\r\n    }\r\n\r\n\r\n    /**\r\n     * @dev Calculate stage dollor cap, by stage index.\r\n     */\r\n    function stageUsdCap(uint16 stageIndex) private view returns (uint256) {\r\n        uint256 __usdCap = STAGE_USD_CAP_START.add(STAGE_USD_CAP_STEP.mul(stageIndex));\r\n\r\n        if (__usdCap > STAGE_USD_CAP_MAX) {\r\n            return STAGE_USD_CAP_MAX;\r\n        }\r\n\r\n        return __usdCap;\r\n    }\r\n    \r\n    \r\n    function stageSKTCapGet(uint16 stageIndex) private view returns (uint256) {\r\n        uint256 __sktCap = STAGE_SKT_CAP_START.add(STAGE_SKT_CAP_STEP.mul(stageIndex));\r\n\r\n        if (__sktCap >= STAGE_SKT_CAP_MAX) {\r\n            return STAGE_SKT_CAP_MAX;\r\n        }\r\n\r\n        return __sktCap;\r\n    }\r\n\r\n    /**\r\n     * @dev Stage Vokdn cap, by stage index.\r\n     */\r\n    function stageSKTCap(uint16 stageIndex) private view returns (uint256) {\r\n      \r\n        stageIndex = 1;\r\n        return STAGE_SKT_CAP_STEP.mul(stageIndex);\r\n    }\r\n\r\n    /**\r\n     * @dev Stage status, by stage index.\r\n     */\r\n    function stageStatus(uint16 stageIndex) public view returns (uint256 SKTUsdPrice,\r\n                                                                 uint256 SKTCap,\r\n                                                                 uint256 SKTOnSale,\r\n                                                                 uint256 SKTSold,\r\n                                                                 uint256 weiSold,\r\n                                                                 uint256 usdSold\r\n                                                                 ) {\r\n        if (stageIndex > STAGE_MAX) {\r\n            return (0, 0, 0, 0, 0 , 0);\r\n        }\r\n        \r\n        if(stageIndex<1)\r\n        {\r\n            return (0, 0, 0, 0, 0 , 0);\r\n        }\r\n        \r\n        stageIndex = stageIndex.sub(1);\r\n\r\n        SKTUsdPrice = stageSKTUsdPrice(stageIndex);\r\n\r\n        SKTSold = _stageSKTIssued[stageIndex]; \r\n        SKTCap = stageSKTCap(stageIndex); \r\n        SKTOnSale = SKTCap.sub(SKTSold);\r\n        \r\n        usdSold = _stageUsdSold[stageIndex];\r\n        weiSold = usd2wei(usdSold);\r\n       \r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * @dev Query account.\r\n     */\r\n    function accountQuery(address account) public view returns (uint256 SKTIssued,\r\n                                                                uint256 SKTWhitelisted,\r\n                                                                uint256 weiPurchased,\r\n                                                                uint256 weiReferralRewarded) {\r\n        SKTIssued = _accountSKTIssued[account];\r\n        SKTWhitelisted = _accountSKTWhitelisted[account];\r\n        weiPurchased = _accountWeiPurchased[account];\r\n        weiReferralRewarded = _accountWeiRefRewarded[account];\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * @dev constructor\r\n     */\r\n    constructor () public {\r\n       \r\n        _stage = 0;\r\n        \r\n    }\r\n    \r\n\r\n    /**\r\n     * @dev Receive ETH, and send SKTs.\r\n     */\r\n    function () external payable enoughGas onlyOnSale {\r\n        require(msg.value >= WEI_MIN); // WEI_MIN 0.1 ether\r\n        require(msg.value <= WEI_MAX); // WEI_MAX 100 ether\r\n\r\n        // Set temporary variables.\r\n        setTemporaryVariables();\r\n\t\t\r\n\t\t\r\n        uint256 __usdAmount = wei2usd(msg.value);\r\n        uint256 __usdRemain = __usdAmount;\r\n        uint256 __sktRemain = usd2SKT(__usdAmount);\r\n        uint256 __SKTIssued; \r\n        uint256 __usdUsed;\r\n        uint256 __weiUsed;\r\n        \r\n        \r\n        \r\n        // USD => SKT\r\n\t\twhile (gasleft() > GAS_EX && __sktRemain > 0 && _stage <= STAGE_MAX) {\r\n\t\t\t\r\n\t\t\tif(_stage.add(1)==STAGE_MAX && _stageSKTIssued[_stage] == STAGE_SKT_CAP_STEP){\r\n\t\t\t    break;\r\n\t\t\t}\r\n\t\t\t\r\n            uint256 __txSKTIssued;\r\n\t\t\t\r\n            (__txSKTIssued, __usdRemain,__sktRemain) = ex(__usdRemain);\r\n            __SKTIssued = __SKTIssued.add(__txSKTIssued);\r\n        }\r\n        \r\n        \r\n\r\n        // Used\r\n        __usdUsed = __usdAmount.sub(__usdRemain);\r\n        __weiUsed = usd2wei(__usdUsed);\r\n\r\n       \r\n        // Whitelisted\r\n        // BUY-ONE-AND-GET-ONE-MORE-FREE\r\n        if (_inWhitelist_ && __SKTIssued > 0 && _stage <= STAGE_MAX) {\r\n            // both issued and bonus\r\n            assert(transferSKTWhitelisted(__SKTIssued));\r\n\r\n            // 35% for 3 levels\r\n            sendWhitelistReferralRewards(__weiUsed);\r\n        }\r\n\r\n        // If wei remains, refund.\r\n        if (__usdRemain > 0) {\r\n            uint256 __weiRemain = usd2wei(__usdRemain);\r\n\r\n            __weiUsed = msg.value.sub(__weiRemain);\r\n            \r\n            // Refund wei back\r\n            msg.sender.transfer(__weiRemain);\r\n        }\r\n\r\n        // Counter\r\n        if (__weiUsed > 0) {\r\n\t\t\r\n            _txs = _txs.add(1);\r\n\t\t\r\n            _weiSold = _weiSold.add(__weiUsed);\r\n\t\t\r\n            _accountWeiPurchased[msg.sender] = _accountWeiPurchased[msg.sender].add(__weiUsed);\r\n        }\r\n\r\n        // Wei team\r\n        uint256 __weiTeam;\r\n       \r\n        __weiTeam = _weiSold.sub(_weiRefRewarded).sub(_weiTeam);\r\n\r\n        _weiTeam = _weiTeam.add(__weiTeam);\r\n         \r\n        _receiver.transfer(__weiTeam);\r\n\r\n        // Assert finished\r\n        assert(true);\r\n    }\r\n\r\n    /**\r\n     * @dev Set temporary variables.\r\n     */\r\n    function setTemporaryVariables() private {\r\n        delete _referrers_;\r\n        delete _rewards_;\r\n\t\t\r\n        _inWhitelist_ = SKT.inWhitelist(msg.sender);\r\n\t\t\r\n        \r\n\t\t\r\n        address __cursor = msg.sender;\r\n\r\n        for(uint16 i = 0; i < WHITELIST_REF_REWARDS_PCT.length; i++) {\r\n\t\t\t\r\n            address __refAccount = SKT.referrer(__cursor);\r\n            \r\n            if (__cursor == __refAccount) {\r\n\t\t\t\t\r\n                break;\r\n            }\r\n            \r\n            _rewards_.push(WHITELIST_REF_REWARDS_PCT[i]);\r\n            _referrers_.push(__refAccount);\r\n            \r\n            __cursor = __refAccount;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @dev USD => SKT\r\n     */\r\n    function ex(uint256 usdAmount) private returns (uint256, uint256, uint256) {\r\n\t\r\n\t\t\r\n\t\tuint256 __stageSktCap = STAGE_SKT_CAP_STEP;\r\n\t\tuint256 __SKTsued;\r\n        uint256 __SKTIssued;\r\n        \r\n        __SKTsued = usd2SKT(usdAmount);\r\n\r\n        // in stage\r\n        if (_stageSKTIssued[_stage].add(__SKTsued) <= __stageSktCap) {\r\n            \r\n\t\t\texCount(usdAmount);\r\n\r\n            __SKTIssued = usd2SKT(usdAmount);\r\n            assert(transferSKTIssued(__SKTIssued, usdAmount));\r\n\r\n            // close stage, if stage dollor cap reached\r\n            if (__stageSktCap == _stageSKTIssued[_stage]) {\r\n                assert(closeStage());\r\n            }\r\n\r\n            return (__SKTIssued, 0, 0);\r\n        }\r\n\t\t\r\n        // close stage\r\n        __SKTIssued = __stageSktCap.sub(_stageSKTIssued[_stage]);\r\n        \r\n        uint256 __usdUsed = SKT2usd(__SKTIssued);\r\n        \r\n        \r\n        exCount(__usdUsed);\r\n        \r\n        uint256 __sktRemain = __SKTsued.sub(__SKTIssued);\r\n        uint256 __usdRemain = usdAmount.sub(__usdUsed);\r\n        \r\n        assert(transferSKTIssued(__SKTIssued, __usdUsed));\r\n        assert(closeStage());\r\n\r\n        return (__SKTIssued, __usdRemain, __sktRemain);\r\n    }\r\n\t\r\n   \r\n\r\n    /**\r\n     * @dev Ex counter.\r\n     */\r\n    function exCount(uint256 usdAmount) private {\r\n       \r\n        _stageUsdSold[_stage] = _stageUsdSold[_stage].add(usdAmount);                   // stage sold, in USD\r\n        _usdSold = _usdSold.add(usdAmount);\r\n    }\r\n\r\n    /**\r\n     * @dev Transfer SKT issued.\r\n     */\r\n    function transferSKTIssued(uint256 amount, uint256 usdAmount) private returns (bool) {\r\n        \r\n\t\t_SKTTxs = _SKTTxs.add(1);\r\n\t\r\n        _SKTIssued = _SKTIssued.add(amount);\r\n\t\t\r\n        _stageSKTIssued[_stage] = _stageSKTIssued[_stage].add(amount);\r\n\t\r\n        _accountSKTIssued[msg.sender] = _accountSKTIssued[msg.sender].add(amount);\r\n\r\n        assert(SKT.transfer(msg.sender, amount));\r\n        emit SKTIssuedTransfered(_stage, msg.sender, amount, _etherPrice, usdAmount);\r\n        return true;\r\n    }\r\n\r\n \r\n\r\n    /**\r\n     * @dev Transfer SKT whitelisted.\r\n     */\r\n    function transferSKTWhitelisted(uint256 amount) private returns (bool) {\r\n       \r\n\t\t_SKTWhitelistTxs = _SKTWhitelistTxs.add(1);\r\n\t\t_SKTBonusTxs = _SKTBonusTxs.add(1) ;\r\n\t\t\r\n\t\t\r\n\t\t\r\n\t\tuint256 __stageSktCap = STAGE_SKT_CAP_STEP;//stageSKTCapGet(_stage);\r\n\t    \r\n\t    uint256 __remainSKT = amount; \r\n      \r\n\t    while (_stageSKTIssued[_stage].add(__remainSKT) >= __stageSktCap) {\r\n            \r\n            uint256 __transferSKT = __stageSktCap.sub(_stageSKTIssued[_stage]);\r\n            \r\n                \r\n            _stageSKTIssued[_stage] = _stageSKTIssued[_stage].add(__transferSKT);\r\n            __remainSKT = __remainSKT.sub(__transferSKT);\r\n            \r\n            assert(closeStage());\r\n            \r\n        }\r\n        \r\n        _stageSKTIssued[_stage] = _stageSKTIssued[_stage].add(__remainSKT);\r\n        \r\n        _SKTWhitelist = _SKTWhitelist.add(amount);\r\n\t\t\r\n        _accountSKTWhitelisted[msg.sender] = _accountSKTWhitelisted[msg.sender].add(amount);\r\n        \r\n\t\t_SKTIssued = _SKTIssued.add(amount);\r\n\t\t_SKTBonus =  _SKTBonus.add(amount);\r\n\r\n        \r\n        assert(SKT.transfer(msg.sender, amount));\r\n        \r\n        \r\n        emit SKTWhitelistTransfered(msg.sender, amount);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * Close current stage.\r\n     */\r\n    function closeStage() private returns (bool) {\r\n        emit StageClosed(_stage, msg.sender);\r\n        _stage = _stage.add(1);\r\n        _SKTUsdPrice = stageSKTUsdPrice(_stage);\r\n        \r\n        if(_stage>=STAGE_MAX)\r\n        {\r\n            _stage = STAGE_MAX.sub(1);\r\n        }\r\n       \r\n        return true;\r\n    }\r\n    \r\n    \r\n    /**\r\n     * @dev Send whitelist referral rewards.\r\n     */\r\n    function sendWhitelistReferralRewards(uint256 weiAmount) private {\r\n        uint256 __weiRemain = weiAmount;\r\n         \r\n        for (uint16 i = 0; i < _rewards_.length; i++) {\r\n\t\t\t\r\n            uint256 __weiReward = weiAmount.mul(_rewards_[i]).div(100);\r\n            \r\n            address payable __receiverRefer = address(uint160(_referrers_[i]));\r\n\t\t\r\n            _weiRefRewarded = _weiRefRewarded.add(__weiReward);\r\n\t\t\r\n            _accountWeiRefRewarded[__receiverRefer] = _accountWeiRefRewarded[__receiverRefer].add(__weiReward);\r\n            __weiRemain = __weiRemain.sub(__weiReward);\r\n            \r\n            if(__receiverRefer!=address(this)){\r\n                __receiverRefer.transfer(__weiReward);\r\n            }\r\n        }\r\n\r\n       \r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"state\",\"type\":\"bool\"}],\"name\":\"setPaused\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"status\",\"outputs\":[{\"name\":\"auditEtherPrice\",\"type\":\"uint256\"},{\"name\":\"stage\",\"type\":\"uint16\"},{\"name\":\"SKTUsdPrice\",\"type\":\"uint256\"},{\"name\":\"txs\",\"type\":\"uint256\"},{\"name\":\"SKTTxs\",\"type\":\"uint256\"},{\"name\":\"SKTBonusTxs\",\"type\":\"uint256\"},{\"name\":\"SKTWhitelistTxs\",\"type\":\"uint256\"},{\"name\":\"SKTIssued\",\"type\":\"uint256\"},{\"name\":\"SKTBonus\",\"type\":\"uint256\"},{\"name\":\"useSold\",\"type\":\"uint256\"},{\"name\":\"weiSold\",\"type\":\"uint256\"},{\"name\":\"weiReferralRewarded\",\"type\":\"uint256\"},{\"name\":\"weiTeam\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"usdAmount\",\"type\":\"uint256\"},{\"name\":\"stageIndex\",\"type\":\"uint16\"}],\"name\":\"usd2SKTByStage\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"value\",\"type\":\"uint256\"}],\"name\":\"setEtherPrice\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"stageIndex\",\"type\":\"uint16\"}],\"name\":\"stageStatus\",\"outputs\":[{\"name\":\"SKTUsdPrice\",\"type\":\"uint256\"},{\"name\":\"SKTCap\",\"type\":\"uint256\"},{\"name\":\"SKTOnSale\",\"type\":\"uint256\"},{\"name\":\"SKTSold\",\"type\":\"uint256\"},{\"name\":\"weiSold\",\"type\":\"uint256\"},{\"name\":\"usdSold\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"SKT\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"paused\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"timestamp\",\"type\":\"uint32\"}],\"name\":\"setStartTimestamp\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"startTimestamp\",\"outputs\":[{\"name\":\"\",\"type\":\"uint32\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"account\",\"type\":\"address\"}],\"name\":\"accountQuery\",\"outputs\":[{\"name\":\"SKTIssued\",\"type\":\"uint256\"},{\"name\":\"SKTWhitelisted\",\"type\":\"uint256\"},{\"name\":\"weiPurchased\",\"type\":\"uint256\"},{\"name\":\"weiReferralRewarded\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"value\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"AuditEtherPriceChanged\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"account\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"state\",\"type\":\"bool\"}],\"name\":\"AuditEtherPriceAuditorChanged\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"SKTBonusTransfered\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"SKTWhitelistTransfered\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"stageIndex\",\"type\":\"uint16\"},{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"SKTAmount\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"auditEtherPrice\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"weiUsed\",\"type\":\"uint256\"}],\"name\":\"SKTIssuedTransfered\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"_stageNumber\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"StageClosed\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"TeamWeiTransfered\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"PendingWeiTransfered\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"Paused\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"account\",\"type\":\"address\"}],\"name\":\"Unpaused\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"previousReceiver\",\"type\":\"address\"},{\"indexed\":true,\"name\":\"newReceiver\",\"type\":\"address\"}],\"name\":\"ReceiverChanged\",\"type\":\"event\"}]","ContractName":"SktPublicSale","CompilerVersion":"v0.5.7+commit.6da8b019","OptimizationUsed":"0","Runs":"200","ConstructorArguments":"","Library":"","LicenseType":"None","SwarmSource":"bzzr://056de59ad5b51d94415951f2de2b83b383960222a4eb50271d4e39435e06e325"}]}