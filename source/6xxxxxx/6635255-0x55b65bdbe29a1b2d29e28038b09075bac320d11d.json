{"status":"1","message":"OK","result":[{"SourceCode":"/*\r\n ______   _________  ___   ___   _______    _______             ________  ______      \r\n/_____/\\ /________/\\/__/\\ /__/\\ /______/\\  /______/\\           /_______/\\/_____/\\     \r\n\\::::_\\/_\\__.::.__\\/\\::\\ \\\\  \\ \\\\::::__\\/__\\::::__\\/__         \\__.::._\\/\\:::_ \\ \\    \r\n \\:\\/___/\\  \\::\\ \\   \\::\\/_\\ .\\ \\\\:\\ /____/\\\\:\\ /____/\\  ___      \\::\\ \\  \\:\\ \\ \\ \\   \r\n  \\::___\\/_  \\::\\ \\   \\:: ___::\\ \\\\:\\\\_  _\\/ \\:\\\\_  _\\/ /__/\\     _\\::\\ \\__\\:\\ \\ \\ \\  \r\n   \\:\\____/\\  \\::\\ \\   \\: \\ \\\\::\\ \\\\:\\_\\ \\ \\  \\:\\_\\ \\ \\ \\::\\ \\   /__\\::\\__/\\\\:\\_\\ \\ \\ \r\n    \\_____\\/   \\__\\/    \\__\\/ \\::\\/ \\_____\\/   \\_____\\/  \\:_\\/   \\________\\/ \\_____\\/ \r\n  ______ _______ _    _    _____  ____   ____  _____     _____          __  __ ______  _____ \r\n |  ____|__   __| |  | |  / ____|/ __ \\ / __ \\|  __ \\   / ____|   /\\   |  \\/  |  ____|/ ____|\r\n | |__     | |  | |__| | | |  __| |  | | |  | | |  | | | |  __   /  \\  | \\  / | |__  | (___  \r\n |  __|    | |  |  __  | | | |_ | |  | | |  | | |  | | | | |_ | / /\\ \\ | |\\/| |  __|  \\___ \\ \r\n | |____   | |  | |  | | | |__| | |__| | |__| | |__| | | |__| |/ ____ \\| |  | | |____ ____) |\r\n |______|  |_|  |_|  |_|  \\_____|\\____/ \\____/|_____/   \\_____/_/    \\_\\_|  |_|______|_____/ \r\n                                                                                             \r\n                                                         BY : LmsSky@Gmail.com\r\n*/                            \r\n\r\npragma solidity ^0.4.25;\r\npragma experimental \"v0.5.0\";\r\ncontract safeApi{\r\n    \r\n   modifier safe(){\r\n        address _addr = msg.sender;\r\n        require (_addr == tx.origin,'Error Action!');\r\n        uint256 _codeLength;\r\n        assembly {_codeLength := extcodesize(_addr)}\r\n        require(_codeLength == 0, \"Sender not authorized!\");\r\n            _;\r\n    }\r\n\r\n\r\n    \r\n function toBytes(uint256 _num) internal returns (bytes _ret) {\r\n   assembly {\r\n        _ret := mload(0x10)\r\n        mstore(_ret, 0x20)\r\n        mstore(add(_ret, 0x20), _num)\r\n    }\r\n}\r\n\r\nfunction subStr(string _s, uint start, uint end) internal pure returns (string){\r\n        bytes memory s = bytes(_s);\r\n        string memory copy = new string(end - start);\r\n//        string memory copy = new string(5);\r\n          uint k = 0;\r\n        for (uint i = start; i < end; i++){ \r\n            bytes(copy)[k++] = bytes(_s)[i];\r\n        }\r\n        return copy;\r\n    }\r\n     \r\n\r\n function safePercent(uint256 a,uint256 b) \r\n      internal\r\n      constant\r\n      returns(uint256)\r\n      {\r\n        assert(a>0 && a <=100);\r\n        return  div(mul(b,a),100);\r\n      }\r\n      \r\n  function mul(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    uint256 c = a * b;\r\n    assert(a == 0 || c / a == b);\r\n    return c;\r\n  }\r\n \r\n  function div(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    // assert(b > 0); // Solidity automatically throws when dividing by 0âˆ‚\r\n    uint256 c = a / b;\r\n    // assert(a == b * c + a % b); // There is no case in which this doesn't hold\r\n    return c;\r\n  }\r\n \r\n  function sub(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    assert(b <= a);\r\n    return a - b;\r\n  }\r\n \r\n  function add(uint256 a, uint256 b) internal pure returns (uint256) {\r\n    uint256 c = a + b;\r\n    assert(c >= a);\r\n    return c;\r\n  }\r\n\r\n}\r\n\r\ncontract gameShare is safeApi{\r\n    struct player\r\n    {\r\n        uint256 id;\r\n        address addr;\r\n        uint256 balance;//wei\r\n        uint256 affNumLevel_1;\r\n        uint256 affNumLevel_2;\r\n        uint256 timeStamp;\r\n    }\r\n \r\n    mapping (uint256 => player) public player_;\r\n    mapping (address => uint256) public playAddr_;\r\n    mapping (uint256 => uint256) public playAff_;\r\n    \r\n    mapping (address => uint256) private contractWhite;\r\n    address [] private contractWhitelist;\r\n    \r\n    mapping(address=>uint256) public otherGameAff_;\r\n    \r\n    uint256 private autoPlayId_=123456;\r\n    address public admin_;\r\n    uint256 public gameTicketWei_=10000000000000000;//0.01 ether\r\n    uint8 public leve1Rewards_=50;//%\r\n    uint8 public leve2Rewards_=20;//%\r\n    uint256 public feeAmount_=200;\r\n\r\n\r\n    /* Initializes contract with initial supply tokens to the creator of the contract */\r\n    constructor() public {\r\n        admin_ = msg.sender;\r\n        getPlayId();\r\n        contractWhitelist.push(address(0));\r\n    }\r\n    \r\n    /* Send coins */\r\n    function addGame(uint256 _affCode)\r\n    safe() \r\n    isPlay() \r\n    external\r\n    payable {\r\n        \r\n      if(_affCode == 0 &&  feeAmount_>0){\r\n             feeAmount_--;\r\n      }else{\r\n         require(msg.value == gameTicketWei_,'Please pay the correct eth');\r\n      }\r\n       uint256 _pid=getPlayId();\r\n      if(msg.value==0)\r\n        return;\r\n       \r\n        uint256 adminAmount=msg.value;\r\n        if(_affCode>0 && _affCode != _pid && player_[_affCode].id >0)\r\n        {\r\n             uint256 leve1Amount=safePercent(leve1Rewards_,gameTicketWei_);\r\n             player_[_affCode].affNumLevel_1++;\r\n             playAff_[_pid]=player_[_affCode].id;\r\n             adminAmount-=leve1Amount;\r\n             player_[_affCode].balance+=leve1Amount;\r\n             uint256 leve2Pid=playAff_[_affCode];\r\n              if(leve2Pid>0){\r\n                uint256 leve2Amount=safePercent(leve2Rewards_,gameTicketWei_);\r\n                player_[leve2Pid].affNumLevel_2++;\r\n                adminAmount-=leve2Amount;\r\n                player_[leve2Pid].balance+=leve2Amount;\r\n              }\r\n        }\r\n        player_[playAddr_[admin_]].balance=add(player_[playAddr_[admin_]].balance,adminAmount);\r\n    }\r\n    \r\n    \r\n    function withdraw(uint256 pid) safe() external{\r\n        require(playAddr_[msg.sender] == pid,'Error Action');\r\n        require(player_[pid].addr == msg.sender,'Error Action');\r\n        require(player_[pid].balance >= gameTicketWei_,'Insufficient balance');\r\n        uint256 balance =player_[pid].balance;\r\n        player_[pid].balance=0;\r\n        player_[pid].addr.transfer(balance);\r\n    }\r\n    \r\n\r\n    \r\n    function getPlayId() private returns(uint256){\r\n        \r\n         require(\r\n                playAddr_[msg.sender] ==0,\r\n                \"Error Player\"\r\n            );\r\n        \r\n        autoPlayId_++;\r\n        uint256 _pid=autoPlayId_;\r\n       \r\n        playAddr_[msg.sender]=_pid;\r\n        player_[_pid].id=_pid;\r\n        player_[_pid].addr=msg.sender;\r\n        player_[_pid].balance=0;\r\n        player_[_pid].timeStamp=now;    \r\n        return _pid;\r\n   }\r\n   \r\n     modifier  isPlay(){\r\n            require(\r\n                playAddr_[msg.sender] == 0,\r\n                \"Everyone can only participate once\"\r\n                );        \r\n            _;\r\n        }\r\n    \r\n    function getShareAff(uint256 _affCode) external view returns(uint256,address,address){\r\n        \r\n        \r\n        uint256 pid=playAddr_[msg.sender];\r\n        uint256 level1pid=playAff_[pid];\r\n        if(pid>0 && level1pid>0){\r\n          uint256 level2Pid=playAff_[level1pid];\r\n          return(\r\n            player_[level1pid].id,\r\n            player_[level1pid].addr,\r\n            player_[level2Pid].addr\r\n            );\r\n        }\r\n        uint256 level2Pid=playAff_[_affCode];\r\n        return(\r\n            player_[_affCode].id,\r\n            player_[_affCode].addr,\r\n            player_[level2Pid].addr\r\n            );\r\n    }\r\n        \r\n    function getOtherGameAff() external view returns(uint256,address,address){\r\n        uint256 pid=otherGameAff_[msg.sender];\r\n        require(pid>0 && player_[pid].id>0);\r\n        uint256 level2Pid = playAff_[pid];\r\n        return(\r\n            pid,\r\n            player_[pid].addr,\r\n            player_[level2Pid].addr\r\n            );\r\n    }\r\n  \r\n    //Create a user's sharing relationship\r\n    function addOtherGameAff(uint256 pid,address myAddr,address level1,address level2) public{\r\n        \r\n        uint256 _codeLength;\r\n        address _addr = msg.sender;\r\n        assembly {_codeLength := extcodesize(_addr)}\r\n        require(_codeLength > 0, \"Sender not authorized!\");\r\n        require(contractWhite[_addr]>0,'ERROR');\r\n        require(address(0)!= myAddr);\r\n        require(pid >0 && address(0)!= level1 && player_[pid].addr == level1,'Error1');\r\n        require(myAddr!=level1,'Error4');\r\n        require(myAddr!=level2,'Error4');\r\n        uint256  level2Pid=playAff_[pid];\r\n        require(level2==player_[level2Pid].addr,'Error2');\r\n        uint256 addfPid=otherGameAff_[myAddr];        \r\n        if(addfPid>0){\r\n            require(addfPid ==pid);\r\n            return;\r\n        }\r\n        otherGameAff_[myAddr]=pid;\r\n    }\r\n    \r\n    //update Can get a contract to share information\r\n    function updateCW(address addr,uint8 status) external safe(){\r\n        require(msg.sender==admin_);\r\n        if(status==0){\r\n            if(contractWhite[addr]==0){\r\n                contractWhitelist.push(addr);\r\n                contractWhite[addr]=contractWhitelist.length;\r\n            }\r\n        }else{\r\n           delete contractWhitelist[contractWhite[addr]];\r\n           delete  contractWhite[addr];\r\n        }\r\n    }\r\n    \r\n      //2020.01.01 Close Game\r\n   function closeGame() external safe() {\r\n        uint256 closeTime=1577808000;\r\n        require(now > closeTime,'Time has not arrived');\r\n        require(msg.sender == admin_,'Error');\r\n        selfdestruct(admin_);\r\n    }\r\n    \r\n    function getCwList() external  safe()  view returns( address []){\r\n         require(msg.sender==admin_);\r\n         return contractWhitelist;\r\n    }\r\n        \r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"_affCode\",\"type\":\"uint256\"}],\"name\":\"getShareAff\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"addr\",\"type\":\"address\"},{\"name\":\"status\",\"type\":\"uint8\"}],\"name\":\"updateCW\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"pid\",\"type\":\"uint256\"}],\"name\":\"withdraw\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"feeAmount_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_affCode\",\"type\":\"uint256\"}],\"name\":\"addGame\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"playAff_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"playAddr_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getCwList\",\"outputs\":[{\"name\":\"\",\"type\":\"address[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"closeGame\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"otherGameAff_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOtherGameAff\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"address\"},{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"pid\",\"type\":\"uint256\"},{\"name\":\"myAddr\",\"type\":\"address\"},{\"name\":\"level1\",\"type\":\"address\"},{\"name\":\"level2\",\"type\":\"address\"}],\"name\":\"addOtherGameAff\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"gameTicketWei_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"admin_\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"leve1Rewards_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"player_\",\"outputs\":[{\"name\":\"id\",\"type\":\"uint256\"},{\"name\":\"addr\",\"type\":\"address\"},{\"name\":\"balance\",\"type\":\"uint256\"},{\"name\":\"affNumLevel_1\",\"type\":\"uint256\"},{\"name\":\"affNumLevel_2\",\"type\":\"uint256\"},{\"name\":\"timeStamp\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"leve2Rewards_\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"}]","ContractName":"gameShare","CompilerVersion":"v0.4.25+commit.59dbf8f1","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://62044625f7317bcabd60bceed28dd50d0255bab0b586db9d5d090f55736692c7"}]}