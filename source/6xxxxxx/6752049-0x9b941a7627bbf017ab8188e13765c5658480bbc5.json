{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.24;\r\n\r\ncontract Ownable {\r\n  // state variables\r\n  address owner;\r\n\r\n  // modifiers\r\n  modifier onlyOwner() {\r\n    require(msg.sender == owner);\r\n    _;\r\n  }\r\n\r\n  /*constructor () public {\r\n\t// owner = msg.sender;\r\n\towner = 0x7E8E46802a93Cca96dD063EBD4F4b24DbD7642e1; // mainnet Owner\r\n\towner = 0x805c55Decb84461B27A8ad77AeBda78Eecd37835; // Ropsten Owner\r\n  }*/\r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n/**\r\n * @title Migratable\r\n * Helper contract to support intialization and migration schemes between\r\n * different implementations of a contract in the context of upgradeability.\r\n * To use it, replace the constructor with a function that has the\r\n * `isInitializer` modifier starting with `\"0\"` as `migrationId`.\r\n * When you want to apply some migration code during an upgrade, increase\r\n * the `migrationId`. Or, if the migration code must be applied only after\r\n * another migration has been already applied, use the `isMigration` modifier.\r\n * This helper supports multiple inheritance.\r\n * WARNING: It is the developer's responsibility to ensure that migrations are\r\n * applied in a correct order, or that they are run at all.\r\n * See `Initializable` for a simpler version.\r\n */\r\ncontract Migratable {\r\n  /**\r\n   * @dev Emitted when the contract applies a migration.\r\n   * @param contractName Name of the Contract.\r\n   * @param migrationId Identifier of the migration applied.\r\n   */\r\n  event Migrated(string contractName, string migrationId);\r\n\r\n  /**\r\n   * @dev Mapping of the already applied migrations.\r\n   * (contractName => (migrationId => bool))\r\n   */\r\n  mapping (string => mapping (string => bool)) internal migrated;\r\n\r\n  /**\r\n   * @dev Internal migration id used to specify that a contract has already been initialized.\r\n   */\r\n  string constant private INITIALIZED_ID = \"initialized\";\r\n\r\n\r\n  /**\r\n   * @dev Modifier to use in the initialization function of a contract.\r\n   * @param contractName Name of the contract.\r\n   * @param migrationId Identifier of the migration.\r\n   */\r\n  modifier isInitializer(string contractName, string migrationId) {\r\n    validateMigrationIsPending(contractName, INITIALIZED_ID);\r\n    validateMigrationIsPending(contractName, migrationId);\r\n    _;\r\n    emit Migrated(contractName, migrationId);\r\n    migrated[contractName][migrationId] = true;\r\n    migrated[contractName][INITIALIZED_ID] = true;\r\n  }\r\n\r\n  /**\r\n   * @dev Modifier to use in the migration of a contract.\r\n   * @param contractName Name of the contract.\r\n   * @param requiredMigrationId Identifier of the previous migration, required\r\n   * to apply new one.\r\n   * @param newMigrationId Identifier of the new migration to be applied.\r\n   */\r\n  modifier isMigration(string contractName, string requiredMigrationId, string newMigrationId) {\r\n    require(isMigrated(contractName, requiredMigrationId), \"Prerequisite migration ID has not been run yet\");\r\n    validateMigrationIsPending(contractName, newMigrationId);\r\n    _;\r\n    emit Migrated(contractName, newMigrationId);\r\n    migrated[contractName][newMigrationId] = true;\r\n  }\r\n\r\n  /**\r\n   * @dev Returns true if the contract migration was applied.\r\n   * @param contractName Name of the contract.\r\n   * @param migrationId Identifier of the migration.\r\n   * @return true if the contract migration was applied, false otherwise.\r\n   */\r\n  function isMigrated(string contractName, string migrationId) public view returns(bool) {\r\n    return migrated[contractName][migrationId];\r\n  }\r\n\r\n  /**\r\n   * @dev Initializer that marks the contract as initialized.\r\n   * It is important to run this if you had deployed a previous version of a Migratable contract.\r\n   * For more information see https://github.com/zeppelinos/zos-lib/issues/158.\r\n   */\r\n  function initialize() isInitializer(\"Migratable\", \"1.2.1\") public {\r\n  }\r\n\r\n  /**\r\n   * @dev Reverts if the requested migration was already executed.\r\n   * @param contractName Name of the contract.\r\n   * @param migrationId Identifier of the migration.\r\n   */\r\n  function validateMigrationIsPending(string contractName, string migrationId) private view {\r\n    require(!isMigrated(contractName, migrationId), \"Requested target migration ID has already been run\");\r\n  }\r\n}\r\n\r\n\r\ncontract vchain is Ownable, Migratable {\r\n    // custom types\r\n  struct Entity {\r\n    string name;\r\n    string location;\r\n    string web;\r\n    string  phone;\r\n    uint NoOfPayments;\r\n  }\r\n  \r\n  struct Article {\r\n    uint id;\r\n    address creator;\r\n    address holder;\r\n    string name;\r\n  }\r\n\r\n  // state variables\r\n  mapping (uint => Article) public articles;\r\n  uint articleCounter;\r\n  uint price;\r\n  uint priceMultiple;\r\n  \r\n  // table of address details\r\n  mapping (address => Entity) public AddressToEntity;\r\n\r\n  // events\r\n  event LogSellArticle(\r\n    uint indexed _id,\r\n    address indexed _seller,\r\n    string _name\r\n  );\r\n  event LogBuyArticle(\r\n    uint indexed _id,\r\n    //address indexed _seller,\r\n    address indexed _buyer\r\n    //string _name\r\n  );\r\n  event SetEntity(\r\n      address indexed _entity,\r\n\t  string _name\r\n    );\r\n\r\n  function initialize(uint256 _price, uint _priceMultiple, address _owner) isInitializer(\"vchain\", \"0\") public {\r\n   price = _price;\r\n   priceMultiple = _priceMultiple;\r\n   owner = _owner;\r\n }\r\n\r\n  \r\n  // deactivate the contract\r\n  /* function kill() public onlyOwner {\r\n    selfdestruct(owner);\r\n  } */\r\n\r\n    // don't set constructor because zOS will handle it\r\n    \r\n    function SetPrice(uint _price) public onlyOwner {\r\n        price = _price;\r\n    }\r\n    \r\n    function SetPriceMultiple(uint _priceMultiple) public onlyOwner {\r\n        priceMultiple = _priceMultiple;\r\n    }\r\n    \r\n    function GetPrice() public view returns(uint) {\r\n        return price;\r\n    }\r\n    \r\n    function GetPriceMultiple() public view returns(uint) {\r\n        return priceMultiple;\r\n    } \r\n    \r\n  // Introduce the Entity\r\n  function Intro(string _name, string _location, string _web, string _phone) public {\r\n        AddressToEntity[msg.sender] = Entity(\r\n          _name,\r\n          _location,\r\n          _web,\r\n          _phone,\r\n          0\r\n        );\r\n        \r\n        emit SetEntity(msg.sender, _name);\r\n  }\r\n  \r\n  // Create batch of items\r\n  function CreateBatch(uint _quantity, string _name) public payable {\r\n    // If sales volume is a multiple of 1,000 and times of deposit is not enough, then require the Sender to deposit\r\n    if ((getSaleVolume() >= (AddressToEntity[msg.sender].NoOfPayments + 1) * priceMultiple) || (_quantity > ((AddressToEntity[msg.sender].NoOfPayments + 1) * priceMultiple) - getSaleVolume())) {\r\n        require (_quantity < (priceMultiple * 2)); // this to protect user from riks of creating too many items, as well as to prevent pay only once for quantity of more than two times of price multiple\r\n        require (msg.value == price);\r\n        AddressToEntity[msg.sender].NoOfPayments++;\r\n    }\r\n      \r\n      for(uint i = 1; i <= _quantity; i++) {\r\n            // a new article\r\n            articleCounter++;\r\n            \r\n            articles[articleCounter] = Article(\r\n              articleCounter,\r\n              msg.sender,\r\n              0x0,\r\n              _name\r\n              );\r\n\t\t\t  \r\n\t\t\temit LogSellArticle(articleCounter, msg.sender, _name);\r\n      }\r\n  }\r\n\r\n  // fetch the number of articles in the contract\r\n  function getNumberOfArticles() public view returns (uint) {\r\n    return articleCounter;\r\n  }\r\n\r\n  // fetch and return all article IDs for articles of msg.sender\r\n  function getArticlesOwn() public view returns (uint[]) {\r\n    // prepare output array\r\n    uint[] memory articleIds = new uint[](articleCounter);\r\n\r\n    uint numberOfArticlesOwn = 0;\r\n    // iterate over articles\r\n    for(uint i = 1; i <= articleCounter;  i++) {\r\n      // keep the ID if the article own\r\n      if(\r\n          ((msg.sender == articles[i].creator) || (msg.sender ==articles[i].holder))\r\n         )  {\r\n            articleIds[numberOfArticlesOwn] = articles[i].id;\r\n            numberOfArticlesOwn++;\r\n      }\r\n    }\r\n\r\n    // copy the articleIds array into a smaller forSale array\r\n    uint[] memory forSale = new uint[](numberOfArticlesOwn);\r\n    for(uint j = 0; j < numberOfArticlesOwn; j++) {\r\n      forSale[j] = articleIds[j];\r\n    }\r\n    return forSale;\r\n  }\r\n\r\n// VChain - count the number of items the msg.sender created. Only original creators are charged.\r\n  function getSaleVolume() public view returns (uint) {\r\n    uint volume = 0;\r\n    // iterate over articles\r\n    for(uint i = 1; i <= articleCounter;  i++) {\r\n        if (articles[i].creator == msg.sender) {\r\n            volume++;\r\n        }\r\n    }\r\n\r\n    return volume;\r\n  }\r\n  \r\n  // Sell multiple items\r\n  function SellMulti(uint[] _ids, address _buyer) public {\r\n    // we check whether there is an article for sale\r\n    require(articleCounter > 0);\r\n    \r\n    // retrieve articles\r\n    for (uint i=0; i < _ids.length; i++) {\r\n         // we check that the article exists\r\n        require(_ids[i] > 0 && _ids[i] <= articleCounter);\r\n        \r\n        // we retrieve the article\r\n        Article storage article = articles[_ids[i]];\r\n        // we check that if the creator not yet sell, then require msg.sender must be creator. Otherwise, msg.sender must be the holder\r\n    \r\n        if (article.holder == 0X0) {\r\n        // the seller must be the creator\r\n        require(msg.sender == article.creator);\r\n        } else {\r\n        require(msg.sender == article.holder);\r\n        }\r\n        \r\n        // keep buyer's information\r\n        article.holder = _buyer;\r\n        \r\n        // trigger the event\r\n        emit LogBuyArticle(_ids[i], article.holder);\r\n    }\r\n  }\r\n  \r\n  function getOwner() public view returns(address) {\r\n      return owner;\r\n  }\r\n  \r\n  // withdraw fund\r\n  function withdraw() public onlyOwner {\r\n      msg.sender.transfer(address(this).balance);\r\n  }\r\n  \r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"GetPriceMultiple\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_name\",\"type\":\"string\"},{\"name\":\"_location\",\"type\":\"string\"},{\"name\":\"_web\",\"type\":\"string\"},{\"name\":\"_phone\",\"type\":\"string\"}],\"name\":\"Intro\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_priceMultiple\",\"type\":\"uint256\"}],\"name\":\"SetPriceMultiple\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdraw\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_price\",\"type\":\"uint256\"}],\"name\":\"SetPrice\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getArticlesOwn\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"GetPrice\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"address\"}],\"name\":\"AddressToEntity\",\"outputs\":[{\"name\":\"name\",\"type\":\"string\"},{\"name\":\"location\",\"type\":\"string\"},{\"name\":\"web\",\"type\":\"string\"},{\"name\":\"phone\",\"type\":\"string\"},{\"name\":\"NoOfPayments\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"initialize\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getOwner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getNumberOfArticles\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_price\",\"type\":\"uint256\"},{\"name\":\"_priceMultiple\",\"type\":\"uint256\"},{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"initialize\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getSaleVolume\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_ids\",\"type\":\"uint256[]\"},{\"name\":\"_buyer\",\"type\":\"address\"}],\"name\":\"SellMulti\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"contractName\",\"type\":\"string\"},{\"name\":\"migrationId\",\"type\":\"string\"}],\"name\":\"isMigrated\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_quantity\",\"type\":\"uint256\"},{\"name\":\"_name\",\"type\":\"string\"}],\"name\":\"CreateBatch\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"articles\",\"outputs\":[{\"name\":\"id\",\"type\":\"uint256\"},{\"name\":\"creator\",\"type\":\"address\"},{\"name\":\"holder\",\"type\":\"address\"},{\"name\":\"name\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_id\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"_seller\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_name\",\"type\":\"string\"}],\"name\":\"LogSellArticle\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_id\",\"type\":\"uint256\"},{\"indexed\":true,\"name\":\"_buyer\",\"type\":\"address\"}],\"name\":\"LogBuyArticle\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"_entity\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"_name\",\"type\":\"string\"}],\"name\":\"SetEntity\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"contractName\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"migrationId\",\"type\":\"string\"}],\"name\":\"Migrated\",\"type\":\"event\"}]","ContractName":"vchain","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://9deb3320fe3c62ed4f8d3103ff45f494623adc5f52b69ecb38cfc0aef450e2fc"}]}