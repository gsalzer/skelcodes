{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.16;\r\n\r\n\r\ncontract streamDesk {\r\n    \r\n        struct Deal {\r\n        uint256 value;\r\n        uint256 cancelTime;\r\n        string seller;\r\n        string buyer;\r\n        byte status;\r\n        uint256 commission;\r\n        string temporaryWallet;\r\n        }\r\n    \r\n    Deal[] public deals;\r\n    \r\n    \r\n    \r\n    byte constant public startDeal          = 0x01;\r\n    byte constant public coinTrasnferred    = 0x02;\r\n    byte constant public coinNotTrasnferred = 0x03;\r\n    byte constant public fiatTrasnferred    = 0x04;\r\n    byte constant public fiatNotTrasnferred = 0x05;\r\n    byte constant public coinRelease        = 0x06;\r\n    byte constant public coinReturn         = 0x07;\r\n    \r\n    \r\n    \r\n    event newDeal( bytes32, string, string);\r\n    event dealChangedStatus(bytes32, byte);\r\n    address public owner;\r\n    address public serviceAddress;\r\n    mapping(bytes32 => uint)  public dealsIndex;\r\n    \r\n    constructor(address _serviceAddress) {\r\n        owner = msg.sender;\r\n        serviceAddress = _serviceAddress;\r\n\r\n    }\r\n    \r\n    byte defaultStatus = 0x01;\r\n    \r\n    function changeServiceAddress(address _serviceAddress) public {\r\n        require(msg.sender == owner);\r\n        serviceAddress = _serviceAddress;\r\n    }\r\n    \r\n\r\n    \r\n    \r\n    function addDeal(uint _value, string _seller, string _buyer, uint _commission, bytes32 _hashDeal, string _temporaryWallet) public  {\r\n        require(msg.sender == serviceAddress);\r\n        require(dealsIndex[_hashDeal] == 0);\r\n        deals.push(Deal(_value,\r\n                        now + 7200,\r\n                        _seller, \r\n                        _buyer,\r\n                        0x01,\r\n                        _commission,\r\n                        _temporaryWallet\r\n                        )\r\n                    );\r\n        dealsIndex[_hashDeal] = deals.length;\r\n        emit newDeal(_hashDeal, _buyer, _seller);\r\n    }\r\n    \r\n\r\n\r\n    function changeStatus(byte _newStatus, bytes32 _hashDeal ) public {\r\n        require(msg.sender == serviceAddress);\r\n\r\n  \r\n        if(deals[dealsIndex[_hashDeal] - 1].status == 0x01) {\r\n            require(_newStatus == 0x02 || _newStatus == 0x03);\r\n        }\r\n        else if(deals[dealsIndex[_hashDeal] - 1].status == 0x02) {\r\n            require(_newStatus == 0x04 || _newStatus == 0x05);\r\n        }\r\n        else if(deals[dealsIndex[_hashDeal] - 1].status == 0x04) {\r\n            require(_newStatus == 0x06);\r\n        }\r\n        else if(deals[dealsIndex[_hashDeal] - 1].status == 0x05) {\r\n            require(_newStatus == 0x07);\r\n        }\r\n        \r\n         emit dealChangedStatus(\r\n                               _hashDeal, \r\n                               _newStatus);\r\n                               \r\n        if(_newStatus == 0x03 || _newStatus == 0x06 || _newStatus == 0x07) {\r\n            delete deals[dealsIndex[_hashDeal] -1];\r\n            dealsIndex[_hashDeal] = 0;\r\n        }\r\n        else {\r\n            deals[dealsIndex[_hashDeal] - 1].status = _newStatus;\r\n        }\r\n    }\r\n    \r\n    function getDealData(bytes32 _hashDeal) public view returns(uint256, uint256,string,string, byte, uint256,  string) {\r\n        uint  dealIndex = dealsIndex[_hashDeal] - 1;\r\n        return (deals[dealIndex].value, \r\n                deals[dealIndex].cancelTime,\r\n                deals[dealIndex].seller,\r\n                deals[dealIndex].buyer,\r\n                deals[dealIndex].status,\r\n                deals[dealIndex].commission,\r\n                deals[dealIndex].temporaryWallet);\r\n    }\r\n}","ABI":"[{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"name\":\"deals\",\"outputs\":[{\"name\":\"value\",\"type\":\"uint256\"},{\"name\":\"cancelTime\",\"type\":\"uint256\"},{\"name\":\"seller\",\"type\":\"string\"},{\"name\":\"buyer\",\"type\":\"string\"},{\"name\":\"status\",\"type\":\"bytes1\"},{\"name\":\"commission\",\"type\":\"uint256\"},{\"name\":\"temporaryWallet\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"coinRelease\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"coinReturn\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_serviceAddress\",\"type\":\"address\"}],\"name\":\"changeServiceAddress\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"coinNotTrasnferred\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"fiatTrasnferred\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"fiatNotTrasnferred\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"serviceAddress\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newStatus\",\"type\":\"bytes1\"},{\"name\":\"_hashDeal\",\"type\":\"bytes32\"}],\"name\":\"changeStatus\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_hashDeal\",\"type\":\"bytes32\"}],\"name\":\"getDealData\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"string\"},{\"name\":\"\",\"type\":\"string\"},{\"name\":\"\",\"type\":\"bytes1\"},{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"\",\"type\":\"bytes32\"}],\"name\":\"dealsIndex\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_value\",\"type\":\"uint256\"},{\"name\":\"_seller\",\"type\":\"string\"},{\"name\":\"_buyer\",\"type\":\"string\"},{\"name\":\"_commission\",\"type\":\"uint256\"},{\"name\":\"_hashDeal\",\"type\":\"bytes32\"},{\"name\":\"_temporaryWallet\",\"type\":\"string\"}],\"name\":\"addDeal\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"startDeal\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"coinTrasnferred\",\"outputs\":[{\"name\":\"\",\"type\":\"bytes1\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_serviceAddress\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"\",\"type\":\"string\"},{\"indexed\":false,\"name\":\"\",\"type\":\"string\"}],\"name\":\"newDeal\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"\",\"type\":\"bytes32\"},{\"indexed\":false,\"name\":\"\",\"type\":\"bytes1\"}],\"name\":\"dealChangedStatus\",\"type\":\"event\"}]","ContractName":"streamDesk","CompilerVersion":"v0.4.25+commit.59dbf8f1","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"0000000000000000000000003eea925b5d5c8d3b6fe168afa7e5d57a8221657c","Library":"","SwarmSource":"bzzr://678593cea16b851ecb99b5f551d3c212fdf8c3463e72c7125b876bf163f66635"}]}