{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.25;\r\n\r\n//2018.11.26 \r\n\r\n/////設定管理者/////\r\n\r\ncontract owned {\r\n    address public owner;\r\n\r\n    constructor() public{\r\n        owner = msg.sender;\r\n    }\r\n    modifier onlyOwner{\r\n        require(msg.sender == owner);\r\n        _;\r\n    }\r\n    function transferOwnership(address newOwner) public onlyOwner {\r\n        owner = newOwner;\r\n    }\r\n}\r\n\r\ncontract ERC20Basic {\r\n  uint256 public totalSupply;\r\n  function balanceOf(address who) public constant returns (uint256);\r\n  function transfer(address to, uint256 value) public returns(bool);\r\n}\r\n\r\n/////遊戲合約/////\r\n\r\ncontract game is owned{\r\n\r\n//初始設定\r\n    \r\n    bool public stop = false;\r\n    \r\n    address public tokenAddress_GIC = 0x340e85491c5f581360811d0ce5cc7476c72900ba;\r\n    address public tokenAddress_Arina = 0x5c0a1EF3C2426064050417aedbD34a3A011fe8e9;\r\n    \r\n    address public address_A = 0xcC22f3Bd8c684463c0Ed6659a001AA62e0a7A146;\r\n    address public address_B = 0xb0D63Fcfb2101C8a1B9b2f0Ff96A13CfEA1A2E65;\r\n\r\n    mapping (address => uint) readyTime;\r\n    uint public airdrop_GIC = 25*10**18 ;  //酷紅幣為18位小數\r\n    uint public airdrop_Arina = 500*10**18 ;  //Arina幣為18位小數\r\n    \r\n    uint public total_airdrop_GIC = 21000000*10**18; //酷紅幣發送上限為2100萬顆\r\n    uint public total_airdrop_Arina = 84000000*10**18; //Arina發送上限為8400萬顆\r\n    \r\n    uint public sent_times = 0; //發送次數(初始為零)\r\n    uint public sent_limit = total_airdrop_GIC/airdrop_GIC; //發送幣上限次數\r\n\r\n    uint public cooldown = 600;  //////冷卻時間(秒)600秒\r\n    uint24 public Probability = 1000000;  /////中獎機率1/1000000\r\n    \r\n    uint random_source = uint(keccak256(msg.sender, block.difficulty, now));\r\n    \r\n    event Play_game(address indexed from, uint8 player, uint8 comp, uint8 record);\r\n    //紀錄遊戲結果\r\n    event Random(address indexed from, uint24 random_player, uint24 random_lottery);\r\n    //記錄兩個亂數\r\n    \r\n\r\n//管理權限\r\n    \r\n\r\n    function stop_game()onlyOwner public{\r\n        stop = true ;\r\n    }\r\n    \r\n    function start_game()onlyOwner public{\r\n        stop = false ;\r\n    }\r\n\r\n    function set_address_GIC(address new_address)onlyOwner public{\r\n        tokenAddress_GIC = new_address;\r\n    }\r\n    \r\n    function set_address_Arina(address new_address)onlyOwner public{\r\n        tokenAddress_Arina = new_address;\r\n    }\r\n    \r\n    function set_address_A(address new_address)onlyOwner public{\r\n        address_A = new_address;\r\n    }\r\n    \r\n    function set_address_B(address new_address)onlyOwner public{\r\n        address_B = new_address;\r\n    }\r\n\r\n    function set_cooldown(uint new_cooldown)onlyOwner public{\r\n        cooldown = new_cooldown;\r\n    }\r\n\r\n    function withdraw_GIC(uint _amount)onlyOwner public{\r\n        require(ERC20Basic(tokenAddress_GIC).transfer(owner, _amount*10**18));\r\n    }\r\n    \r\n    function withdraw_Arina(uint _amount)onlyOwner public{\r\n        require(ERC20Basic(tokenAddress_Arina).transfer(owner, _amount*10**18));\r\n    }\r\n    \r\n    function withdraw_eth()onlyOwner public{\r\n        owner.transfer(address(this).balance);\r\n    }\r\n\r\n//來猜拳!!!\r\n    function () payable public{\r\n        if (msg.value == 0){\r\n        play_game(0);\r\n        }\r\n    }\r\n\r\n    function play_paper()public{\r\n        play_game(0);\r\n    }\r\n\r\n    function play_scissors()public{\r\n        play_game(1);\r\n    }\r\n\r\n    function play_stone()public{\r\n        play_game(2);\r\n    }\r\n\r\n    function play_game(uint8 player) internal{\r\n        require(stop == false);\r\n        \r\n        require(readyTime[msg.sender] < block.timestamp);\r\n        require(player <= 2);\r\n        \r\n        require(sent_times <= sent_limit);\r\n        //檢查遊戲次數未小於限制次數\r\n        \r\n        random_source += 1;\r\n\r\n        uint8 comp=uint8(uint(keccak256(random_source, block.difficulty, block.timestamp))%3);\r\n        uint8 result = compare(player, comp);\r\n        \r\n\r\n        if (result == 2){ //玩家贏\r\n            sent_times +=1 ;\r\n            require(ERC20Basic(tokenAddress_GIC).transfer(msg.sender, airdrop_GIC));\r\n            \r\n            (uint _player_amount,uint addressA_amount, uint addressB_amount)\r\n             = Arina_amount();\r\n             \r\n            require(ERC20Basic(tokenAddress_Arina).transfer(msg.sender, _player_amount));\r\n            require(ERC20Basic(tokenAddress_Arina).transfer(address_A , addressA_amount));\r\n            require(ERC20Basic(tokenAddress_Arina).transfer(address_B, addressB_amount));\r\n        }\r\n        \r\n        else if(result == 1){ //平手\r\n        }\r\n        \r\n        else if(result == 0){ //玩家輸\r\n            readyTime[msg.sender] = block.timestamp + cooldown;\r\n        }\r\n        \r\n        else revert();\r\n        \r\n        uint bal = ERC20Basic(tokenAddress_GIC).balanceOf(this) + ERC20Basic(tokenAddress_Arina).balanceOf(this);\r\n        \r\n        uint24 random_player = uint24(keccak256(msg.sender, now, random_source))%Probability;\r\n        uint24 random_lottery = uint24(keccak256(random_source, block.difficulty, bal))%Probability;\r\n        \r\n        emit Play_game(msg.sender, player, comp, result);\r\n        emit Random(msg.sender, random_player, random_lottery);\r\n        \r\n        //0-999999的亂數\r\n        \r\n        if (random_player == random_lottery){\r\n            uint8 _level = level_judgment(msg.sender);\r\n            uint _eth = eth_amount_judgment(_level);\r\n            if (address(this).balance >= _eth){\r\n                msg.sender.transfer(_eth);\r\n            }\r\n            else{\r\n                msg.sender.transfer(address(this).balance);\r\n            }\r\n            \r\n            //中獎的話傳送eth\r\n        }\r\n        \r\n    }\r\n\r\n//判斷用function\r\n\r\n    function compare(uint8 _player,uint _comp) pure internal returns(uint8 result){\r\n        // input     0 => 布   1 => 剪刀   2 => 石頭\r\n        // output    0 => 輸   1 => 平手   2 => 贏\r\n        uint8 _result;\r\n\r\n        if (_player==0 && _comp==2){  //布贏石頭 (玩家贏)\r\n            _result = 2;\r\n        }\r\n\r\n        else if(_player==2 && _comp==0){ //石頭輸布(玩家輸)\r\n            _result = 0;\r\n        }\r\n\r\n        else if(_player == _comp){ //平手\r\n            _result = 1;\r\n        }\r\n\r\n        else{\r\n            if (_player > _comp){ //玩家贏 (玩家贏)\r\n                _result = 2;\r\n            }\r\n            else{ //玩家輸\r\n                _result = 0;\r\n            }\r\n        }\r\n        return _result;\r\n    }\r\n\r\n\r\n    function Arina_judgment() view public returns(uint _amount){\r\n        uint Arina_totBalance = ERC20Basic(tokenAddress_Arina).balanceOf(this);\r\n        if (Arina_totBalance >= total_airdrop_Arina/2){\r\n            return airdrop_Arina;\r\n        }\r\n        else if(total_airdrop_Arina/2 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/4){\r\n            return airdrop_Arina/2;\r\n        }\r\n        else if(total_airdrop_Arina/4 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/8){\r\n            return airdrop_Arina/4;\r\n        }\r\n        else if(total_airdrop_Arina/8 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/16){\r\n            return airdrop_Arina/8;\r\n        }\r\n        else if(total_airdrop_Arina/16 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/32){\r\n            return airdrop_Arina/16;\r\n        }\r\n        else if(total_airdrop_Arina/32 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/64){\r\n            return airdrop_Arina/32;\r\n        }\r\n        else if(total_airdrop_Arina/64 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/128){\r\n            return airdrop_Arina/64;\r\n        }\r\n        else if(total_airdrop_Arina/128 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/256){\r\n            return airdrop_Arina/128;\r\n        }\r\n        else if(total_airdrop_Arina/256 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/512){\r\n            return airdrop_Arina/256;\r\n        }\r\n        else if(total_airdrop_Arina/512 > Arina_totBalance\r\n        && Arina_totBalance >= total_airdrop_Arina/1024){\r\n            return airdrop_Arina/512;\r\n        }\r\n        else revert();\r\n    }\r\n    \r\n    function level_judgment(address _address) view public returns(uint8 _level){\r\n        uint GIC_balance = ERC20Basic(tokenAddress_GIC).balanceOf(_address);\r\n        if (GIC_balance <= 1000*10**18){\r\n            return 1;\r\n        }\r\n        else if(1000*10**18 < GIC_balance && GIC_balance <=10000*10**18){\r\n            return 2;\r\n        }\r\n        else if(10000*10**18 < GIC_balance && GIC_balance <=100000*10**18){\r\n            return 3;\r\n        }\r\n        else if(100000*10**18 < GIC_balance && GIC_balance <=500000*10**18){\r\n            return 4;\r\n        }\r\n        else if(500000*10**18 < GIC_balance){\r\n            return 5;\r\n        }\r\n        else revert();\r\n    }\r\n    \r\n    function eth_amount_judgment(uint8 _level) pure public returns(uint _eth){\r\n        if (_level == 1){\r\n            return 1 ether;\r\n        }\r\n        else if (_level == 2){\r\n            return 3 ether;\r\n        }\r\n        else if (_level == 3){\r\n            return 5 ether;\r\n        }\r\n        else if (_level == 4){\r\n            return 10 ether;\r\n        }\r\n        else if (_level == 5){\r\n            return 20 ether;\r\n        }\r\n        else revert();\r\n    }\r\n    \r\n    function Arina_amount_judgment(uint8 _level, uint _Arina) \r\n    pure public returns(uint _player, uint _addressA, uint _addressB){\r\n        if (_level == 1){\r\n            return (_Arina*5/10, _Arina*1/10, _Arina*4/10);\r\n        }\r\n        else if (_level == 2){\r\n            return (_Arina*6/10, _Arina*1/10, _Arina*3/10);\r\n        }\r\n        else if (_level == 3){\r\n            return (_Arina*7/10, _Arina*1/10, _Arina*2/10);\r\n        }\r\n        else if (_level == 4){\r\n            return (_Arina*8/10, _Arina*1/10, _Arina*1/10);\r\n        }\r\n        else if (_level == 5){\r\n            return (_Arina*9/10, _Arina*1/10, 0);\r\n        }\r\n        else revert();\r\n    }\r\n    \r\n    function Arina_amount() view public returns(uint _player, uint _addressA, uint _addressB){\r\n        uint8 _level = level_judgment(msg.sender);\r\n        uint _amount = Arina_judgment();\r\n        return Arina_amount_judgment(_level, _amount);\r\n    }\r\n    \r\n\r\n\r\n//查詢\r\n    \r\n    function view_readyTime(address _address) view public returns(uint _readyTime){\r\n        if (block.timestamp >= readyTime[_address]){\r\n            return 0 ;\r\n        }\r\n        else{\r\n            return readyTime[_address] - block.timestamp ;\r\n        }\r\n    }\r\n    function self_readyTime() view public returns(uint _readyTime){\r\n        return view_readyTime(msg.sender);\r\n    }\r\n\r\n}","ABI":"[{\"constant\":true,\"inputs\":[],\"name\":\"address_A\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"stop\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdraw_Arina\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"start_game\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"airdrop_Arina\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Arina_judgment\",\"outputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"address_B\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"play_stone\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"sent_times\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Arina_amount\",\"outputs\":[{\"name\":\"_player\",\"type\":\"uint256\"},{\"name\":\"_addressA\",\"type\":\"uint256\"},{\"name\":\"_addressB\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"Probability\",\"outputs\":[{\"name\":\"\",\"type\":\"uint24\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_address\",\"type\":\"address\"}],\"name\":\"set_address_B\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_address\",\"type\":\"address\"}],\"name\":\"set_address_A\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"view_readyTime\",\"outputs\":[{\"name\":\"_readyTime\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"cooldown\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"play_paper\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenAddress_GIC\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"stop_game\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"total_airdrop_GIC\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"sent_limit\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"play_scissors\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"total_airdrop_Arina\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"tokenAddress_Arina\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"airdrop_GIC\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_address\",\"type\":\"address\"}],\"name\":\"level_judgment\",\"outputs\":[{\"name\":\"_level\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_address\",\"type\":\"address\"}],\"name\":\"set_address_GIC\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_cooldown\",\"type\":\"uint256\"}],\"name\":\"set_cooldown\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"withdraw_eth\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"new_address\",\"type\":\"address\"}],\"name\":\"set_address_Arina\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_level\",\"type\":\"uint8\"},{\"name\":\"_Arina\",\"type\":\"uint256\"}],\"name\":\"Arina_amount_judgment\",\"outputs\":[{\"name\":\"_player\",\"type\":\"uint256\"},{\"name\":\"_addressA\",\"type\":\"uint256\"},{\"name\":\"_addressB\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_amount\",\"type\":\"uint256\"}],\"name\":\"withdraw_GIC\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"self_readyTime\",\"outputs\":[{\"name\":\"_readyTime\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_level\",\"type\":\"uint8\"}],\"name\":\"eth_amount_judgment\",\"outputs\":[{\"name\":\"_eth\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"player\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"comp\",\"type\":\"uint8\"},{\"indexed\":false,\"name\":\"record\",\"type\":\"uint8\"}],\"name\":\"Play_game\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"random_player\",\"type\":\"uint24\"},{\"indexed\":false,\"name\":\"random_lottery\",\"type\":\"uint24\"}],\"name\":\"Random\",\"type\":\"event\"}]","ContractName":"game","CompilerVersion":"v0.4.25+commit.59dbf8f1","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"","Library":"","SwarmSource":"bzzr://b29e384d307fb11827acdb1b306fd337c2defcb4d16c392c44cf5c19fc0de19f"}]}