{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.25;\r\n\r\ncontract subsetSum {\r\n    // Written by Ciarán Ó hAoláin, Maynooth University 2018\r\n\r\n    // Data types that we need\r\n    struct Number {\r\n        bool exists;\r\n        bool isUsed;\r\n    }\r\n    struct Leader {\r\n        address id;\r\n        uint256 difference;\r\n        uint256[] negativeSet;\r\n        uint256[] positiveSet;\r\n    }\r\n\r\n    // Things that we need to store\r\n    uint256[] numbers;\r\n    mapping (uint256 => Number) numberCheck;\r\n    mapping (address => bool) authorisedEntrants;\r\n    uint256 expiryTime;\r\n    address admin;\r\n    Leader leader;\r\n\r\n    // Initial set up\r\n    constructor (uint256[] memory setElements, uint256 expiry) public {\r\n        require(setElements.length>0 && expiry > now, 'Invalid parameters');\r\n        numbers = setElements;\r\n        for (uint256 i = 0; i<setElements.length; i++) {\r\n            numberCheck[setElements[i]].exists=true;\r\n        }\r\n        expiryTime = expiry;\r\n        admin = msg.sender;\r\n    }\r\n\r\n    // Record an event on the blockchain whenever a new record is recorded\r\n    event RunnerUpSubmission(address indexed submitter, uint256 submitterSolutionDifference);\r\n    event NewRecord(address indexed newRecordHolder, uint256 newRecordDifference);\r\n\r\n    // Only for the competition administrator\r\n    modifier adminOnly {\r\n        require(msg.sender==admin, 'This requires admin privileges');\r\n        _;\r\n    }\r\n\r\n    // Only for authorised entrants\r\n    modifier restrictedAccess {\r\n        require(now<expiryTime && authorisedEntrants[msg.sender], 'Unauthorised entrant');\r\n        _;\r\n    }\r\n\r\n    // Withdrawal of prize pot is only allowed after the competition is over, if and only if\r\n    // the withdrawer is currently on top of the leaderboard OR\r\n    // there is no leader, so admin requests withdrawal OR\r\n    // a month has passed after the deadline and the winner hasn't withdrawn the prize pot, so admin requests withdrawal.\r\n    modifier winnerOnly {\r\n        require(now>expiryTime && (msg.sender==leader.id || ((address(0)==leader.id || now>expiryTime+2629746) && msg.sender==admin)), \"You don't have permission to withdraw the prize\");\r\n        _;\r\n    }\r\n\r\n    // Get the numbers in the problem set\r\n    function getNumbers() public view returns(uint256[] numberSet) {\r\n        return numbers;\r\n    }\r\n\r\n    // Get the details of the current leader on the leaderboard\r\n    function getRecord() public view returns (address winningAddress, uint256 difference, uint256[] negativeSet, uint256[] positiveSet) {\r\n        return (leader.id, leader.difference, leader.negativeSet, leader.positiveSet);\r\n    }\r\n\r\n    // Get the current amount of money in the prize pot guaranteed to the person at the top of the leaderboard when the competition concludes.\r\n    function getPrizePot() public view returns (uint256 prizeFundAmount) {\r\n        return address(this).balance;\r\n    }\r\n\r\n    // Get the expiry timestamp of the contract\r\n    function getExpiryDate() public view returns (uint256 expiryTimestamp) {\r\n        return expiryTime;\r\n    }\r\n    \r\n    // Get all the important Data\r\n    function getData() public view returns(uint256[] numberSet, address winningAddress, uint256 prizeFundAmount, uint256 expiryTimestamp) {\r\n        return (numbers, leader.id, address(this).balance, expiryTime);\r\n    }\r\n\r\n    // This (fallback) function allows anybody to add to the prize pot by simply sending ETH to the contract's address\r\n    function () public payable {    }\r\n\r\n    // For the sake of vanity...\r\n    function getAuthor() public pure returns (string authorName) {\r\n      return \"Written by Ciarán Ó hAoláin, Maynooth University 2018\";\r\n    }\r\n\r\n    // This functions allows the admin to authorise ETH addresses to enter the competition\r\n    function authoriseEntrants(address[] addressesToAuthorise) public adminOnly {\r\n        for (uint256 i = 0; i<addressesToAuthorise.length; i++) authorisedEntrants[addressesToAuthorise[i]]=true;\r\n    }\r\n\r\n    // Allows people to submit a new answer to the leaderboard. If it beats the current record, the new attempt will be recorded on the leaderboard.\r\n    function submitAnswer(uint256[] negativeSetSubmission, uint256[] positiveSetSubmission) public restrictedAccess returns (string response) {\r\n        require(negativeSetSubmission.length+positiveSetSubmission.length>0, 'Invalid submission.');\r\n        uint256 sumNegative = 0;\r\n        uint256 sumPositive = 0;\r\n        // Add everything up\r\n        for (uint256 i = 0; i<negativeSetSubmission.length; i++) {\r\n            require(numberCheck[negativeSetSubmission[i]].exists && !numberCheck[negativeSetSubmission[i]].isUsed, 'Invalid submission.');\r\n            sumNegative+=negativeSetSubmission[i];\r\n            numberCheck[negativeSetSubmission[i]].isUsed = true;\r\n        }\r\n        for (i = 0; i<positiveSetSubmission.length; i++) {\r\n            require(numberCheck[positiveSetSubmission[i]].exists && !numberCheck[positiveSetSubmission[i]].isUsed, 'Invalid submission.');\r\n            sumPositive+=positiveSetSubmission[i];\r\n            numberCheck[positiveSetSubmission[i]].isUsed = true;\r\n        }\r\n        // Input looks valid, now set everything back to normal\r\n        for (i = 0; i<negativeSetSubmission.length; i++) numberCheck[negativeSetSubmission[i]].isUsed = false;\r\n        for (i = 0; i<positiveSetSubmission.length; i++) numberCheck[positiveSetSubmission[i]].isUsed = false;\r\n        // Check the new result, if it's a new record, record it\r\n        uint256 difference = _diff(sumNegative, sumPositive);\r\n        if (leader.id==address(0) || difference<leader.difference) {\r\n            leader.id = msg.sender;\r\n            leader.difference=difference;\r\n            leader.negativeSet=negativeSetSubmission;\r\n            leader.positiveSet=positiveSetSubmission;\r\n            emit NewRecord(msg.sender, difference);\r\n            return \"Congratulations, you are now on the top of the leaderboard.\";\r\n        } else {\r\n            emit RunnerUpSubmission(msg.sender, difference);\r\n            return \"Sorry, you haven't beaten the record.\";\r\n        }\r\n    }\r\n\r\n    // Allows the winner to withdraw the prize pot\r\n    function withdrawPrize(address prizeRecipient) public winnerOnly {\r\n        prizeRecipient.transfer(address(this).balance);\r\n    }\r\n\r\n    // Internal function to check results\r\n    function _diff(uint256 a, uint256 b) private pure returns (uint256 difference) {\r\n        if (a>b) return a-b;\r\n        else return b-a;\r\n    }\r\n\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"prizeRecipient\",\"type\":\"address\"}],\"name\":\"withdrawPrize\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getExpiryDate\",\"outputs\":[{\"name\":\"expiryTimestamp\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getData\",\"outputs\":[{\"name\":\"numberSet\",\"type\":\"uint256[]\"},{\"name\":\"winningAddress\",\"type\":\"address\"},{\"name\":\"prizeFundAmount\",\"type\":\"uint256\"},{\"name\":\"expiryTimestamp\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"negativeSetSubmission\",\"type\":\"uint256[]\"},{\"name\":\"positiveSetSubmission\",\"type\":\"uint256[]\"}],\"name\":\"submitAnswer\",\"outputs\":[{\"name\":\"response\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getPrizePot\",\"outputs\":[{\"name\":\"prizeFundAmount\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getNumbers\",\"outputs\":[{\"name\":\"numberSet\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getAuthor\",\"outputs\":[{\"name\":\"authorName\",\"type\":\"string\"}],\"payable\":false,\"stateMutability\":\"pure\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"addressesToAuthorise\",\"type\":\"address[]\"}],\"name\":\"authoriseEntrants\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"getRecord\",\"outputs\":[{\"name\":\"winningAddress\",\"type\":\"address\"},{\"name\":\"difference\",\"type\":\"uint256\"},{\"name\":\"negativeSet\",\"type\":\"uint256[]\"},{\"name\":\"positiveSet\",\"type\":\"uint256[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"setElements\",\"type\":\"uint256[]\"},{\"name\":\"expiry\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"fallback\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"submitter\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"submitterSolutionDifference\",\"type\":\"uint256\"}],\"name\":\"RunnerUpSubmission\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"name\":\"newRecordHolder\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"newRecordDifference\",\"type\":\"uint256\"}],\"name\":\"NewRecord\",\"type\":\"event\"}]","ContractName":"subsetSum","CompilerVersion":"v0.4.25+commit.59dbf8f1","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"0000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000005bd20ba80000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000001330b85e9ec5830000000000000000000000000000000000000000000000000016e1944a4be99f000000000000000000000000000000000000000000000000003570a8357edf910000000000000000000000000000000000000000000000000048b71be065a7b1000000000000000000000000000000000000000000000000004e6ec5c48de0f1000000000000000000000000000000000000000000000000005f8d938e597490000000000000000000000000000000000000000000000000007c4310823029b100000000000000000000000000000000000000000000000000813ae2190f5cca00000000000000000000000000000000000000000000000000f88e8c7d3c03b6000000000000000000000000000000000000000000000000011f99516565d97000000000000000000000000000000000000000000000000001243fce37941bce000000000000000000000000000000000000000000000000019692b4c94fed2300000000000000000000000000000000000000000000000001da6b2b8367ff4f00000000000000000000000000000000000000000000000001dc6bf8011dea5500000000000000000000000000000000000000000000000002ae0a677fa0c619000000000000000000000000000000000000000000000000032ce6565c69e92000000000000000000000000000000000000000000000000004a03c79fcc5b83700000000000000000000000000000000000000000000000004d33bf26fb03d4000000000000000000000000000000000000000000000000005909986013ed8620000000000000000000000000000000000000000000000000607de0e9fd3f08200000000000000000000000000000000000000000000000006138cbbe41a102b000000000000000000000000000000000000000000000000063afd1b70487a1d0000000000000000000000000000000000000000000000000653cd8d436f091100000000000000000000000000000000000000000000000006b8bda2ea3463dd000000000000000000000000000000000000000000000000072bae9f3d4366c7000000000000000000000000000000000000000000000000073c2fd16a0dd345000000000000000000000000000000000000000000000000075f9ba7ef0e97fa000000000000000000000000000000000000000000000000078a930effa5a1a4000000000000000000000000000000000000000000000000081b832591ca4162000000000000000000000000000000000000000000000000089bfee840063ba900000000000000000000000000000000000000000000000008fe1dbbb4cf785600000000000000000000000000000000000000000000000009306877d8952f4e00000000000000000000000000000000000000000000000009bf2750cf59db170000000000000000000000000000000000000000000000000ab63158437156840000000000000000000000000000000000000000000000000ac61399de6f38300000000000000000000000000000000000000000000000000b2779fb7b359e3e0000000000000000000000000000000000000000000000000baa1d931cafb14d0000000000000000000000000000000000000000000000000cfd9e6dac2a2a470000000000000000000000000000000000000000000000000d07ce0e330491350000000000000000000000000000000000000000000000000d550d1a99058db5","Library":"","SwarmSource":"bzzr://d65f0e17bee3fff0a06ac1ec37dc14dfbd99b10ac085253835eb939f2de128ea"}]}