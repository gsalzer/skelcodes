{"status":"1","message":"OK","result":[{"SourceCode":"pragma solidity ^0.4.24;\r\n\r\n\r\n\r\ncontract Base\r\n{\r\n    uint8 constant HEROLEVEL_MIN = 1;\r\n    uint8 constant HEROLEVEL_MAX = 5;\r\n\r\n    uint8 constant LIMITCHIP_MINLEVEL = 3;\r\n    uint constant PARTWEIGHT_NORMAL = 100;\r\n    uint constant PARTWEIGHT_LIMIT = 40;\r\n\r\n    address creator;\r\n\r\n    constructor() public\r\n    {\r\n        creator = msg.sender;\r\n    }\r\n\r\n    modifier MasterAble()\r\n    {\r\n        require(msg.sender == creator);\r\n        _;\r\n    }\r\n\r\n    function IsLimitPart(uint8 level, uint part) internal pure returns(bool)\r\n    {\r\n        if (level < LIMITCHIP_MINLEVEL) return false;\r\n        if (part < GetPartNum(level)) return false;\r\n        return true;\r\n    }\r\n\r\n    function GetPartWeight(uint8 level, uint part) internal pure returns(uint)\r\n    {\r\n        if (IsLimitPart(level, part)) return PARTWEIGHT_LIMIT;\r\n        return PARTWEIGHT_NORMAL;\r\n    }\r\n    \r\n    function GetPartNum(uint8 level) internal pure returns(uint)\r\n    {\r\n        if (level <= 2) return 3;\r\n        else if (level <= 4) return 4;\r\n        return 5;\r\n    }\r\n\r\n}\r\n\r\ncontract BasicTime\r\n{\r\n    uint constant DAY_SECONDS = 60 * 60 * 24;\r\n\r\n    function GetDayCount(uint timestamp) pure internal returns(uint)\r\n    {\r\n        return timestamp/DAY_SECONDS;\r\n    }\r\n\r\n    function GetExpireTime(uint timestamp, uint dayCnt) pure internal returns(uint)\r\n    {\r\n        uint dayEnd = GetDayCount(timestamp) + dayCnt;\r\n        return dayEnd * DAY_SECONDS;\r\n    }\r\n\r\n}\r\n\r\ncontract BasicAuth is Base\r\n{\r\n\r\n    address master;\r\n    mapping(address => bool) auth_list;\r\n\r\n    function InitMaster(address acc) internal\r\n    {\r\n        require(address(0) != acc);\r\n        master = acc;\r\n    }\r\n\r\n    modifier MasterAble()\r\n    {\r\n        require(msg.sender == creator || msg.sender == master);\r\n        _;\r\n    }\r\n\r\n    modifier OwnerAble(address acc)\r\n    {\r\n        require(acc == tx.origin);\r\n        _;\r\n    }\r\n\r\n    modifier AuthAble()\r\n    {\r\n        require(auth_list[msg.sender]);\r\n        _;\r\n    }\r\n\r\n    function CanHandleAuth(address from) internal view returns(bool)\r\n    {\r\n        return from == creator || from == master;\r\n    }\r\n    \r\n    function SetAuth(address target) external\r\n    {\r\n        require(CanHandleAuth(tx.origin) || CanHandleAuth(msg.sender));\r\n        auth_list[target] = true;\r\n    }\r\n\r\n    function ClearAuth(address target) external\r\n    {\r\n        require(CanHandleAuth(tx.origin) || CanHandleAuth(msg.sender));\r\n        delete auth_list[target];\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\n\r\ncontract ProductionBoiler is BasicAuth\r\n{\r\n\r\n    struct Boiler\r\n    {\r\n        uint m_Expire;\r\n        uint32[] m_Chips;\r\n    }\r\n\r\n    mapping(address => mapping(uint => Boiler)) g_Boilers;\r\n\r\n    constructor(address Master) public\r\n    {\r\n        InitMaster(Master);\r\n    }\r\n\r\n    function IsBoilerValid(address acc, uint idx) external view returns(bool)\r\n    {\r\n        Boiler storage obj = g_Boilers[acc][idx];\r\n        if (obj.m_Chips.length > 0) return false;\r\n        return true;\r\n    }\r\n\r\n    function IsBoilerExpire(address acc, uint idx) external view returns(bool)\r\n    {\r\n        Boiler storage obj = g_Boilers[acc][idx];\r\n        return obj.m_Expire <= now;\r\n    }\r\n\r\n    //=========================================================================\r\n\r\n    function GenerateChips(address acc, uint idx, uint cd, uint32[] chips) external AuthAble OwnerAble(acc)\r\n    {\r\n        Boiler storage obj = g_Boilers[acc][idx];\r\n        obj.m_Expire = cd+now;\r\n        obj.m_Chips = chips;\r\n    }\r\n\r\n    function CollectChips(address acc, uint idx) external AuthAble OwnerAble(acc) returns(uint32[] chips)\r\n    {\r\n        Boiler storage obj = g_Boilers[acc][idx];\r\n        chips = new uint32[](obj.m_Chips.length);\r\n        for (uint i=0; i<obj.m_Chips.length; i++)\r\n        {\r\n            chips[i] = obj.m_Chips[i];\r\n            delete obj.m_Chips[i];\r\n        }\r\n        obj.m_Chips.length = 0;\r\n        obj.m_Expire = 0;\r\n    }\r\n\r\n    function GetBoilerInfo(address acc, uint idx) external view returns(uint, uint32[])\r\n    {\r\n        Boiler storage obj = g_Boilers[acc][idx];\r\n        return (obj.m_Expire,obj.m_Chips);\r\n    }\r\n\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"acc\",\"type\":\"address\"},{\"name\":\"idx\",\"type\":\"uint256\"},{\"name\":\"cd\",\"type\":\"uint256\"},{\"name\":\"chips\",\"type\":\"uint32[]\"}],\"name\":\"GenerateChips\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"acc\",\"type\":\"address\"},{\"name\":\"idx\",\"type\":\"uint256\"}],\"name\":\"IsBoilerValid\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"acc\",\"type\":\"address\"},{\"name\":\"idx\",\"type\":\"uint256\"}],\"name\":\"GetBoilerInfo\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"},{\"name\":\"\",\"type\":\"uint32[]\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"acc\",\"type\":\"address\"},{\"name\":\"idx\",\"type\":\"uint256\"}],\"name\":\"IsBoilerExpire\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"target\",\"type\":\"address\"}],\"name\":\"SetAuth\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"target\",\"type\":\"address\"}],\"name\":\"ClearAuth\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"acc\",\"type\":\"address\"},{\"name\":\"idx\",\"type\":\"uint256\"}],\"name\":\"CollectChips\",\"outputs\":[{\"name\":\"chips\",\"type\":\"uint32[]\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"Master\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"}]","ContractName":"ProductionBoiler","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"00000000000000000000000035f9610d5c11755bb58313b19dab2929038618ed","Library":"","SwarmSource":"bzzr://b4ee027d81fa8405c132930c19d83e453b585238967f641b8aa6f0ceb9a43271"}]}