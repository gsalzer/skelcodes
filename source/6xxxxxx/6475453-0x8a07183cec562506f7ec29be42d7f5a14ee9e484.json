{"status":"1","message":"OK","result":[{"SourceCode":"// File: contracts/GodMode.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title God Mode\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev This contract provides a basic interface for God\r\n///  in a contract as well as the ability for God to pause\r\n///  the contract\r\ncontract GodMode {\r\n    /// @dev Is the contract paused?\r\n    bool public isPaused;\r\n\r\n    /// @dev God's address\r\n    address public god;\r\n\r\n    /// @dev Only God can run this function\r\n    modifier onlyGod()\r\n    {\r\n        require(god == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev This function can only be run while the contract\r\n    ///  is not paused\r\n    modifier notPaused()\r\n    {\r\n        require(!isPaused);\r\n        _;\r\n    }\r\n\r\n    /// @dev This event is fired when the contract is paused\r\n    event GodPaused();\r\n\r\n    /// @dev This event is fired when the contract is unpaused\r\n    event GodUnpaused();\r\n\r\n    constructor() public\r\n    {\r\n        // Make the creator of the contract God\r\n        god = msg.sender;\r\n    }\r\n\r\n    /// @dev God can change the address of God\r\n    /// @param _newGod The new address for God\r\n    function godChangeGod(address _newGod) public onlyGod\r\n    {\r\n        god = _newGod;\r\n    }\r\n\r\n    /// @dev God can pause the game\r\n    function godPause() public onlyGod\r\n    {\r\n        isPaused = true;\r\n\r\n        emit GodPaused();\r\n    }\r\n\r\n    /// @dev God can unpause the game\r\n    function godUnpause() public onlyGod\r\n    {\r\n        isPaused = false;\r\n\r\n        emit GodUnpaused();\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthAuctionsAbstractInterface.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title King of Eth: Auctions Abstract Interface\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Abstract interface contract for auctions of houses\r\ncontract KingOfEthAuctionsAbstractInterface {\r\n    /// @dev Determines if there is an auction at a particular location\r\n    /// @param _x The x coordinate of the auction\r\n    /// @param _y The y coordinate of the auction\r\n    /// @return true if there is an existing auction\r\n    function existingAuction(uint _x, uint _y) public view returns(bool);\r\n}\r\n\r\n// File: contracts/KingOfEthBlindAuctionsReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Blind Auctions Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev This contract provides a reference to the blind auctions contract\r\ncontract KingOfEthBlindAuctionsReferencer is GodMode {\r\n    /// @dev The address of the blind auctions contract\r\n    address public blindAuctionsContract;\r\n\r\n    /// @dev Only the blind auctions contract can run this\r\n    modifier onlyBlindAuctionsContract()\r\n    {\r\n        require(blindAuctionsContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set a new blind auctions contract\r\n    /// @param _blindAuctionsContract the address of the blind auctions\r\n    ///  contract\r\n    function godSetBlindAuctionsContract(address _blindAuctionsContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        blindAuctionsContract = _blindAuctionsContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthOpenAuctionsReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Open Auctions Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev This contract provides a reference to the open auctions contract\r\ncontract KingOfEthOpenAuctionsReferencer is GodMode {\r\n    /// @dev The address of the auctions contract\r\n    address public openAuctionsContract;\r\n\r\n    /// @dev Only the open auctions contract can run this\r\n    modifier onlyOpenAuctionsContract()\r\n    {\r\n        require(openAuctionsContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set a new auctions contract\r\n    function godSetOpenAuctionsContract(address _openAuctionsContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        openAuctionsContract = _openAuctionsContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthAuctionsReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n/// @title King of Eth: Auctions Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev This contract provides a reference to the auctions contracts\r\ncontract KingOfEthAuctionsReferencer is\r\n      KingOfEthBlindAuctionsReferencer\r\n    , KingOfEthOpenAuctionsReferencer\r\n{\r\n    /// @dev Only an auctions contract can run this\r\n    modifier onlyAuctionsContract()\r\n    {\r\n        require(blindAuctionsContract == msg.sender\r\n             || openAuctionsContract == msg.sender);\r\n        _;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthAbstractInterface.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title King of Eth Abstract Interface\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Abstract interface contract for titles and taxes\r\ncontract KingOfEthAbstractInterface {\r\n    /// @dev The address of the current King\r\n    address public king;\r\n\r\n    /// @dev The address of the current Wayfarer\r\n    address public wayfarer;\r\n\r\n    /// @dev Anyone can pay taxes\r\n    function payTaxes() public payable;\r\n}\r\n\r\n// File: contracts/KingOfEthReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Functionality to allow contracts to reference the king contract\r\ncontract KingOfEthReferencer is GodMode {\r\n    /// @dev The address of the king contract\r\n    address public kingOfEthContract;\r\n\r\n    /// @dev Only the king contract can run this\r\n    modifier onlyKingOfEthContract()\r\n    {\r\n        require(kingOfEthContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can change the king contract\r\n    /// @param _kingOfEthContract The new address\r\n    function godSetKingOfEthContract(address _kingOfEthContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        kingOfEthContract = _kingOfEthContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthBoard.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\n\r\n/// @title King of Eth: Board\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Contract for board\r\ncontract KingOfEthBoard is\r\n      GodMode\r\n    , KingOfEthAuctionsReferencer\r\n    , KingOfEthReferencer\r\n{\r\n    /// @dev x coordinate of the top left corner of the boundary\r\n    uint public boundX1 = 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffef;\r\n\r\n    /// @dev y coordinate of the top left corner of the boundary\r\n    uint public boundY1 = 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffef;\r\n\r\n    /// @dev x coordinate of the bottom right corner of the boundary\r\n    uint public boundX2 = 0x800000000000000000000000000000000000000000000000000000000000000f;\r\n\r\n    /// @dev y coordinate of the bottom right corner of the boundary\r\n    uint public boundY2 = 0x800000000000000000000000000000000000000000000000000000000000000f;\r\n\r\n    /// @dev Number used to divide the total number of house locations\r\n    /// after any expansion to yield the number of auctions that  will be\r\n    /// available to start for the expansion's duration\r\n    uint public constant auctionsAvailableDivisor = 10;\r\n\r\n    /// @dev Amount of time the King must wait between increasing the board\r\n    uint public constant kingTimeBetweenIncrease = 2 weeks;\r\n\r\n    /// @dev Amount of time the Wayfarer must wait between increasing the board\r\n    uint public constant wayfarerTimeBetweenIncrease = 3 weeks;\r\n\r\n    /// @dev Amount of time that anyone but the King or Wayfarer must wait\r\n    ///  before increasing the board\r\n    uint public constant plebTimeBetweenIncrease = 4 weeks;\r\n\r\n    /// @dev The last time the board was increased in size\r\n    uint public lastIncreaseTime;\r\n\r\n    /// @dev The direction of the next increase\r\n    uint8 public nextIncreaseDirection;\r\n\r\n    /// @dev The number of auctions that players may choose to start\r\n    ///  for this expansion\r\n    uint public auctionsRemaining;\r\n\r\n    constructor() public\r\n    {\r\n        // Game is paused as God must start it\r\n        isPaused = true;\r\n\r\n        // Set the auctions remaining\r\n        setAuctionsAvailableForBounds();\r\n    }\r\n\r\n    /// @dev Fired when the board is increased in size\r\n    event BoardSizeIncreased(\r\n          address initiator\r\n        , uint newBoundX1\r\n        , uint newBoundY1\r\n        , uint newBoundX2\r\n        , uint newBoundY2\r\n        , uint lastIncreaseTime\r\n        , uint nextIncreaseDirection\r\n        , uint auctionsRemaining\r\n    );\r\n\r\n    /// @dev Only the King can run this\r\n    modifier onlyKing()\r\n    {\r\n        require(KingOfEthAbstractInterface(kingOfEthContract).king() == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev Only the Wayfarer can run this\r\n    modifier onlyWayfarer()\r\n    {\r\n        require(KingOfEthAbstractInterface(kingOfEthContract).wayfarer() == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev Set the total auctions available\r\n    function setAuctionsAvailableForBounds() private\r\n    {\r\n        uint boundDiffX = boundX2 - boundX1;\r\n        uint boundDiffY = boundY2 - boundY1;\r\n\r\n        auctionsRemaining = boundDiffX * boundDiffY / 2 / auctionsAvailableDivisor;\r\n    }\r\n\r\n    /// @dev Increase the board's size making sure to keep steady at\r\n    ///  the maximum outer bounds\r\n    function increaseBoard() private\r\n    {\r\n        // The length of increase\r\n        uint _increaseLength;\r\n\r\n        // If this increase direction is right\r\n        if(0 == nextIncreaseDirection)\r\n        {\r\n            _increaseLength = boundX2 - boundX1;\r\n            uint _updatedX2 = boundX2 + _increaseLength;\r\n\r\n            // Stay within bounds\r\n            if(_updatedX2 <= boundX2 || _updatedX2 <= _increaseLength)\r\n            {\r\n                boundX2 = ~uint(0);\r\n            }\r\n            else\r\n            {\r\n                boundX2 = _updatedX2;\r\n            }\r\n        }\r\n        // If this increase direction is down\r\n        else if(1 == nextIncreaseDirection)\r\n        {\r\n            _increaseLength = boundY2 - boundY1;\r\n            uint _updatedY2 = boundY2 + _increaseLength;\r\n\r\n            // Stay within bounds\r\n            if(_updatedY2 <= boundY2 || _updatedY2 <= _increaseLength)\r\n            {\r\n                boundY2 = ~uint(0);\r\n            }\r\n            else\r\n            {\r\n                boundY2 = _updatedY2;\r\n            }\r\n        }\r\n        // If this increase direction is left\r\n        else if(2 == nextIncreaseDirection)\r\n        {\r\n            _increaseLength = boundX2 - boundX1;\r\n\r\n            // Stay within bounds\r\n            if(boundX1 <= _increaseLength)\r\n            {\r\n                boundX1 = 0;\r\n            }\r\n            else\r\n            {\r\n                boundX1 -= _increaseLength;\r\n            }\r\n        }\r\n        // If this increase direction is up\r\n        else if(3 == nextIncreaseDirection)\r\n        {\r\n            _increaseLength = boundY2 - boundY1;\r\n\r\n            // Stay within bounds\r\n            if(boundY1 <= _increaseLength)\r\n            {\r\n                boundY1 = 0;\r\n            }\r\n            else\r\n            {\r\n                boundY1 -= _increaseLength;\r\n            }\r\n        }\r\n\r\n        // The last increase time is now\r\n        lastIncreaseTime = now;\r\n\r\n        // Set the next increase direction\r\n        nextIncreaseDirection = (nextIncreaseDirection + 1) % 4;\r\n\r\n        // Reset the auctions available\r\n        setAuctionsAvailableForBounds();\r\n\r\n        emit BoardSizeIncreased(\r\n              msg.sender\r\n            , boundX1\r\n            , boundY1\r\n            , boundX2\r\n            , boundY2\r\n            , now\r\n            , nextIncreaseDirection\r\n            , auctionsRemaining\r\n        );\r\n    }\r\n\r\n    /// @dev God can start the game\r\n    function godStartGame() public onlyGod\r\n    {\r\n        // Reset increase times\r\n        lastIncreaseTime = now;\r\n\r\n        // Unpause the game\r\n        godUnpause();\r\n    }\r\n\r\n    /// @dev The auctions contracts can decrement the number\r\n    ///  of auctions that are available to be started\r\n    function auctionsDecrementAuctionsRemaining()\r\n        public\r\n        onlyAuctionsContract\r\n    {\r\n        auctionsRemaining -= 1;\r\n    }\r\n\r\n    /// @dev The auctions contracts can increment the number\r\n    ///  of auctions that are available to be started when\r\n    ///  an auction ends wihout a winner\r\n    function auctionsIncrementAuctionsRemaining()\r\n        public\r\n        onlyAuctionsContract\r\n    {\r\n        auctionsRemaining += 1;\r\n    }\r\n\r\n    /// @dev The King can increase the board much faster than the plebs\r\n    function kingIncreaseBoard()\r\n        public\r\n        onlyKing\r\n    {\r\n        // Require enough time has passed since the last increase\r\n        require(lastIncreaseTime + kingTimeBetweenIncrease < now);\r\n\r\n        increaseBoard();\r\n    }\r\n\r\n    /// @dev The Wayfarer can increase the board faster than the plebs\r\n    function wayfarerIncreaseBoard()\r\n        public\r\n        onlyWayfarer\r\n    {\r\n        // Require enough time has passed since the last increase\r\n        require(lastIncreaseTime + wayfarerTimeBetweenIncrease < now);\r\n\r\n        increaseBoard();\r\n    }\r\n\r\n    /// @dev Any old pleb can increase the board\r\n    function plebIncreaseBoard() public\r\n    {\r\n        // Require enough time has passed since the last increase\r\n        require(lastIncreaseTime + plebTimeBetweenIncrease < now);\r\n\r\n        increaseBoard();\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthBoardReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Board Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Functionality to allow contracts to reference the board contract\r\ncontract KingOfEthBoardReferencer is GodMode {\r\n    /// @dev The address of the board contract\r\n    address public boardContract;\r\n\r\n    /// @dev Only the board contract can run this\r\n    modifier onlyBoardContract()\r\n    {\r\n        require(boardContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can change the board contract\r\n    /// @param _boardContract The new address\r\n    function godSetBoardContract(address _boardContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        boardContract = _boardContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthHousesAbstractInterface.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title King of Eth: Houses Abstract Interface\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Abstract interface contract for houses\r\ncontract KingOfEthHousesAbstractInterface {\r\n    /// @dev Get the owner of the house at some location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @return The address of the owner\r\n    function ownerOf(uint _x, uint _y) public view returns(address);\r\n\r\n    /// @dev Get the level of the house at some location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @return The level of the house\r\n    function level(uint _x, uint _y) public view returns(uint8);\r\n\r\n    /// @dev The auctions contracts can set the owner of a house after an auction\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _owner The new owner of the house\r\n    function auctionsSetOwner(uint _x, uint _y, address _owner) public;\r\n\r\n    /// @dev The house realty contract can transfer house ownership\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _from The previous owner of house\r\n    /// @param _to The new owner of house\r\n    function houseRealtyTransferOwnership(\r\n          uint _x\r\n        , uint _y\r\n        , address _from\r\n        , address _to\r\n    ) public;\r\n}\r\n\r\n// File: contracts/KingOfEthHousesReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Houses Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to reference the houses contract\r\ncontract KingOfEthHousesReferencer is GodMode {\r\n    /// @dev The houses contract's address\r\n    address public housesContract;\r\n\r\n    /// @dev Only the houses contract can run this function\r\n    modifier onlyHousesContract()\r\n    {\r\n        require(housesContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set the realty contract\r\n    /// @param _housesContract The new address\r\n    function godSetHousesContract(address _housesContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        housesContract = _housesContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthHouseRealty.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\n\r\n\r\n/// @title King of Eth: House Realty\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Contract for controlling sales of houses\r\ncontract KingOfEthHouseRealty is\r\n      GodMode\r\n    , KingOfEthHousesReferencer\r\n    , KingOfEthReferencer\r\n{\r\n    /// @dev The number that divides the amount payed for any sale to produce\r\n    ///  the amount payed in taxes\r\n    uint public constant taxDivisor = 25;\r\n\r\n    /// @dev Mapping from the x, y coordinates of a house to the current sale\r\n    ///  price (0 if there is no sale)\r\n    mapping (uint => mapping (uint => uint)) housePrices;\r\n\r\n    /// @dev Fired when there is a new house for sale\r\n    event HouseForSale(\r\n          uint x\r\n        , uint y\r\n        , address owner\r\n        , uint amount\r\n    );\r\n\r\n    /// @dev Fired when the owner changes the price of a house\r\n    event HousePriceChanged(uint x, uint y, uint amount);\r\n\r\n    /// @dev Fired when a house is sold\r\n    event HouseSold(\r\n          uint x\r\n        , uint y\r\n        , address from\r\n        , address to\r\n        , uint amount\r\n        , uint8 level\r\n    );\r\n\r\n    /// @dev Fired when the sale for a house is cancelled by the owner\r\n    event HouseSaleCancelled(\r\n          uint x\r\n        , uint y\r\n        , address owner\r\n    );\r\n\r\n    /// @dev Only the owner of the house at a location can run this\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    modifier onlyHouseOwner(uint _x, uint _y)\r\n    {\r\n        require(KingOfEthHousesAbstractInterface(housesContract).ownerOf(_x, _y) == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev This can only be run if there is *not* an existing sale for a house\r\n    ///  at a location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    modifier noExistingHouseSale(uint _x, uint _y)\r\n    {\r\n        require(0 == housePrices[_x][_y]);\r\n        _;\r\n    }\r\n\r\n    /// @dev This can only be run if there is an existing sale for a house\r\n    ///  at a location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    modifier existingHouseSale(uint _x, uint _y)\r\n    {\r\n        require(0 != housePrices[_x][_y]);\r\n        _;\r\n    }\r\n\r\n    /// @param _kingOfEthContract The address of the king contract\r\n    constructor(address _kingOfEthContract) public\r\n    {\r\n        kingOfEthContract = _kingOfEthContract;\r\n    }\r\n\r\n    /// @dev The houses contract can cancel a sale when a house is transfered\r\n    ///  to another player\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    function housesCancelHouseSale(uint _x, uint _y)\r\n        public\r\n        onlyHousesContract\r\n    {\r\n        // If there is indeed a sale\r\n        if(0 != housePrices[_x][_y])\r\n        {\r\n            // Cancel the sale\r\n            housePrices[_x][_y] = 0;\r\n\r\n            emit HouseSaleCancelled(_x, _y, msg.sender);\r\n        }\r\n    }\r\n\r\n    /// @dev The owner of a house can start a sale\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _askingPrice The price that must be payed by another player\r\n    ///  to purchase the house\r\n    function startHouseSale(uint _x, uint _y, uint _askingPrice)\r\n        public\r\n        notPaused\r\n        onlyHouseOwner(_x, _y)\r\n        noExistingHouseSale(_x, _y)\r\n    {\r\n        // Require that the price is at least 0\r\n        require(0 != _askingPrice);\r\n\r\n        // Record the price\r\n        housePrices[_x][_y] = _askingPrice;\r\n\r\n        emit HouseForSale(_x, _y, msg.sender, _askingPrice);\r\n    }\r\n\r\n    /// @dev The owner of a house can change the price of a sale\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _askingPrice The new price that must be payed by another\r\n    ///  player to purchase the house\r\n    function changeHousePrice(uint _x, uint _y, uint _askingPrice)\r\n        public\r\n        notPaused\r\n        onlyHouseOwner(_x, _y)\r\n        existingHouseSale(_x, _y)\r\n    {\r\n        // Require that the price is at least 0\r\n        require(0 != _askingPrice);\r\n\r\n        // Record the price\r\n        housePrices[_x][_y] = _askingPrice;\r\n\r\n        emit HousePriceChanged(_x, _y, _askingPrice);\r\n    }\r\n\r\n    /// @dev Anyone can purchase a house as long as the sale exists\r\n    /// @param _x The y coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    function purchaseHouse(uint _x, uint _y)\r\n        public\r\n        payable\r\n        notPaused\r\n        existingHouseSale(_x, _y)\r\n    {\r\n        // Require that the exact price was paid\r\n        require(housePrices[_x][_y] == msg.value);\r\n\r\n        // End the sale\r\n        housePrices[_x][_y] = 0;\r\n\r\n        // Calculate the taxes to be paid\r\n        uint taxCut = msg.value / taxDivisor;\r\n\r\n        // Pay the taxes\r\n        KingOfEthAbstractInterface(kingOfEthContract).payTaxes.value(taxCut)();\r\n\r\n        KingOfEthHousesAbstractInterface _housesContract = KingOfEthHousesAbstractInterface(housesContract);\r\n\r\n        // Determine the previous owner\r\n        address _oldOwner = _housesContract.ownerOf(_x, _y);\r\n\r\n        // Send the buyer the house\r\n        _housesContract.houseRealtyTransferOwnership(\r\n              _x\r\n            , _y\r\n            , _oldOwner\r\n            , msg.sender\r\n        );\r\n\r\n        // Send the previous owner his share\r\n        _oldOwner.transfer(msg.value - taxCut);\r\n\r\n        emit HouseSold(\r\n              _x\r\n            , _y\r\n            , _oldOwner\r\n            , msg.sender\r\n            , msg.value\r\n            , _housesContract.level(_x, _y)\r\n        );\r\n    }\r\n\r\n    /// @dev The owner of a house can cancel a sale\r\n    /// @param _x The y coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    function cancelHouseSale(uint _x, uint _y)\r\n        public\r\n        notPaused\r\n        onlyHouseOwner(_x, _y)\r\n        existingHouseSale(_x, _y)\r\n    {\r\n        // Cancel the sale\r\n        housePrices[_x][_y] = 0;\r\n\r\n        emit HouseSaleCancelled(_x, _y, msg.sender);\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthHouseRealtyReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: House Realty Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to reference the house realty contract\r\ncontract KingOfEthHouseRealtyReferencer is GodMode {\r\n    /// @dev The realty contract's address\r\n    address public houseRealtyContract;\r\n\r\n    /// @dev Only the house realty contract can run this function\r\n    modifier onlyHouseRealtyContract()\r\n    {\r\n        require(houseRealtyContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set the house realty contract\r\n    /// @param _houseRealtyContract The new address\r\n    function godSetHouseRealtyContract(address _houseRealtyContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        houseRealtyContract = _houseRealtyContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthRoadsAbstractInterface.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title King of Eth: Roads Abstract Interface\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Abstract interface contract for roads\r\ncontract KingOfEthRoadsAbstractInterface {\r\n    /// @dev Get the owner of the road at some location\r\n    /// @param _x The x coordinate of the road\r\n    /// @param _y The y coordinate of the road\r\n    /// @param _direction The direction of the road (either\r\n    ///  0 for right or 1 for down)\r\n    /// @return The address of the owner\r\n    function ownerOf(uint _x, uint _y, uint8 _direction) public view returns(address);\r\n\r\n    /// @dev The road realty contract can transfer road ownership\r\n    /// @param _x The x coordinate of the road\r\n    /// @param _y The y coordinate of the road\r\n    /// @param _direction The direction of the road\r\n    /// @param _from The previous owner of road\r\n    /// @param _to The new owner of road\r\n    function roadRealtyTransferOwnership(\r\n          uint _x\r\n        , uint _y\r\n        , uint8 _direction\r\n        , address _from\r\n        , address _to\r\n    ) public;\r\n}\r\n\r\n// File: contracts/KingOfEthRoadsReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Roads Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to reference the roads contract\r\ncontract KingOfEthRoadsReferencer is GodMode {\r\n    /// @dev The roads contract's address\r\n    address public roadsContract;\r\n\r\n    /// @dev Only the roads contract can run this function\r\n    modifier onlyRoadsContract()\r\n    {\r\n        require(roadsContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set the realty contract\r\n    /// @param _roadsContract The new address\r\n    function godSetRoadsContract(address _roadsContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        roadsContract = _roadsContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthEthExchangeReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Resource-to-ETH Exchange Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to interface with the\r\n///  ETH exchange contract\r\ncontract KingOfEthEthExchangeReferencer is GodMode {\r\n    /// @dev Address of the ETH exchange contract\r\n    address public ethExchangeContract;\r\n\r\n    /// @dev Only the ETH exchange contract may run this function\r\n    modifier onlyEthExchangeContract()\r\n    {\r\n        require(ethExchangeContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God may set the ETH exchange contract's address\r\n    /// @dev _ethExchangeContract The new address\r\n    function godSetEthExchangeContract(address _ethExchangeContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        ethExchangeContract = _ethExchangeContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthResourceExchangeReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Resource-to-Resource Exchange Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to interface with the\r\n///  resource-to-resource contract\r\ncontract KingOfEthResourceExchangeReferencer is GodMode {\r\n    /// @dev Address of the resource-to-resource contract\r\n    address public resourceExchangeContract;\r\n\r\n    /// @dev Only the resource-to-resource contract may run this function\r\n    modifier onlyResourceExchangeContract()\r\n    {\r\n        require(resourceExchangeContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God may set the resource-to-resource contract's address\r\n    /// @dev _resourceExchangeContract The new address\r\n    function godSetResourceExchangeContract(address _resourceExchangeContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        resourceExchangeContract = _resourceExchangeContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthExchangeReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\n/// @title King of Eth: Exchange Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to interface with the exchange contract\r\ncontract KingOfEthExchangeReferencer is\r\n      GodMode\r\n    , KingOfEthEthExchangeReferencer\r\n    , KingOfEthResourceExchangeReferencer\r\n{\r\n    /// @dev Only one of the exchange contracts may\r\n    ///  run this function\r\n    modifier onlyExchangeContract()\r\n    {\r\n        require(\r\n               ethExchangeContract == msg.sender\r\n            || resourceExchangeContract == msg.sender\r\n        );\r\n        _;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthResourcesInterfaceReferencer.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n/// @title King of Eth: Resources Interface Referencer\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides functionality to reference the resource interface contract\r\ncontract KingOfEthResourcesInterfaceReferencer is GodMode {\r\n    /// @dev The interface contract's address\r\n    address public interfaceContract;\r\n\r\n    /// @dev Only the interface contract can run this function\r\n    modifier onlyInterfaceContract()\r\n    {\r\n        require(interfaceContract == msg.sender);\r\n        _;\r\n    }\r\n\r\n    /// @dev God can set the realty contract\r\n    /// @param _interfaceContract The new address\r\n    function godSetInterfaceContract(address _interfaceContract)\r\n        public\r\n        onlyGod\r\n    {\r\n        interfaceContract = _interfaceContract;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthResource.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n/// @title ERC20Interface\r\n/// @dev ERC20 token interface contract\r\ncontract ERC20Interface {\r\n    function totalSupply() public constant returns(uint);\r\n    function balanceOf(address _tokenOwner) public constant returns(uint balance);\r\n    function allowance(address _tokenOwner, address _spender) public constant returns(uint remaining);\r\n    function transfer(address _to, uint _tokens) public returns(bool success);\r\n    function approve(address _spender, uint _tokens) public returns(bool success);\r\n    function transferFrom(address _from, address _to, uint _tokens) public returns(bool success);\r\n\r\n    event Transfer(address indexed from, address indexed to, uint tokens);\r\n    event Approval(address indexed tokenOwner, address indexed spender, uint tokens);\r\n}\r\n\r\n/// @title King of Eth: Resource\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Common contract implementation for resources\r\ncontract KingOfEthResource is\r\n      ERC20Interface\r\n    , GodMode\r\n    , KingOfEthResourcesInterfaceReferencer\r\n{\r\n    /// @dev Current resource supply\r\n    uint public resourceSupply;\r\n\r\n    /// @dev ERC20 token's decimals\r\n    uint8 public constant decimals = 0;\r\n\r\n    /// @dev mapping of addresses to holdings\r\n    mapping (address => uint) holdings;\r\n\r\n    /// @dev mapping of addresses to amount of tokens frozen\r\n    mapping (address => uint) frozenHoldings;\r\n\r\n    /// @dev mapping of addresses to mapping of allowances for an address\r\n    mapping (address => mapping (address => uint)) allowances;\r\n\r\n    /// @dev ERC20 total supply\r\n    /// @return The current total supply of the resource\r\n    function totalSupply()\r\n        public\r\n        constant\r\n        returns(uint)\r\n    {\r\n        return resourceSupply;\r\n    }\r\n\r\n    /// @dev ERC20 balance of address\r\n    /// @param _tokenOwner The address to look up\r\n    /// @return The balance of the address\r\n    function balanceOf(address _tokenOwner)\r\n        public\r\n        constant\r\n        returns(uint balance)\r\n    {\r\n        return holdings[_tokenOwner];\r\n    }\r\n\r\n    /// @dev Total resources frozen for an address\r\n    /// @param _tokenOwner The address to look up\r\n    /// @return The frozen balance of the address\r\n    function frozenTokens(address _tokenOwner)\r\n        public\r\n        constant\r\n        returns(uint balance)\r\n    {\r\n        return frozenHoldings[_tokenOwner];\r\n    }\r\n\r\n    /// @dev The allowance for a spender on an account\r\n    /// @param _tokenOwner The account that allows withdrawels\r\n    /// @param _spender The account that is allowed to withdraw\r\n    /// @return The amount remaining in the allowance\r\n    function allowance(address _tokenOwner, address _spender)\r\n        public\r\n        constant\r\n        returns(uint remaining)\r\n    {\r\n        return allowances[_tokenOwner][_spender];\r\n    }\r\n\r\n    /// @dev Only run if player has at least some amount of tokens\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens required\r\n    modifier hasAvailableTokens(address _owner, uint _tokens)\r\n    {\r\n        require(holdings[_owner] - frozenHoldings[_owner] >= _tokens);\r\n        _;\r\n    }\r\n\r\n    /// @dev Only run if player has at least some amount of tokens frozen\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of frozen tokens required\r\n    modifier hasFrozenTokens(address _owner, uint _tokens)\r\n    {\r\n        require(frozenHoldings[_owner] >= _tokens);\r\n        _;\r\n    }\r\n\r\n    /// @dev Set up the exact same state in each resource\r\n    constructor() public\r\n    {\r\n        // God gets 200 to put on exchange\r\n        holdings[msg.sender] = 200;\r\n\r\n        resourceSupply = 200;\r\n    }\r\n\r\n    /// @dev The resources interface can burn tokens for building\r\n    ///  roads or houses\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to burn\r\n    function interfaceBurnTokens(address _owner, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n        hasAvailableTokens(_owner, _tokens)\r\n    {\r\n        holdings[_owner] -= _tokens;\r\n\r\n        resourceSupply -= _tokens;\r\n\r\n        // Pretend the tokens were sent to 0x0\r\n        emit Transfer(_owner, 0x0, _tokens);\r\n    }\r\n\r\n    /// @dev The resources interface contract can mint tokens for houses\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to burn\r\n    function interfaceMintTokens(address _owner, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n    {\r\n        holdings[_owner] += _tokens;\r\n\r\n        resourceSupply += _tokens;\r\n\r\n        // Pretend the tokens were sent from the interface contract\r\n        emit Transfer(interfaceContract, _owner, _tokens);\r\n    }\r\n\r\n    /// @dev The interface can freeze tokens\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to freeze\r\n    function interfaceFreezeTokens(address _owner, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n        hasAvailableTokens(_owner, _tokens)\r\n    {\r\n        frozenHoldings[_owner] += _tokens;\r\n    }\r\n\r\n    /// @dev The interface can thaw tokens\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to thaw\r\n    function interfaceThawTokens(address _owner, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n        hasFrozenTokens(_owner, _tokens)\r\n    {\r\n        frozenHoldings[_owner] -= _tokens;\r\n    }\r\n\r\n    /// @dev The interface can transfer tokens\r\n    /// @param _from The owner of the tokens\r\n    /// @param _to The new owner of the tokens\r\n    /// @param _tokens The amount of tokens to transfer\r\n    function interfaceTransfer(address _from, address _to, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n    {\r\n        assert(holdings[_from] >= _tokens);\r\n\r\n        holdings[_from] -= _tokens;\r\n        holdings[_to]   += _tokens;\r\n\r\n        emit Transfer(_from, _to, _tokens);\r\n    }\r\n\r\n    /// @dev The interface can transfer frozend tokens\r\n    /// @param _from The owner of the tokens\r\n    /// @param _to The new owner of the tokens\r\n    /// @param _tokens The amount of frozen tokens to transfer\r\n    function interfaceFrozenTransfer(address _from, address _to, uint _tokens)\r\n        public\r\n        onlyInterfaceContract\r\n        hasFrozenTokens(_from, _tokens)\r\n    {\r\n        // Make sure to deduct the tokens from both the total and frozen amounts\r\n        holdings[_from]       -= _tokens;\r\n        frozenHoldings[_from] -= _tokens;\r\n        holdings[_to]         += _tokens;\r\n\r\n        emit Transfer(_from, _to, _tokens);\r\n    }\r\n\r\n    /// @dev ERC20 transfer\r\n    /// @param _to The address to transfer to\r\n    /// @param _tokens The amount of tokens to transfer\r\n    function transfer(address _to, uint _tokens)\r\n        public\r\n        hasAvailableTokens(msg.sender, _tokens)\r\n        returns(bool success)\r\n    {\r\n        holdings[_to]        += _tokens;\r\n        holdings[msg.sender] -= _tokens;\r\n\r\n        emit Transfer(msg.sender, _to, _tokens);\r\n\r\n        return true;\r\n    }\r\n\r\n    /// @dev ERC20 approve\r\n    /// @param _spender The address to approve\r\n    /// @param _tokens The amount of tokens to approve\r\n    function approve(address _spender, uint _tokens)\r\n        public\r\n        returns(bool success)\r\n    {\r\n        allowances[msg.sender][_spender] = _tokens;\r\n\r\n        emit Approval(msg.sender, _spender, _tokens);\r\n\r\n        return true;\r\n    }\r\n\r\n    /// @dev ERC20 transfer from\r\n    /// @param _from The address providing the allowance\r\n    /// @param _to The address using the allowance\r\n    /// @param _tokens The amount of tokens to transfer\r\n    function transferFrom(address _from, address _to, uint _tokens)\r\n        public\r\n        hasAvailableTokens(_from, _tokens)\r\n        returns(bool success)\r\n    {\r\n        require(allowances[_from][_to] >= _tokens);\r\n\r\n        holdings[_to]          += _tokens;\r\n        holdings[_from]        -= _tokens;\r\n        allowances[_from][_to] -= _tokens;\r\n\r\n        emit Transfer(_from, _to, _tokens);\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthResourceType.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n/// @title King of Eth: Resource Type\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Provides enum to choose resource types\r\ncontract KingOfEthResourceType {\r\n    /// @dev Enum describing a choice of a resource\r\n    enum ResourceType {\r\n          ETH\r\n        , BRONZE\r\n        , CORN\r\n        , GOLD\r\n        , OIL\r\n        , ORE\r\n        , STEEL\r\n        , URANIUM\r\n        , WOOD\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthResourcesInterface.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/// @title King of Eth: Resources Interface\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Contract for interacting with resources\r\ncontract KingOfEthResourcesInterface is\r\n      GodMode\r\n    , KingOfEthExchangeReferencer\r\n    , KingOfEthHousesReferencer\r\n    , KingOfEthResourceType\r\n    , KingOfEthRoadsReferencer\r\n{\r\n    /// @dev Amount of resources a user gets for building a house\r\n    uint public constant resourcesPerHouse = 3;\r\n\r\n    /// @dev Address for the bronze contract\r\n    address public bronzeContract;\r\n\r\n    /// @dev Address for the corn contract\r\n    address public cornContract;\r\n\r\n    /// @dev Address for the gold contract\r\n    address public goldContract;\r\n\r\n    /// @dev Address for the oil contract\r\n    address public oilContract;\r\n\r\n    /// @dev Address for the ore contract\r\n    address public oreContract;\r\n\r\n    /// @dev Address for the steel contract\r\n    address public steelContract;\r\n\r\n    /// @dev Address for the uranium contract\r\n    address public uraniumContract;\r\n\r\n    /// @dev Address for the wood contract\r\n    address public woodContract;\r\n\r\n    /// @param _bronzeContract The address of the bronze contract\r\n    /// @param _cornContract The address of the corn contract\r\n    /// @param _goldContract The address of the gold contract\r\n    /// @param _oilContract The address of the oil contract\r\n    /// @param _oreContract The address of the ore contract\r\n    /// @param _steelContract The address of the steel contract\r\n    /// @param _uraniumContract The address of the uranium contract\r\n    /// @param _woodContract The address of the wood contract\r\n    constructor(\r\n          address _bronzeContract\r\n        , address _cornContract\r\n        , address _goldContract\r\n        , address _oilContract\r\n        , address _oreContract\r\n        , address _steelContract\r\n        , address _uraniumContract\r\n        , address _woodContract\r\n    )\r\n        public\r\n    {\r\n        bronzeContract  = _bronzeContract;\r\n        cornContract    = _cornContract;\r\n        goldContract    = _goldContract;\r\n        oilContract     = _oilContract;\r\n        oreContract     = _oreContract;\r\n        steelContract   = _steelContract;\r\n        uraniumContract = _uraniumContract;\r\n        woodContract    = _woodContract;\r\n    }\r\n\r\n    /// @dev Return the particular address for a certain resource type\r\n    /// @param _type The resource type\r\n    /// @return The address for that resource\r\n    function contractFor(ResourceType _type)\r\n        public\r\n        view\r\n        returns(address)\r\n    {\r\n        // ETH does not have a contract\r\n        require(ResourceType.ETH != _type);\r\n\r\n        if(ResourceType.BRONZE == _type)\r\n        {\r\n            return bronzeContract;\r\n        }\r\n        else if(ResourceType.CORN == _type)\r\n        {\r\n            return cornContract;\r\n        }\r\n        else if(ResourceType.GOLD == _type)\r\n        {\r\n            return goldContract;\r\n        }\r\n        else if(ResourceType.OIL == _type)\r\n        {\r\n            return oilContract;\r\n        }\r\n        else if(ResourceType.ORE == _type)\r\n        {\r\n            return oreContract;\r\n        }\r\n        else if(ResourceType.STEEL == _type)\r\n        {\r\n            return steelContract;\r\n        }\r\n        else if(ResourceType.URANIUM == _type)\r\n        {\r\n            return uraniumContract;\r\n        }\r\n        else if(ResourceType.WOOD == _type)\r\n        {\r\n            return woodContract;\r\n        }\r\n    }\r\n\r\n    /// @dev Determine the resource type of a tile\r\n    /// @param _x The x coordinate of the top left corner of the tile\r\n    /// @param _y The y coordinate of the top left corner of the tile\r\n    function resourceType(uint _x, uint _y)\r\n        public\r\n        pure\r\n        returns(ResourceType resource)\r\n    {\r\n        uint _seed = (_x + 7777777) ^  _y;\r\n\r\n        if(0 == _seed % 97)\r\n        {\r\n          return ResourceType.URANIUM;\r\n        }\r\n        else if(0 == _seed % 29)\r\n        {\r\n          return ResourceType.OIL;\r\n        }\r\n        else if(0 == _seed % 23)\r\n        {\r\n          return ResourceType.STEEL;\r\n        }\r\n        else if(0 == _seed % 17)\r\n        {\r\n          return ResourceType.GOLD;\r\n        }\r\n        else if(0 == _seed % 11)\r\n        {\r\n          return ResourceType.BRONZE;\r\n        }\r\n        else if(0 == _seed % 5)\r\n        {\r\n          return ResourceType.WOOD;\r\n        }\r\n        else if(0 == _seed % 2)\r\n        {\r\n          return ResourceType.CORN;\r\n        }\r\n        else\r\n        {\r\n          return ResourceType.ORE;\r\n        }\r\n    }\r\n\r\n    /// @dev Lookup the number of resource points for a certain\r\n    ///  player\r\n    /// @param _player The player in question\r\n    function lookupResourcePoints(address _player)\r\n        public\r\n        view\r\n        returns(uint)\r\n    {\r\n        uint result = 0;\r\n\r\n        result += KingOfEthResource(bronzeContract).balanceOf(_player);\r\n        result += KingOfEthResource(goldContract).balanceOf(_player)    * 3;\r\n        result += KingOfEthResource(steelContract).balanceOf(_player)   * 6;\r\n        result += KingOfEthResource(oilContract).balanceOf(_player)     * 10;\r\n        result += KingOfEthResource(uraniumContract).balanceOf(_player) * 44;\r\n\r\n        return result;\r\n    }\r\n\r\n    /// @dev Burn the resources necessary to build a house\r\n    /// @param _count the number of houses being built\r\n    /// @param _player The player who is building the house\r\n    function burnHouseCosts(uint _count, address _player)\r\n        public\r\n        onlyHousesContract\r\n    {\r\n        // Costs 2 corn per house\r\n        KingOfEthResource(contractFor(ResourceType.CORN)).interfaceBurnTokens(\r\n              _player\r\n            , 2 * _count\r\n        );\r\n\r\n        // Costs 2 ore per house\r\n        KingOfEthResource(contractFor(ResourceType.ORE)).interfaceBurnTokens(\r\n              _player\r\n            , 2 * _count\r\n        );\r\n\r\n        // Costs 1 wood per house\r\n        KingOfEthResource(contractFor(ResourceType.WOOD)).interfaceBurnTokens(\r\n              _player\r\n            , _count\r\n        );\r\n    }\r\n\r\n    /// @dev Burn the costs of upgrading a house\r\n    /// @param _currentLevel The level of the house before the upgrade\r\n    /// @param _player The player who is upgrading the house\r\n    function burnUpgradeCosts(uint8 _currentLevel, address _player)\r\n        public\r\n        onlyHousesContract\r\n    {\r\n        // Do not allow upgrades after level 4\r\n        require(5 > _currentLevel);\r\n\r\n        // Burn the base house cost\r\n        burnHouseCosts(1, _player);\r\n\r\n        if(0 == _currentLevel)\r\n        {\r\n            // Level 1 costs bronze\r\n            KingOfEthResource(contractFor(ResourceType.BRONZE)).interfaceBurnTokens(\r\n                  _player\r\n                , 1\r\n            );\r\n        }\r\n        else if(1 == _currentLevel)\r\n        {\r\n            // Level 2 costs gold\r\n            KingOfEthResource(contractFor(ResourceType.GOLD)).interfaceBurnTokens(\r\n                  _player\r\n                , 1\r\n            );\r\n        }\r\n        else if(2 == _currentLevel)\r\n        {\r\n            // Level 3 costs steel\r\n            KingOfEthResource(contractFor(ResourceType.STEEL)).interfaceBurnTokens(\r\n                  _player\r\n                , 1\r\n            );\r\n        }\r\n        else if(3 == _currentLevel)\r\n        {\r\n            // Level 4 costs oil\r\n            KingOfEthResource(contractFor(ResourceType.OIL)).interfaceBurnTokens(\r\n                  _player\r\n                , 1\r\n            );\r\n        }\r\n        else if(4 == _currentLevel)\r\n        {\r\n            // Level 5 costs uranium\r\n            KingOfEthResource(contractFor(ResourceType.URANIUM)).interfaceBurnTokens(\r\n                  _player\r\n                , 1\r\n            );\r\n        }\r\n    }\r\n\r\n    /// @dev Mint resources for a house and distribute all to its owner\r\n    /// @param _owner The owner of the house\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _level The new level of the house\r\n    function distributeResources(address _owner, uint _x, uint _y, uint8 _level)\r\n        public\r\n        onlyHousesContract\r\n    {\r\n        // Calculate the count of resources for this level\r\n        uint _count = resourcesPerHouse * uint(_level + 1);\r\n\r\n        // Distribute the top left resource\r\n        KingOfEthResource(contractFor(resourceType(_x - 1, _y - 1))).interfaceMintTokens(\r\n            _owner\r\n          , _count\r\n        );\r\n\r\n        // Distribute the top right resource\r\n        KingOfEthResource(contractFor(resourceType(_x, _y - 1))).interfaceMintTokens(\r\n            _owner\r\n          , _count\r\n        );\r\n\r\n        // Distribute the bottom right resource\r\n        KingOfEthResource(contractFor(resourceType(_x, _y))).interfaceMintTokens(\r\n            _owner\r\n          , _count\r\n        );\r\n\r\n        // Distribute the bottom left resource\r\n        KingOfEthResource(contractFor(resourceType(_x - 1, _y))).interfaceMintTokens(\r\n            _owner\r\n          , _count\r\n        );\r\n    }\r\n\r\n    /// @dev Burn the costs necessary to build a road\r\n    /// @param _length The length of the road\r\n    /// @param _player The player who is building the house\r\n    function burnRoadCosts(uint _length, address _player)\r\n        public\r\n        onlyRoadsContract\r\n    {\r\n        // Burn corn\r\n        KingOfEthResource(cornContract).interfaceBurnTokens(\r\n              _player\r\n            , _length\r\n        );\r\n\r\n        // Burn ore\r\n        KingOfEthResource(oreContract).interfaceBurnTokens(\r\n              _player\r\n            , _length\r\n        );\r\n    }\r\n\r\n    /// @dev The exchange can freeze tokens\r\n    /// @param _type The type of resource\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to freeze\r\n    function exchangeFreezeTokens(ResourceType _type, address _owner, uint _tokens)\r\n        public\r\n        onlyExchangeContract\r\n    {\r\n        KingOfEthResource(contractFor(_type)).interfaceFreezeTokens(_owner, _tokens);\r\n    }\r\n\r\n    /// @dev The exchange can thaw tokens\r\n    /// @param _type The type of resource\r\n    /// @param _owner The owner of the tokens\r\n    /// @param _tokens The amount of tokens to thaw\r\n    function exchangeThawTokens(ResourceType _type, address _owner, uint _tokens)\r\n        public\r\n        onlyExchangeContract\r\n    {\r\n        KingOfEthResource(contractFor(_type)).interfaceThawTokens(_owner, _tokens);\r\n    }\r\n\r\n    /// @dev The exchange can transfer tokens\r\n    /// @param _type The type of resource\r\n    /// @param _from The owner of the tokens\r\n    /// @param _to The new owner of the tokens\r\n    /// @param _tokens The amount of tokens to transfer\r\n    function exchangeTransfer(ResourceType _type, address _from, address _to, uint _tokens)\r\n        public\r\n        onlyExchangeContract\r\n    {\r\n        KingOfEthResource(contractFor(_type)).interfaceTransfer(_from, _to, _tokens);\r\n    }\r\n\r\n    /// @dev The exchange can transfer frozend tokens\r\n    /// @param _type The type of resource\r\n    /// @param _from The owner of the tokens\r\n    /// @param _to The new owner of the tokens\r\n    /// @param _tokens The amount of frozen tokens to transfer\r\n    function exchangeFrozenTransfer(ResourceType _type, address _from, address _to, uint _tokens)\r\n        public\r\n        onlyExchangeContract\r\n    {\r\n        KingOfEthResource(contractFor(_type)).interfaceFrozenTransfer(_from, _to, _tokens);\r\n    }\r\n}\r\n\r\n// File: contracts/KingOfEthHouses.sol\r\n\r\n/****************************************************\r\n *\r\n * Copyright 2018 BurzNest LLC. All rights reserved.\r\n *\r\n * The contents of this file are provided for review\r\n * and educational purposes ONLY. You MAY NOT use,\r\n * copy, distribute, or modify this software without\r\n * explicit written permission from BurzNest LLC.\r\n *\r\n ****************************************************/\r\n\r\npragma solidity ^0.4.24;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/// @title King of Eth: Houses\r\n/// @author Anthony Burzillo <burz@burznest.com>\r\n/// @dev Contract for houses\r\ncontract KingOfEthHouses is\r\n      GodMode\r\n    , KingOfEthAuctionsReferencer\r\n    , KingOfEthBoardReferencer\r\n    , KingOfEthHouseRealtyReferencer\r\n    , KingOfEthHousesAbstractInterface\r\n    , KingOfEthReferencer\r\n    , KingOfEthRoadsReferencer\r\n    , KingOfEthResourcesInterfaceReferencer\r\n{\r\n    /// @dev ETH cost to build or upgrade a house\r\n    uint public houseCost = 0.001 ether;\r\n\r\n    /// @dev Struct to hold info about a house location on the board\r\n    struct LocationInfo {\r\n        /// @dev The owner of the house at this location\r\n        address owner;\r\n\r\n        /// @dev The level of the house at this location\r\n        uint8 level;\r\n    }\r\n\r\n    /// @dev Mapping from the (x, y) coordinate of the location to its info\r\n    mapping (uint => mapping (uint => LocationInfo)) locationInfo;\r\n\r\n    /// @dev Mapping from a player's address to his points\r\n    mapping (address => uint) pointCounts;\r\n\r\n    /// @param _blindAuctionsContract The address of the blind auctions contract\r\n    /// @param _boardContract The address of the board contract\r\n    /// @param _kingOfEthContract The address of the king contract\r\n    /// @param _houseRealtyContract The address of the house realty contract\r\n    /// @param _openAuctionsContract The address of the open auctions contract\r\n    /// @param _roadsContract The address of the roads contract\r\n    /// @param _interfaceContract The address of the resources\r\n    ///  interface contract\r\n    constructor(\r\n          address _blindAuctionsContract\r\n        , address _boardContract\r\n        , address _kingOfEthContract\r\n        , address _houseRealtyContract\r\n        , address _openAuctionsContract\r\n        , address _roadsContract\r\n        , address _interfaceContract\r\n    )\r\n        public\r\n    {\r\n        blindAuctionsContract = _blindAuctionsContract;\r\n        boardContract         = _boardContract;\r\n        kingOfEthContract     = _kingOfEthContract;\r\n        houseRealtyContract   = _houseRealtyContract;\r\n        openAuctionsContract  = _openAuctionsContract;\r\n        roadsContract         = _roadsContract;\r\n        interfaceContract     = _interfaceContract;\r\n    }\r\n\r\n    /// @dev Fired when new houses are built\r\n    event NewHouses(address owner, uint[] locations);\r\n\r\n    /// @dev Fired when a house is sent from one player to another\r\n    event SentHouse(uint x, uint y, address from, address to, uint8 level);\r\n\r\n    /// @dev Fired when a house is upgraded\r\n    event UpgradedHouse(uint x, uint y, address owner, uint8 newLevel);\r\n\r\n    /// @dev Get the owner of the house at some location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @return The address of the owner\r\n    function ownerOf(uint _x, uint _y) public view returns(address)\r\n    {\r\n        return locationInfo[_x][_y].owner;\r\n    }\r\n\r\n    /// @dev Get the level of the house at some location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @return The level of the house\r\n    function level(uint _x, uint _y) public view returns(uint8)\r\n    {\r\n        return locationInfo[_x][_y].level;\r\n    }\r\n\r\n    /// @dev Get the number of points held by a player\r\n    /// @param _player The player's address\r\n    /// @return The number of points\r\n    function numberOfPoints(address _player) public view returns(uint)\r\n    {\r\n        return pointCounts[_player];\r\n    }\r\n\r\n    /// @dev Helper function to build a house at a location\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    function buildHouseInner(uint _x, uint _y) private\r\n    {\r\n        // Lookup the info about the house\r\n        LocationInfo storage _locationInfo = locationInfo[_x][_y];\r\n\r\n        KingOfEthBoard _boardContract = KingOfEthBoard(boardContract);\r\n\r\n        // Require the house to be within the current bounds of the game\r\n        require(_boardContract.boundX1() <= _x);\r\n        require(_boardContract.boundY1() <= _y);\r\n        require(_boardContract.boundX2() > _x);\r\n        require(_boardContract.boundY2() > _y);\r\n\r\n        // Require the spot to be empty\r\n        require(0x0 == _locationInfo.owner);\r\n\r\n        KingOfEthRoadsAbstractInterface _roadsContract = KingOfEthRoadsAbstractInterface(roadsContract);\r\n\r\n        // Require either either the right, bottom, left or top road\r\n        // to be owned by the player\r\n        require(\r\n                _roadsContract.ownerOf(_x, _y, 0) == msg.sender\r\n             || _roadsContract.ownerOf(_x, _y, 1) == msg.sender\r\n             || _roadsContract.ownerOf(_x - 1, _y, 0) == msg.sender\r\n             || _roadsContract.ownerOf(_x, _y - 1, 1) == msg.sender\r\n        );\r\n\r\n        // Require that there is no existing blind auction at the location\r\n        require(!KingOfEthAuctionsAbstractInterface(blindAuctionsContract).existingAuction(_x, _y));\r\n\r\n        // Require that there is no existing open auction at the location\r\n        require(!KingOfEthAuctionsAbstractInterface(openAuctionsContract).existingAuction(_x, _y));\r\n\r\n        // Set new owner\r\n        _locationInfo.owner = msg.sender;\r\n\r\n        // Update player's points\r\n        ++pointCounts[msg.sender];\r\n\r\n        // Distribute resources to the player\r\n        KingOfEthResourcesInterface(interfaceContract).distributeResources(\r\n              msg.sender\r\n            , _x\r\n            , _y\r\n            , 0 // Level 0\r\n        );\r\n    }\r\n\r\n    /// @dev God can change the house cost\r\n    /// @param _newHouseCost The new cost of a house\r\n    function godChangeHouseCost(uint _newHouseCost)\r\n        public\r\n        onlyGod\r\n    {\r\n        houseCost = _newHouseCost;\r\n    }\r\n\r\n    /// @dev The auctions contracts can set the owner of a house after an auction\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _owner The new owner of the house\r\n    function auctionsSetOwner(uint _x, uint _y, address _owner)\r\n        public\r\n        onlyAuctionsContract\r\n    {\r\n        // Lookup the info about the house\r\n        LocationInfo storage _locationInfo = locationInfo[_x][_y];\r\n\r\n        // Require that nobody already owns the house.\r\n        // Note that this would be an assert if only the blind auctions\r\n        // contract used this code, but the open auctions contract\r\n        // depends on this require to save space.\r\n        require(0x0 == _locationInfo.owner);\r\n\r\n        // Set the house's new owner\r\n        _locationInfo.owner = _owner;\r\n\r\n        // Give the player a point for the house\r\n        ++pointCounts[_owner];\r\n\r\n        // Distribute the resources for the house\r\n        KingOfEthResourcesInterface(interfaceContract).distributeResources(\r\n              _owner\r\n            , _x\r\n            , _y\r\n            , 0 // Level 0\r\n        );\r\n\r\n        // Set up the locations for the event\r\n        uint[] memory _locations = new uint[](2);\r\n        _locations[0] = _x;\r\n        _locations[1] = _y;\r\n\r\n        emit NewHouses(_owner, _locations);\r\n    }\r\n\r\n    /// @dev The house realty contract can transfer house ownership\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _from The previous owner of house\r\n    /// @param _to The new owner of house\r\n    function houseRealtyTransferOwnership(\r\n          uint _x\r\n        , uint _y\r\n        , address _from\r\n        , address _to\r\n    )\r\n        public\r\n        onlyHouseRealtyContract\r\n    {\r\n        // Lookup the info about the house\r\n        LocationInfo storage _locationInfo = locationInfo[_x][_y];\r\n\r\n        // Assert that the previous owner still has the house\r\n        assert(_locationInfo.owner == _from);\r\n\r\n        // Set the new owner\r\n        _locationInfo.owner = _to;\r\n\r\n        // Calculate the total points of the house\r\n        uint _points = _locationInfo.level + 1;\r\n\r\n        // Update the point counts\r\n        pointCounts[_from] -= _points;\r\n        pointCounts[_to]   += _points;\r\n    }\r\n\r\n    /// @dev Build multiple houses at once\r\n    /// @param _locations An array of coordinates for the houses. These\r\n    ///  are specified sequentially like [x1, y1, x2, y2] representing\r\n    ///  location (x1, y1) and location (x2, y2).\r\n    function buildHouses(uint[] _locations)\r\n        public\r\n        payable\r\n    {\r\n        // Require that there are an even number of locations\r\n        require(0 == _locations.length % 2);\r\n\r\n        uint _count = _locations.length / 2;\r\n\r\n        // Require the house cost\r\n        require(houseCost * _count == msg.value);\r\n\r\n        // Pay taxes\r\n        KingOfEthAbstractInterface(kingOfEthContract).payTaxes.value(msg.value)();\r\n\r\n        // Burn the required resource costs for the houses\r\n        KingOfEthResourcesInterface(interfaceContract).burnHouseCosts(\r\n              _count\r\n            , msg.sender\r\n        );\r\n\r\n        // Build a house at each one of the locations\r\n        for(uint i = 0; i < _locations.length; i += 2)\r\n        {\r\n            buildHouseInner(_locations[i], _locations[i + 1]);\r\n        }\r\n\r\n        emit NewHouses(msg.sender, _locations);\r\n    }\r\n\r\n    /// @dev Send a house to another player\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    /// @param _to The recipient of the house\r\n    function sendHouse(uint _x, uint _y, address _to) public\r\n    {\r\n        // Lookup the info about the house\r\n        LocationInfo storage _locationInfo = locationInfo[_x][_y];\r\n\r\n        // Require that the sender is the owner\r\n        require(_locationInfo.owner == msg.sender);\r\n\r\n        // Set the new owner\r\n        _locationInfo.owner = _to;\r\n\r\n        // Calculate the points of the house\r\n        uint _points = _locationInfo.level + 1;\r\n\r\n        // Update point counts\r\n        pointCounts[msg.sender] -= _points;\r\n        pointCounts[_to]        += _points;\r\n\r\n        // Cancel any sales that exist\r\n        KingOfEthHouseRealty(houseRealtyContract).housesCancelHouseSale(_x, _y);\r\n\r\n        emit SentHouse(_x, _y, msg.sender, _to, _locationInfo.level);\r\n    }\r\n\r\n    /// @dev Upgrade a house\r\n    /// @param _x The x coordinate of the house\r\n    /// @param _y The y coordinate of the house\r\n    function upgradeHouse(uint _x, uint _y) public payable\r\n    {\r\n        // Lookup the info about the house\r\n        LocationInfo storage _locationInfo = locationInfo[_x][_y];\r\n\r\n        // Require that the sender is the owner\r\n        require(_locationInfo.owner == msg.sender);\r\n\r\n        // Require the house cost be payed\r\n        require(houseCost == msg.value);\r\n\r\n        // Pay the taxes\r\n        KingOfEthAbstractInterface(kingOfEthContract).payTaxes.value(msg.value)();\r\n\r\n        // Burn the resource costs of the upgrade\r\n        KingOfEthResourcesInterface(interfaceContract).burnUpgradeCosts(\r\n              _locationInfo.level\r\n            , msg.sender\r\n        );\r\n\r\n        // Update the house's level\r\n        ++locationInfo[_x][_y].level;\r\n\r\n        // Update the owner's points\r\n        ++pointCounts[msg.sender];\r\n\r\n        // Distribute the resources for the house\r\n        KingOfEthResourcesInterface(interfaceContract).distributeResources(\r\n              msg.sender\r\n            , _x\r\n            , _y\r\n            , _locationInfo.level\r\n        );\r\n\r\n        emit UpgradedHouse(_x, _y, msg.sender, _locationInfo.level);\r\n    }\r\n}","ABI":"[{\"constant\":false,\"inputs\":[{\"name\":\"_boardContract\",\"type\":\"address\"}],\"name\":\"godSetBoardContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"godPause\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newHouseCost\",\"type\":\"uint256\"}],\"name\":\"godChangeHouseCost\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"houseCost\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"},{\"name\":\"_owner\",\"type\":\"address\"}],\"name\":\"auctionsSetOwner\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"boardContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"openAuctionsContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_newGod\",\"type\":\"address\"}],\"name\":\"godChangeGod\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_interfaceContract\",\"type\":\"address\"}],\"name\":\"godSetInterfaceContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_kingOfEthContract\",\"type\":\"address\"}],\"name\":\"godSetKingOfEthContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"blindAuctionsContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_player\",\"type\":\"address\"}],\"name\":\"numberOfPoints\",\"outputs\":[{\"name\":\"\",\"type\":\"uint256\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"roadsContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"}],\"name\":\"level\",\"outputs\":[{\"name\":\"\",\"type\":\"uint8\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"interfaceContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[],\"name\":\"godUnpause\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_houseRealtyContract\",\"type\":\"address\"}],\"name\":\"godSetHouseRealtyContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"isPaused\",\"outputs\":[{\"name\":\"\",\"type\":\"bool\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"god\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_blindAuctionsContract\",\"type\":\"address\"}],\"name\":\"godSetBlindAuctionsContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_openAuctionsContract\",\"type\":\"address\"}],\"name\":\"godSetOpenAuctionsContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"},{\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"sendHouse\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"}],\"name\":\"upgradeHouse\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"}],\"name\":\"ownerOf\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"houseRealtyContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_locations\",\"type\":\"uint256[]\"}],\"name\":\"buildHouses\",\"outputs\":[],\"payable\":true,\"stateMutability\":\"payable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_roadsContract\",\"type\":\"address\"}],\"name\":\"godSetRoadsContract\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":false,\"inputs\":[{\"name\":\"_x\",\"type\":\"uint256\"},{\"name\":\"_y\",\"type\":\"uint256\"},{\"name\":\"_from\",\"type\":\"address\"},{\"name\":\"_to\",\"type\":\"address\"}],\"name\":\"houseRealtyTransferOwnership\",\"outputs\":[],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"constant\":true,\"inputs\":[],\"name\":\"kingOfEthContract\",\"outputs\":[{\"name\":\"\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"name\":\"_blindAuctionsContract\",\"type\":\"address\"},{\"name\":\"_boardContract\",\"type\":\"address\"},{\"name\":\"_kingOfEthContract\",\"type\":\"address\"},{\"name\":\"_houseRealtyContract\",\"type\":\"address\"},{\"name\":\"_openAuctionsContract\",\"type\":\"address\"},{\"name\":\"_roadsContract\",\"type\":\"address\"},{\"name\":\"_interfaceContract\",\"type\":\"address\"}],\"payable\":false,\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"locations\",\"type\":\"uint256[]\"}],\"name\":\"NewHouses\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"x\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"y\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"from\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"to\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"level\",\"type\":\"uint8\"}],\"name\":\"SentHouse\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":false,\"name\":\"x\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"y\",\"type\":\"uint256\"},{\"indexed\":false,\"name\":\"owner\",\"type\":\"address\"},{\"indexed\":false,\"name\":\"newLevel\",\"type\":\"uint8\"}],\"name\":\"UpgradedHouse\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[],\"name\":\"GodPaused\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[],\"name\":\"GodUnpaused\",\"type\":\"event\"}]","ContractName":"KingOfEthHouses","CompilerVersion":"v0.4.24+commit.e67f0147","OptimizationUsed":"1","Runs":"200","ConstructorArguments":"0000000000000000000000001e19bec0e4ec6d524585f1d89f57afa2d0e951060000000000000000000000005ff1e4c124b6b0c9a41cf41d261b3cb9fd84c80d00000000000000000000000004bba664ea822924ff435ce1b3fad3e8dcc69481000000000000000000000000e1254b9025b9e9dc4c22b1e48ad0d279c090af24000000000000000000000000214c1c9962761be484e365a14d9bca3739020517000000000000000000000000c8e072145f8aa3507a291141beae1109070a6fb80000000000000000000000008183703e9df90ed76bec0b0b8fad33f2c024be59","Library":"","SwarmSource":"bzzr://d94c70f7dc5def6b92516e246c23a2621645f9eabcc2aa2d58056745f47d2d80"}]}